"use strict";(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[38395,90677],{16227:(x,y,l)=>{var p,f;p=[l(52473)],f=function(P){const n={};let r;n.pids=[];let c=!1;n.init=function(s,o){n.pids.length=0,r=s,o=o||{},c=o.allowMainPostSelect||!1,$("#content").on("click",'[component="topic"] [component="post"]',u),i()};function u(s){s.stopPropagation();const o=$(this).attr("data-pid"),a=$('[component="topic"] [data-pid="'+o+'"]');!c&&parseInt($(this).attr("data-index"),10)===0||n.togglePostSelection(a,o)}n.disable=function(){n.pids.forEach(function(s){P.get("post","pid",s).toggleClass("selected",!1)}),$("#content").off("click",'[component="topic"] [component="post"]',u),d()},n.togglePostSelection=function(s,o){if(o){const a=n.pids.indexOf(o);a===-1?(n.pids.push(o),s.toggleClass("selected",!0)):(n.pids.splice(a,1),s.toggleClass("selected",!1)),n.pids.length&&n.pids.sort(function(h,g){return h-g}),typeof r=="function"&&r()}};function m(){return!1}function i(){$("#content").on("click",'[component="post"] button, [component="post"] a',m)}function d(){$("#content").off("click",'[component="post"] button, [component="post"] a',m)}return n}.apply(y,p),f!==void 0&&(x.exports=f)},90677:(x,y,l)=>{var p,f;p=[l(52473),l(16227),l(17459),l(29930),l(49897)],f=function(P,n,r,c,u){const m={};let i,d,s;m.init=function(t){i||(s=ajaxify.data.tid,app.parseAndTranslate("modals/move-post",{},function(e){i=e,d=i.find("#move_posts_confirm"),$("body").append(i),i.find("#move_posts_cancel").on("click",A),i.find("#topicId").on("keyup",utils.debounce(g,200)),n.init(E),h(),t&&n.togglePostSelection(t,t.attr("data-pid")),$(window).off("action:ajaxify.end",o).on("action:ajaxify.end",o),d.on("click",function(){const v=a();if(!v)return;d.attr("disabled",!0);const C={pids:n.pids.slice(),tid:v};if(config.undoTimeout>0)return c.alert({alert_id:"pids_move_"+n.pids.join("-"),title:"[[topic:thread-tools.move-posts]]",message:"[[topic:topic-move-posts-success]]",type:"success",timeout:config.undoTimeout,timeoutfn:function(){b(C)},clickfn:function(_,j){delete j.timeoutfn,c.success("[[topic:topic-move-posts-undone]]"),d.removeAttr("disabled")}});b(C)})}))};function o(){if(!i)return;const t=i.find("#topicId");let e=null;ajaxify.data.template.topic&&ajaxify.data.tid&&String(ajaxify.data.tid)!==String(s)&&(e=ajaxify.data.tid),e&&t.val(e),g()}function a(){const t=i.find("#topicId");return t.length&&t.val()?t.val():ajaxify.data.template.topic&&ajaxify.data.tid}function h(){if(!i)return;const t=a();n.pids.length?t&&String(t)!==String(s)?u.get(`/topics/${t}`,{}).then(function(e){if(!e||!e.tid)return c.error("[[error:no-topic]]");if(e.scheduled)return c.error("[[error:cant-move-posts-to-scheduled]]");const v=r.compile("topic:x-posts-will-be-moved-to-y",n.pids.length,e.title);i.find("#pids").translateHtml(v)}):i.find("#pids").translateHtml("[[topic:x-posts-selected, "+n.pids.length+"]]"):i.find("#pids").translateHtml("[[topic:no-posts-selected]]")}function g(){if(!i)return;const t=a();n.pids.length&&t&&String(t)!==String(s)?d.removeAttr("disabled"):d.attr("disabled",!0),h()}function E(){g()}function b(t){t.tid&&Promise.all(t.pids.map(e=>u.put(`/posts/${encodeURIComponent(e)}/move`,{tid:t.tid}))).then(()=>{t.pids.forEach(function(e){P.get("post","pid",e).fadeOut(500,function(){$(this).remove()})}),t.pids.length&&ajaxify.data.template.topic&&String(t.tid)===String(ajaxify.data.tid)&&ajaxify.go(`/post/${t.pids[0]}`),A()}).catch(c.error)}function A(){i&&(i.remove(),i=null,n.disable(),$(window).off("action:ajaxify.end",o))}return m}.apply(y,p),f!==void 0&&(x.exports=f)}}]);
