"use strict";(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[18631],{18631:(g,v,r)=>{var m,c;m=[r(47536),r(91749),r(29930),r(49897)],c=function(f,y,w,A){const l={};l.init=function(t){const n=t.closest("[data-pid]"),s=n.data("pid"),e=t.find('[component="post/replies/open"]');e.attr("loading")!=="1"&&e.attr("loaded")!=="1"?(e.attr("loading","1").removeClass("fa-chevron-down").addClass("fa-spin fa-spinner"),A.get(`/posts/${encodeURIComponent(s)}/replies`,{},function(a,{replies:d}){const o=d;if(e.removeAttr("loading").attr("loaded","1").removeClass("fa-spin fa-spinner").addClass("fa-chevron-up"),a)return w.error(a);o.forEach((i,p)=>{i&&(i.index=p)}),f.modifyPostsByPrivileges(o);const u={posts:o,privileges:ajaxify.data.privileges,"downvote:disabled":ajaxify.data["downvote:disabled"],"reputation:disabled":ajaxify.data["reputation:disabled"],loggedIn:!!app.user.uid,hideParent:!0,hideReplies:config.hasOwnProperty("showNestedReplies")?!config.showNestedReplies:!0};app.parseAndTranslate("topic","posts",u,async function(i){const p=$("<ul>",{component:"post/replies",class:"list-unstyled"}).html(i).hide();t.attr("data-target-component")?n.find('[component="'+t.attr("data-target-component")+'"]').html(p):p.insertAfter(t),p.slideDown("fast"),await f.onNewPostsAddedToDom(i),y.fire("action:posts.loaded",{posts:o})})})):e.attr("loaded")==="1"&&(e.removeAttr("loaded").removeAttr("loading").removeClass("fa-spin fa-spinner fa-chevron-up").addClass("fa-chevron-down"),n.find('[component="post/replies"]').slideUp("fast",function(){$(this).remove()}))},l.onNewPost=function(t){const n=t.posts[0];n&&(h(n,1),t.hideReplies=config.hasOwnProperty("showNestedReplies")?!config.showNestedReplies:!0,app.parseAndTranslate("topic","posts",t,async function(s){const e=$('[component="post"][data-pid="'+n.toPid+'"] [component="post/replies"]').first();e.length&&(config.topicPostSort==="newest_to_oldest"?e.prepend(s):e.append(s),await f.onNewPostsAddedToDom(s))}))},l.onPostPurged=function(t){h(t,-1)};function h(t,n){const s=document.querySelector(`[component="post"][data-pid="${t.toPid}"]`);if(!s)return;const e=$('[component="post"][data-pid="'+t.toPid+'"]').find('[component="post/reply-count"]').first(),a=e.find('[component="post/reply-count/text"]'),d=e.find('[component="post/reply-count/avatars"]'),o=Math.max(0,(parseInt(a.attr("data-replies"),10)||0)+n),u=e.find(".timeago").attr("title",t.timestampISO),i=s.getAttribute("data-index"),p=o===1&&Math.abs(t.index-i)===1;a.attr("data-replies",o),e.toggleClass("hidden",o<=0||p),o>1?a.translateText("[[topic:replies-to-this-post, "+o+"]]"):a.translateText("[[topic:one-reply-to-this-post]]"),!d.find('[data-uid="'+t.uid+'"]').length&&o<7&&app.parseAndTranslate("topic","posts",{posts:[{replies:{count:o,hasMore:!1,users:[t.user]}}]},function(P){d.prepend(P.find('[component="post/reply-count/avatars"]').html())}),d.addClass("hasMore"),u.data("timeago",null).timeago()}return l}.apply(v,m),c!==void 0&&(g.exports=c)}}]);
