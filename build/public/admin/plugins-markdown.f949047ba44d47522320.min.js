(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[18470,27049],{32762:(R,v,l)=>{"use strict";var k,p;k=[l(70012)],p=function(S){var m={};return m.init=function(){S.load("markdown",$(".markdown-settings"),function(A,h){A&&(h={});var d={html:!1,langPrefix:"language-",highlight:!0,highlightTheme:"default.css",probe:!0,probeCacheSize:256,xhtmlOut:!0,breaks:!0,linkify:!0,typographer:!1,externalBlank:!1,nofollow:!0,allowRTLO:!1,checkboxes:!0,multimdTables:!0};for(const a of Object.keys(d))h.hasOwnProperty(a)||(typeof d[a]=="boolean"?$("#"+a).prop("checked",d[a]):$("#"+a).val(d[a]))}),$("#save").on("click",function(){S.save("markdown",$(".markdown-settings"))})},m}.apply(v,k),p!==void 0&&(R.exports=p)},55523:(R,v,l)=>{R.exports=l(32762)},70012:(R,v,l)=>{"use strict";var k,p;k=[l(91749),l(29930)],p=function(S,m){let A=[],h=0;function d(t,n){typeof t!="string"&&(t=$(t),t=t.data("type")||t.attr("type")||t.prop("tagName"));const i=f.plugins[t.toLowerCase()];if(i==null)return;const e=i[n];return typeof e=="function"?e:null}const a={deepClone:function(t){return typeof t=="object"?JSON.parse(JSON.stringify(t)):t},createElement:function(t,n,i){const e=document.createElement(t);for(const[o,s]of Object.entries(n))e.setAttribute(o,s);return i&&e.appendChild(document.createTextNode(i)),e},initElement:function(t){const n=d(t,"init");n?.call(f,$(t))},destructElement:function(t){const n=d(t,"destruct");n?.call(f,$(t))},createElementOfType:function(t,n,i){let e;const o=d(t,"create");return o!=null?e=$(o.call(f,t,n,i)):(i==null&&(i={}),t!=null&&(i.type=t),e=$(a.createElement(n||"input",i))),e.data("type",t),a.initElement(e),e},cleanArray:function(t,n,i){const e=[];if(!n&&i)return t;for(let o=0;o<t.length;o+=1){let s=t[o];n&&(s===!!s?s=+s:s&&typeof s.trim=="function"&&(s=s.trim())),(i||s!=null&&s.length)&&e.push(s)}return e},isTrue:function(t){return t==="true"||+t==1},isFalse:function(t){return t==="false"||+t==0},readValue:function(t){let n=!a.isFalse(t.data("empty"));const i=!a.isFalse(t.data("trim")),e=t.data("split"),o=d(t,"get");let s;if(o!=null)return o.call(f,t,i,n);if(e!=null){n=a.isTrue(t.data("empty")),s=t.val();const u=s!=null&&s.split(e||",")||[];return a.cleanArray(u,i,n)}if(s=t.val(),i&&s!=null&&typeof s.trim=="function"&&(s=s.trim()),n||s!==void 0&&(s==null||s.length!==0))return s},fillField:function(t,n){const i=d(t,"set");let e=t.data("trim");if(e=e!=="false"&&+e!=0,i!=null)return i.call(f,t,n,e);n instanceof Array&&(n=n.join(t.data("split")||(e?", ":","))),e&&n&&typeof n.trim=="function"?(n=n.trim(),typeof n.toString=="function"&&(n=n.toString())):n!=null?(typeof n.toString=="function"&&(n=n.toString()),e&&(n=n.trim())):n="",n!==void 0&&t.val(n)},initFields:function(t){$("[data-key]",t).each(function(n,i){i=$(i);const e=d(i,"init"),o=i.data("key").split(".");let s=f.get();e?.call(f,i);for(let u=0;u<o.length;u+=1){const r=o[u];r&&s!=null&&(s=s[r])}a.fillField(i,s)})},registerReadyJobs:function(t){return h+=t,h},beforeReadyJobsDecreased:function(t){if(t==null&&(t=1),h>0&&(h-=t,h<=0)){for(let n=0;n<A.length;n+=1)A[n]();A=[]}},whenReady:function(t){h<=0?t():A.push(t)},serializeForm:function(t){const n=t.serializeObject();return t.find('input[type="checkbox"]').each(function(i,e){e=$(e),e.is(":checked")||(n[e.attr("name")]="off")}),t.find("select[multiple]").each(function(i,e){e=$(e),n[e.attr("name")]=JSON.stringify(e.val())}),n},persistSettings:function(t,n,i,e){n!=null&&n._!=null&&typeof n._!="string"&&(n=a.deepClone(n),n._=JSON.stringify(n._)),socket.emit("admin.settings.set",{hash:t,values:n},function(o){i&&(o?m.alert({title:"[[admin/admin:changes-not-saved]]",type:"danger",message:`[[admin/admin/changes-not-saved-message, ${o.message}]]`,timeout:5e3}):m.alert({title:"[[admin/admin:changes-saved]]",type:"success",message:"[[admin/admin:changes-saved-message]]",timeout:2500})),typeof e=="function"&&e(o)})},use:function(t){try{t._=JSON.parse(t._)}catch(n){console.error(n)}f.cfg=t}},f={helper:a,plugins:{},cfg:{},get:function(){return f.cfg!=null&&f.cfg._!==void 0?f.cfg._:f.cfg},registerPlugin:function(t,n){n==null?n=t.types:t.types=n,typeof t.use=="function"&&t.use.call(f);for(let i=0;i<n.length;i+=1){const e=n[i].toLowerCase();f.plugins[e]==null&&(f.plugins[e]=t)}},set:function(t,n,i,e,o){o==null&&(o=!0),a.whenReady(function(){a.use(n),a.initFields(i||"form"),a.persistSettings(t,n,o,e)})},sync:function(t,n,i){socket.emit("admin.settings.get",{hash:t},function(e,o){e?typeof i=="function"&&i(e):a.whenReady(function(){a.use(o),a.initFields(n||"form"),typeof i=="function"&&i()})})},persist:function(t,n,i,e){const o=[],s=$("[data-key]",n||"form").toArray();e==null&&(e=!0);for(let u=0;u<s.length;u+=1){const r=$(s[u]),g=a.readValue(r);let c=f.get();const y=r.data("key").split("."),C=y[y.length-1];if(y.length>1)for(let x=0;x<y.length-1;x+=1){const P=y[x];P&&c!=null&&(c=c[P])}c!=null?g!=null?c[C]=g:delete c[C]:o.push(r.data("key"))}o.length&&m.alert({title:"Attributes Not Saved",message:"'"+o.join(", ")+"' could not be saved. Please contact the plugin-author!",type:"danger",timeout:5e3}),a.persistSettings(t,f.cfg,e,i)},load:function(t,n,i){i=i||function(){};const e=n.attr("data-socket-get");socket.emit(e||"admin.settings.get",{hash:t},function(o,s){if(o)return i(o);$(n).find("select[multiple]").each(function(r,g){const c=$(g).attr("name");if(c&&s.hasOwnProperty(c))try{s[c]=JSON.parse(s[c])}catch(y){console.error(y)}}),ajaxify.data[e?t:"settings"]=s,a.whenReady(function(){$(n).find("[data-sorted-list]").each(function(r,g){d(g,"get").call(f,$(g),t)})}),$(n).deserialize(s),S.fire("action:admin.settingsLoaded"),$(n).on("change","input, select, textarea",function(){app.flags=app.flags||{},app.flags._unsaved=!0});const u=document.getElementById("save");u&&l.e(6411).then(function(){var r=[l(6411)];(function(g){g.bind("ctrl+s",function(c){u.click(),c.preventDefault()})}).apply(null,r)}).catch(l.oe),i(null,s)})},save:function(t,n,i){n=$(n);const e=n.get(0).elements;if(f.check(e)&&n.length){const s=a.serializeForm(n);a.whenReady(function(){const r=n.find("[data-sorted-list]");r.length&&r.each((g,c)=>{d(c,"set").call(f,$(c),s)})});const u=n.attr("data-socket-set");socket.emit(u||"admin.settings.set",{hash:t,values:s},function(r){if(app.flags._unsaved=!1,ajaxify.data[u?t:"settings"]=s,typeof i=="function")i(r);else if(r)m.alert({title:"[[admin/admin:changes-not-saved]]",message:`[[admin/admin:changes-not-saved-message, ${r.message}]]`,type:"error",timeout:2500});else{const g=document.getElementById("save");g.classList.toggle("saved",!0),setTimeout(()=>{g.classList.toggle("saved",!1)},1500)}})}},check:function(t){const n=i=>{const e=i.target.closest(".form-group");e&&e.classList.add("has-error"),i.target.removeEventListener("invalid",n)};return Array.prototype.map.call(t,i=>{const e=i.closest(".form-group");return e&&e.classList.remove("has-error"),i.addEventListener("invalid",n),i.reportValidity()}).every(Boolean)}};return a.registerReadyJobs(1),Promise.all([l.e(23662),l.e(65285),l.e(19308)]).then(function(){var t=[l(75210),l(474),l(50397),l(71575),l(40054),l(17708),l(46700),l(59175)];(function(){for(let n=0;n<arguments.length;n+=1)f.registerPlugin(arguments[n]);a.beforeReadyJobsDecreased()}).apply(null,t)}).catch(l.oe),f}.apply(v,k),p!==void 0&&(R.exports=p)}}]);
