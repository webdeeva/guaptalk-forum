"use strict";(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[18470,61396,98463],{24187:(R,F,u)=>{var x,v;x=[u(64061)],v=function(){const S={};S.show=function(s,r){const e=s.hasOwnProperty("fileSize")&&s.fileSize!==void 0?parseInt(s.fileSize,10):!1;app.parseAndTranslate("modals/upload-file",{showHelp:s.hasOwnProperty("showHelp")&&s.showHelp!==void 0?s.showHelp:!0,fileSize:e,title:s.title||"[[global:upload-file]]",description:s.description||"",button:s.button||"[[global:upload]]",accept:s.accept?s.accept.replace(/,/g,"&#44; "):""},function(t){t.modal("show"),t.on("hidden.bs.modal",function(){t.remove()});const i=t.find("#uploadForm");i.attr("action",s.route),i.find("#params").val(JSON.stringify(s.params)),t.find("#fileUploadSubmitBtn").on("click",function(){$(this).addClass("disabled"),i.submit()}),i.submit(function(){return k(t,e,r),!1})})},S.hideAlerts=function(s){$(s).find("#alert-status, #alert-success, #alert-error, #upload-progress-box").addClass("hide")};function k(s,r,e){h(s,"status","[[uploads:uploading-file]]"),s.find("#upload-progress-bar").css("width","0%"),s.find("#upload-progress-box").show().removeClass("hide");const t=s.find("#fileInput");if(!t.val())return h(s,"error","[[uploads:select-file-to-upload]]");if(!y(t[0],r))return h(s,"error","[[error:file-too-big, "+r+"]]");S.ajaxSubmit(s,e)}function h(s,r,e){S.hideAlerts(s),r==="error"&&s.find("#fileUploadSubmitBtn").removeClass("disabled"),e=e.replace(/&amp;#44/g,"&#44"),s.find("#alert-"+r).translateText(e).removeClass("hide")}S.ajaxSubmit=function(s,r){s.find("#uploadForm").ajaxSubmit({headers:{"x-csrf-token":config.csrf_token},error:function(t){t=m(t),h(s,"error",t.responseJSON?.status?.message||t.responseJSON?.error||`[[error:upload-error-fallback, ${t.status} ${t.statusText}]]`)},uploadProgress:function(t,i,n,a){s.find("#upload-progress-bar").css("width",a+"%")},success:function(t){let i=m(t);t.hasOwnProperty("response")&&t.hasOwnProperty("status")&&t.status.code==="ok"&&(i=t.response.images),r(i[0].url),h(s,"success","[[uploads:upload-success]]"),setTimeout(function(){S.hideAlerts(s),s.modal("hide")},750)}})};function m(s){if(typeof s=="string")try{return JSON.parse(s)}catch(r){return console.error(r),{error:"[[error:parse-error]]"}}return s}function y(s,r){return window.FileReader&&r?s.files[0].size<=r*1e3:!0}return S}.apply(F,x),v!==void 0&&(R.exports=v)},54222:(R,F,u)=>{var x,v;x=[u(24187),u(6411),u(91749),u(29930),u(70012),u(89336)],v=function(S,k,h,m,y,s){const r={};r.populateTOC=function(){const n=$(".settings-header"),a=$('[component="settings/toc"]'),o=$('[component="settings/toc/list"]'),c=$('[component="settings/main/header"]');if(n.length>1&&o.length){n.each(function(l){const p=$(this),g=p.text(),A=p.parent().attr("id")||`section${l+1}`;A.startsWith("section")&&p.parent().attr("id",A),o.append(`<a class="btn btn-ghost btn-sm text-xs text-start text-decoration-none" href="#${A}">${g}</a>`)});const d=c.outerHeight(!0);o.find("a").on("click",function(l){l.preventDefault();const p=$(this).attr("href");return $(p)[0].scrollIntoView(),window.location.hash=p,scrollBy(0,-d),setTimeout(()=>{o.find("a").removeClass("active"),$(this).addClass("active")},10),!1}),new s.ScrollSpy($("#spy-container")[0],{target:"#settings-navbar",rootMargin:"-10% 0px -70%",smoothScroll:!0});const f=$(`${window.location.hash}`);f.length&&$("html, body").animate({scrollTop:f.offset().top-d+"px"},400),a.removeClass("hidden")}},r.prepare=function(n){const a=$("#content [data-field]"),o=a.length,c=$("#save"),d=$("#revert");let f,l,p,g;a.on("change",function(){app.flags=app.flags||{},app.flags._unsaved=!0});const A=["text","hidden","password","textarea","number"];for(f=0;f<o;f+=1)if(g=a.eq(f),l=g.attr("data-field"),p=g.attr("type"),app.config.hasOwnProperty(l))if(g.is("input")&&p==="checkbox"){const C=parseInt(app.config[l],10)===1;g.prop("checked",C)}else(g.is("textarea")||g.is("select")||g.is("input")&&A.indexOf(p)!==-1)&&g.val(app.config[l]);d.off("click").on("click",function(){ajaxify.refresh()}),c.off("click").on("click",function(C){C.preventDefault(),y.check(document.querySelectorAll("#content [data-field]"))&&i(a,function(b){if(b)return m.alert({alert_id:"config_status",timeout:2500,title:"[[admin/admin:changes-not-saved]]",message:`[[admin/admin:changes-not-saved-message, ${b.message}]]`,type:"danger"});app.flags._unsaved=!1,r.toggleSaveSuccess(c),h.fire("action:admin.settingsSaved")})}),k.bind("ctrl+s",function(C){c.click(),C.preventDefault()}),e(),t(),$("#clear-sitemap-cache").off("click").on("click",function(){return socket.emit("admin.settings.clearSitemapCache",function(){m.success("Sitemap Cache Cleared!")}),!1}),typeof n=="function"&&n(),setTimeout(function(){h.fire("action:admin.settingsLoaded")},0)},r.toggleSaveSuccess=function(n){const a=n.get(0);a&&(a.classList.toggle("saved",!0),setTimeout(()=>{a.classList.toggle("saved",!1)},1500))};function e(){$('#content input[data-action="upload"]').each(function(){const n=$(this);n.on("click",function(){S.show({title:n.attr("data-title"),description:n.attr("data-description"),route:n.attr("data-route"),params:{},showHelp:n.attr("data-help")?n.attr("data-help")===1:void 0,accept:n.attr("data-accept")},function(a){$("#"+n.attr("data-target")).val(a)})})})}function t(){$('[data-field-type="tagsinput"]').tagsinput({tagClass:"badge bg-info",confirmKeys:[13,44],trimValue:!0}),app.flags._unsaved=!1}r.remove=function(n){socket.emit("admin.config.remove",n)};function i(n,a){const o={};n.each(function(){const c=$(this),d=c.attr("data-field");let f,l;if(c.is("input"))switch(l=c.attr("type"),l){case"text":case"password":case"hidden":case"textarea":case"number":f=c.val();break;case"checkbox":f=c.prop("checked")?"1":"0";break}else(c.is("textarea")||c.is("select"))&&(f=c.val());o[d]=f}),socket.emit("admin.config.setMultiple",o,function(c){if(c)return a(c);for(const[d,f]of Object.entries(o))app.config[d]=f;a()})}return r}.apply(F,x),v!==void 0&&(R.exports=v)},70012:(R,F,u)=>{var x,v;x=[u(91749),u(29930)],v=function(S,k){let h=[],m=0;function y(e,t){typeof e!="string"&&(e=$(e),e=e.data("type")||e.attr("type")||e.prop("tagName"));const i=r.plugins[e.toLowerCase()];if(i==null)return;const n=i[t];return typeof n=="function"?n:null}const s={deepClone:function(e){return typeof e=="object"?JSON.parse(JSON.stringify(e)):e},createElement:function(e,t,i){const n=document.createElement(e);for(const[a,o]of Object.entries(t))n.setAttribute(a,o);return i&&n.appendChild(document.createTextNode(i)),n},initElement:function(e){const t=y(e,"init");t?.call(r,$(e))},destructElement:function(e){const t=y(e,"destruct");t?.call(r,$(e))},createElementOfType:function(e,t,i){let n;const a=y(e,"create");return a!=null?n=$(a.call(r,e,t,i)):(i==null&&(i={}),e!=null&&(i.type=e),n=$(s.createElement(t||"input",i))),n.data("type",e),s.initElement(n),n},cleanArray:function(e,t,i){const n=[];if(!t&&i)return e;for(let a=0;a<e.length;a+=1){let o=e[a];t&&(o===!!o?o=+o:o&&typeof o.trim=="function"&&(o=o.trim())),(i||o!=null&&o.length)&&n.push(o)}return n},isTrue:function(e){return e==="true"||+e==1},isFalse:function(e){return e==="false"||+e==0},readValue:function(e){let t=!s.isFalse(e.data("empty"));const i=!s.isFalse(e.data("trim")),n=e.data("split"),a=y(e,"get");let o;if(a!=null)return a.call(r,e,i,t);if(n!=null){t=s.isTrue(e.data("empty")),o=e.val();const c=o!=null&&o.split(n||",")||[];return s.cleanArray(c,i,t)}if(o=e.val(),i&&o!=null&&typeof o.trim=="function"&&(o=o.trim()),t||o!==void 0&&(o==null||o.length!==0))return o},fillField:function(e,t){const i=y(e,"set");let n=e.data("trim");if(n=n!=="false"&&+n!=0,i!=null)return i.call(r,e,t,n);t instanceof Array&&(t=t.join(e.data("split")||(n?", ":","))),n&&t&&typeof t.trim=="function"?(t=t.trim(),typeof t.toString=="function"&&(t=t.toString())):t!=null?(typeof t.toString=="function"&&(t=t.toString()),n&&(t=t.trim())):t="",t!==void 0&&e.val(t)},initFields:function(e){$("[data-key]",e).each(function(t,i){i=$(i);const n=y(i,"init"),a=i.data("key").split(".");let o=r.get();n?.call(r,i);for(let c=0;c<a.length;c+=1){const d=a[c];d&&o!=null&&(o=o[d])}s.fillField(i,o)})},registerReadyJobs:function(e){return m+=e,m},beforeReadyJobsDecreased:function(e){if(e==null&&(e=1),m>0&&(m-=e,m<=0)){for(let t=0;t<h.length;t+=1)h[t]();h=[]}},whenReady:function(e){m<=0?e():h.push(e)},serializeForm:function(e){const t=e.serializeObject();return e.find('input[type="checkbox"]').each(function(i,n){n=$(n),n.is(":checked")||(t[n.attr("name")]="off")}),e.find("select[multiple]").each(function(i,n){n=$(n),t[n.attr("name")]=JSON.stringify(n.val())}),t},persistSettings:function(e,t,i,n){t!=null&&t._!=null&&typeof t._!="string"&&(t=s.deepClone(t),t._=JSON.stringify(t._)),socket.emit("admin.settings.set",{hash:e,values:t},function(a){i&&(a?k.alert({title:"[[admin/admin:changes-not-saved]]",type:"danger",message:`[[admin/admin/changes-not-saved-message, ${a.message}]]`,timeout:5e3}):k.alert({title:"[[admin/admin:changes-saved]]",type:"success",message:"[[admin/admin:changes-saved-message]]",timeout:2500})),typeof n=="function"&&n(a)})},use:function(e){try{e._=JSON.parse(e._)}catch(t){console.error(t)}r.cfg=e}},r={helper:s,plugins:{},cfg:{},get:function(){return r.cfg!=null&&r.cfg._!==void 0?r.cfg._:r.cfg},registerPlugin:function(e,t){t==null?t=e.types:e.types=t,typeof e.use=="function"&&e.use.call(r);for(let i=0;i<t.length;i+=1){const n=t[i].toLowerCase();r.plugins[n]==null&&(r.plugins[n]=e)}},set:function(e,t,i,n,a){a==null&&(a=!0),s.whenReady(function(){s.use(t),s.initFields(i||"form"),s.persistSettings(e,t,a,n)})},sync:function(e,t,i){socket.emit("admin.settings.get",{hash:e},function(n,a){n?typeof i=="function"&&i(n):s.whenReady(function(){s.use(a),s.initFields(t||"form"),typeof i=="function"&&i()})})},persist:function(e,t,i,n){const a=[],o=$("[data-key]",t||"form").toArray();n==null&&(n=!0);for(let c=0;c<o.length;c+=1){const d=$(o[c]),f=s.readValue(d);let l=r.get();const p=d.data("key").split("."),g=p[p.length-1];if(p.length>1)for(let A=0;A<p.length-1;A+=1){const C=p[A];C&&l!=null&&(l=l[C])}l!=null?f!=null?l[g]=f:delete l[g]:a.push(d.data("key"))}a.length&&k.alert({title:"Attributes Not Saved",message:"'"+a.join(", ")+"' could not be saved. Please contact the plugin-author!",type:"danger",timeout:5e3}),s.persistSettings(e,r.cfg,n,i)},load:function(e,t,i){i=i||function(){};const n=t.attr("data-socket-get");socket.emit(n||"admin.settings.get",{hash:e},function(a,o){if(a)return i(a);$(t).find("select[multiple]").each(function(d,f){const l=$(f).attr("name");if(l&&o.hasOwnProperty(l))try{o[l]=JSON.parse(o[l])}catch(p){console.error(p)}}),ajaxify.data[n?e:"settings"]=o,s.whenReady(function(){$(t).find("[data-sorted-list]").each(function(d,f){y(f,"get").call(r,$(f),e)})}),$(t).deserialize(o),S.fire("action:admin.settingsLoaded"),$(t).on("change","input, select, textarea",function(){app.flags=app.flags||{},app.flags._unsaved=!0});const c=document.getElementById("save");c&&u.e(6411).then(function(){var d=[u(6411)];(function(f){f.bind("ctrl+s",function(l){c.click(),l.preventDefault()})}).apply(null,d)}).catch(u.oe),i(null,o)})},save:function(e,t,i){t=$(t);const n=t.get(0).elements;if(r.check(n)&&t.length){const o=s.serializeForm(t);s.whenReady(function(){const d=t.find("[data-sorted-list]");d.length&&d.each((f,l)=>{y(l,"set").call(r,$(l),o)})});const c=t.attr("data-socket-set");socket.emit(c||"admin.settings.set",{hash:e,values:o},function(d){if(app.flags._unsaved=!1,ajaxify.data[c?e:"settings"]=o,typeof i=="function")i(d);else if(d)k.alert({title:"[[admin/admin:changes-not-saved]]",message:`[[admin/admin:changes-not-saved-message, ${d.message}]]`,type:"error",timeout:2500});else{const f=document.getElementById("save");f.classList.toggle("saved",!0),setTimeout(()=>{f.classList.toggle("saved",!1)},1500)}})}},check:function(e){const t=i=>{const n=i.target.closest(".form-group");n&&n.classList.add("has-error"),i.target.removeEventListener("invalid",t)};return Array.prototype.map.call(e,i=>{const n=i.closest(".form-group");return n&&n.classList.remove("has-error"),i.addEventListener("invalid",t),i.reportValidity()}).every(Boolean)}};return s.registerReadyJobs(1),Promise.all([u.e(23662),u.e(65285),u.e(19308)]).then(function(){var e=[u(75210),u(474),u(50397),u(71575),u(40054),u(17708),u(46700),u(59175)];(function(){for(let t=0;t<arguments.length;t+=1)r.registerPlugin(arguments[t]);s.beforeReadyJobsDecreased()}).apply(null,e)}).catch(u.oe),r}.apply(F,x),v!==void 0&&(R.exports=v)}}]);
