"use strict";(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[24866,26174,49980],{2954:(C,v,o)=>{var d;d=function(){const u={};return u.init=function(f){if(utils.isTouchDevice())return;const r=f.find('[component="group-selector-search"]');if(!r.length)return;const E=r.parents('[component="group-selector"]').length>0,y=f.find('[component="group-list"] [data-name]');f.on("show.bs.dropdown",function(){function l(){const e=r.find("input").val().toLowerCase();let n=!0;y.each(function(){const s=$(this),t=s.attr("data-name").toLowerCase().indexOf(e)!==-1;n&&t&&(n=!1),s.toggleClass("hidden",!t)}),f.find('[component="group-list"] [component="group-no-matches"]').toggleClass("hidden",!n)}E&&r.removeClass("hidden"),r.on("click",function(e){e.preventDefault(),e.stopPropagation()}),r.find("input").val("").on("keyup",l),l()}),f.on("shown.bs.dropdown",function(){r.find("input").focus()}),f.on("hide.bs.dropdown",function(){E&&r.addClass("hidden"),r.off("click").find("input").off("keyup")})},u}.call(v,o,v,C),d!==void 0&&(C.exports=d)},13230:(C,v,o)=>{var d,u,f;(function(r){u=[o(53050)],d=r,f=typeof d=="function"?d.apply(v,u):d,f!==void 0&&(C.exports=f)})(function(r){const E=r("[^\\p{L}\\s\\d\\-_@.]","g"),y=/[^\w\s\d\-_@.]/g,l=/^\s+|\s+$/g,e=/\s+/g,n=/-+/g,s=/-$/g,t=/^-/g,m=/^[\w\d\s.,\-@]+$/;return function(a,p){return a?(a=String(a).replace(l,""),m.test(a)?a=a.replace(y,"-"):a=r.replace(a,E,"-"),a=p?a:a.toLocaleLowerCase(),a=a.replace(e,"-"),a=a.replace(n,"-"),a=a.replace(s,""),a=a.replace(t,""),a):""}})},65348:(C,v,o)=>{var d,u;d=[o(96349),o(33530),o(91749),o(17459)],u=function(f,r,E,y){const l={};return l.init=function(e,n){if(!e||!e.length)return;n=n||{};const s=n.onSelect||function(){};n.states=n.states||["watching","tracking","notwatching","ignoring"],n.template=n.template||"partials/category/selector-dropdown-left",E.fire("action:category.selector.options",{el:e,options:n}),f.init(e,n);const t={el:e,selectedCategory:null};e.on("click","[data-cid]",function(){const g=$(this);return g.hasClass("disabled")?!1:(t.selectCategory(g.attr("data-cid")),s(t.selectedCategory))});let m=t.el.find('[component="category-selector-selected"]').html();return y.translate(m,g=>{m=g}),t.selectCategory=function(g){const a=t.el.find('[data-cid="'+g+'"]');t.selectedCategory={cid:g,name:a.attr("data-name")},a.length?t.el.find('[component="category-selector-selected"]').html(a.find('[component="category-markup"]').html()):t.el.find('[component="category-selector-selected"]').html(m)},t.getSelectedCategory=function(){return t.selectedCategory},t.getSelectedCid=function(){return t.selectedCategory?t.selectedCategory.cid:0},n.hasOwnProperty("selectedCategory")&&app.parseAndTranslate(n.template,{selectedCategory:n.selectedCategory},function(g){t.el.find('[component="category-selector-selected"]').html(g.find('[component="category-selector-selected"]').html())}),t},l.modal=function(e){e=e||{},e.onSelect=e.onSelect||function(){},e.onSubmit=e.onSubmit||function(){},app.parseAndTranslate("admin/partials/categories/select-category",{message:e.message},function(n){const s=r.dialog({title:e.title||"[[modules:composer.select-category]]",message:n,buttons:{save:{label:"[[global:select]]",className:"btn-primary",callback:m}}}),t=l.init(s.find('[component="category-selector"]'),e);function m(g){return g.preventDefault(),t.selectedCategory&&(e.onSubmit(t.selectedCategory),s.modal("hide")),!1}e.openOnLoad&&s.on("shown.bs.modal",function(){s.find(".dropdown-toggle").dropdown("toggle")}),s.find("form").on("submit",m)})},l}.apply(v,d),u!==void 0&&(C.exports=u)},72296:(C,v,o)=>{var d,u;d=[o(89664),o(67308),o(17459),o(65348),o(2954),o(13230),o(49897),o(33530),o(29930),o(54222)],u=function(f,r,E,y,l,e,n,s,t,m){const g={};g.init=function(){const c=$("#group-icon"),i=$("#change-group-user-title"),h=$("#change-group-label-color"),A=$("#change-group-text-color"),L=$("#group-label-preview"),k=$("#group-label-preview-text"),D=ajaxify.data.group.name;f.init("admin/manage/group"),i.on("keyup",function(){k.translateText(i.val())}),h.on("keyup input",function(){L.css("background-color",h.val()||"#000000")}),A.on("keyup input",function(){L.css("color",A.val()||"#ffffff")}),a(),$("#group-icon-container").on("click",function(){const b=c.attr("value");r.init(c,function(){let w=c.attr("value");w!==b&&(w==="fa-nbb-none"&&(w="hidden"),$("#group-icon-preview").attr("class","fa fa-fw "+(w||"hidden")),app.flags=app.flags||{},app.flags._unsaved=!0)})}),y.init($('.edit-privileges-selector [component="category-selector"]'),{onSelect:function(b){p(b.cid)},showLinks:!0});const x=y.init($('.member-post-cids-selector [component="category-selector"]'),{onSelect:function(b){let w=($("#memberPostCids").val()||"").split(",").map(S=>parseInt(S,10));return w.push(b.cid),w=w.filter((S,P,T)=>T.indexOf(S)===P),$("#memberPostCids").val(w.join(",")),x.selectCategory(0),!1}});l.init($('[component="group-selector"]')),$("form [data-property]").on("change",function(){app.flags=app.flags||{},app.flags._unsaved=!0}),$('[data-action="delete"]').on("click",function(){s.confirm("[[admin/manage/groups:alerts.confirm-delete]]",function(b){b&&n.del(`/groups/${e(ajaxify.data.group.name)}`,{}).then(()=>{ajaxify.go("/admin/managegroups")}).catch(t.error)})}),$("#save").on("click",function(){return n.put(`/groups/${e(D)}`,{name:$("#change-group-name").val(),userTitle:i.val(),description:$("#change-group-desc").val(),icon:c.attr("value"),labelColor:h.val(),textColor:A.val(),userTitleEnabled:$("#group-userTitleEnabled").is(":checked"),private:$("#group-private").is(":checked"),hidden:$("#group-hidden").is(":checked"),memberPostCids:$("#memberPostCids").val(),disableJoinRequests:$("#group-disableJoinRequests").is(":checked"),disableLeave:$("#group-disableLeave").is(":checked")}).then(()=>{const b=$("#change-group-name").val();D!==b&&ajaxify.go("admin/manage/groups/"+encodeURIComponent(b),void 0,!0),m.toggleSaveSuccess($("#save"))}).catch(t.error),!1})};function a(){$('[component="groups/members"]').on("click","[data-action]",function(){const c=$(this),i=c.parents("[data-uid]"),h=i.find(".member-name .user-owner-icon"),A=!h.hasClass("invisible"),L=i.attr("data-uid");switch(c.attr("data-action")){case"toggleOwnership":n[A?"del":"put"](`/groups/${ajaxify.data.group.slug}/ownership/${L}`,{}).then(()=>{h.toggleClass("invisible")}).catch(t.error);break;case"kick":s.confirm("[[admin/manage/groups:edit.confirm-remove-user]]",function(D){D&&n.del("/groups/"+ajaxify.data.group.slug+"/membership/"+L).then(()=>{i.slideUp().remove()}).catch(t.error)});break;default:break}})}function p(c){if(c){const i="admin/manage/privileges/"+c+"?group="+ajaxify.data.group.nameEncoded;if(app.flags&&app.flags._unsaved===!0){E.translate("[[global:unsaved-changes]]",function(h){s.confirm(h,function(A){A&&(app.flags._unsaved=!1,ajaxify.go(i))})});return}ajaxify.go(i)}}return g}.apply(v,d),u!==void 0&&(C.exports=u)},96349:(C,v,o)=>{var d,u;d=[o(29930),o(89336),o(49897)],u=function(f,r,E){const y={};return y.init=function(l,e){let n=e.defaultCategories||null;e=e||{},e.privilege=e.privilege||"topics:read",e.states=e.states||["watching","tracking","notwatching","ignoring"],e.cacheList=e.hasOwnProperty("cacheList")?e.cacheList:!0;let s=[];Array.isArray(e.localCategories)&&(s=e.localCategories.map(p=>({...p})),n&&(n=[...s,...n])),e.selectedCids=e.selectedCids||ajaxify.data.selectedCids||[];const t=l.find('[component="category-selector-search"]');if(!t.length)return;const m=t.parents('[component="category/dropdown"]').length>0||t.parents('[component="category-selector"]').length>0;l.on("show.bs.dropdown",function(){m&&t.removeClass("hidden");function p(){const c=t.find("input").val();c.length>1||!c&&!n?g(c,function(i){n=e.cacheList&&(n||i),a(i)}):!c&&n&&a(n)}t.on("click",function(c){c.preventDefault(),c.stopPropagation()}),t.find("input").val("").on("keyup",utils.debounce(p,300)),p()}),l.on("shown.bs.dropdown",function(){["xs","sm"].includes(utils.findBootstrapEnvironment())||t.find("input").focus()}),l.on("hide.bs.dropdown",function(){m&&t.addClass("hidden"),t.off("click"),t.find("input").off("keyup")});function g(p,c){E.get("/search/categories",{search:p,query:utils.params(),parentCid:e.parentCid||0,selectedCids:e.selectedCids,privilege:e.privilege,states:e.states,showLinks:e.showLinks},function(i,{categories:h}){if(i)return f.error(i);c(s.concat(h))})}function a(p){const c=e.selectedCids.map(String);p.forEach(function(i){i.selected=c.includes(String(i.cid))}),app.parseAndTranslate(e.template,{categoryItems:p.slice(0,200),selectedCategory:ajaxify.data.selectedCategory,allCategoriesUrl:ajaxify.data.allCategoriesUrl},function(i){l.find('[component="category/list"]').html(i.find('[component="category/list"]').html()),l.find('[component="category/list"] [component="category/no-matches"]').toggleClass("hidden",!!p.length);const h=r.Dropdown.getInstance(l.find(".dropdown-toggle").get(0));h&&h.update()})}},y}.apply(v,d),u!==void 0&&(C.exports=u)}}]);
