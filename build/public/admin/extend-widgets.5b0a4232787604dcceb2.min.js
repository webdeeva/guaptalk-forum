(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[6871],{79914:(_,A,m)=>{var v,w,b;/*!
* jQuery UI Droppable 1.14.1
* https://jqueryui.com
*
* Copyright OpenJS Foundation and other contributors
* Released under the MIT license.
* https://jquery.org/license
*/(function(a){"use strict";w=[m(74692),m(41758),m(23662),m(56883),m(69139)],v=a,b=typeof v=="function"?v.apply(A,w):v,b!==void 0&&(_.exports=b)})(function(a){"use strict";return a.widget("ui.droppable",{version:"1.14.1",widgetEventPrefix:"drop",options:{accept:"*",addClasses:!0,greedy:!1,scope:"default",tolerance:"intersect",activate:null,deactivate:null,drop:null,out:null,over:null},_create:function(){var e,t=this.options,i=t.accept;this.isover=!1,this.isout=!0,this.accept=typeof i=="function"?i:function(d){return d.is(i)},this.proportions=function(){if(arguments.length)e=arguments[0];else return e||(e={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight})},this._addToManager(t.scope),t.addClasses&&this._addClass("ui-droppable")},_addToManager:function(e){a.ui.ddmanager.droppables[e]=a.ui.ddmanager.droppables[e]||[],a.ui.ddmanager.droppables[e].push(this)},_splice:function(e){for(var t=0;t<e.length;t++)e[t]===this&&e.splice(t,1)},_destroy:function(){var e=a.ui.ddmanager.droppables[this.options.scope];this._splice(e)},_setOption:function(e,t){if(e==="accept")this.accept=typeof t=="function"?t:function(d){return d.is(t)};else if(e==="scope"){var i=a.ui.ddmanager.droppables[this.options.scope];this._splice(i),this._addToManager(t)}this._super(e,t)},_activate:function(e){var t=a.ui.ddmanager.current;this._addActiveClass(),t&&this._trigger("activate",e,this.ui(t))},_deactivate:function(e){var t=a.ui.ddmanager.current;this._removeActiveClass(),t&&this._trigger("deactivate",e,this.ui(t))},_over:function(e){var t=a.ui.ddmanager.current;!t||(t.currentItem||t.element)[0]===this.element[0]||this.accept.call(this.element[0],t.currentItem||t.element)&&(this._addHoverClass(),this._trigger("over",e,this.ui(t)))},_out:function(e){var t=a.ui.ddmanager.current;!t||(t.currentItem||t.element)[0]===this.element[0]||this.accept.call(this.element[0],t.currentItem||t.element)&&(this._removeHoverClass(),this._trigger("out",e,this.ui(t)))},_drop:function(e,t){var i=t||a.ui.ddmanager.current,d=!1;return!i||(i.currentItem||i.element)[0]===this.element[0]||(this.element.find(":data(ui-droppable)").not(".ui-draggable-dragging").each(function(){var o=a(this).droppable("instance");if(o.options.greedy&&!o.options.disabled&&o.options.scope===i.options.scope&&o.accept.call(o.element[0],i.currentItem||i.element)&&a.ui.intersect(i,a.extend(o,{offset:o.element.offset()}),o.options.tolerance,e))return d=!0,!1}),d)?!1:this.accept.call(this.element[0],i.currentItem||i.element)?(this._removeActiveClass(),this._removeHoverClass(),this._trigger("drop",e,this.ui(i)),this.element):!1},ui:function(e){return{draggable:e.currentItem||e.element,helper:e.helper,position:e.position,offset:e.positionAbs}},_addHoverClass:function(){this._addClass("ui-droppable-hover")},_removeHoverClass:function(){this._removeClass("ui-droppable-hover")},_addActiveClass:function(){this._addClass("ui-droppable-active")},_removeActiveClass:function(){this._removeClass("ui-droppable-active")}}),a.ui.intersect=function(){function e(t,i,d){return t>=i&&t<i+d}return function(t,i,d,o){if(!i.offset)return!1;var l=(t.positionAbs||t.position.absolute).left+t.margins.left,r=(t.positionAbs||t.position.absolute).top+t.margins.top,n=l+t.helperProportions.width,s=r+t.helperProportions.height,c=i.offset.left,p=i.offset.top,u=c+i.proportions().width,f=p+i.proportions().height;switch(d){case"fit":return c<=l&&n<=u&&p<=r&&s<=f;case"intersect":return c<l+t.helperProportions.width/2&&n-t.helperProportions.width/2<u&&p<r+t.helperProportions.height/2&&s-t.helperProportions.height/2<f;case"pointer":return e(o.pageY,p,i.proportions().height)&&e(o.pageX,c,i.proportions().width);case"touch":return(r>=p&&r<=f||s>=p&&s<=f||r<p&&s>f)&&(l>=c&&l<=u||n>=c&&n<=u||l<c&&n>u);default:return!1}}}(),a.ui.ddmanager={current:null,droppables:{default:[]},prepareOffsets:function(e,t){var i,d,o=a.ui.ddmanager.droppables[e.options.scope]||[],l=t?t.type:null,r=(e.currentItem||e.element).find(":data(ui-droppable)").addBack();t:for(i=0;i<o.length;i++)if(!(o[i].options.disabled||e&&!o[i].accept.call(o[i].element[0],e.currentItem||e.element))){for(d=0;d<r.length;d++)if(r[d]===o[i].element[0]){o[i].proportions().height=0;continue t}o[i].visible=o[i].element.css("display")!=="none",o[i].visible&&(l==="mousedown"&&o[i]._activate.call(o[i],t),o[i].offset=o[i].element.offset(),o[i].proportions({width:o[i].element[0].offsetWidth,height:o[i].element[0].offsetHeight}))}},drop:function(e,t){var i=!1;return a.each((a.ui.ddmanager.droppables[e.options.scope]||[]).slice(),function(){this.options&&(!this.options.disabled&&this.visible&&a.ui.intersect(e,this,this.options.tolerance,t)&&(i=this._drop.call(this,t)||i),!this.options.disabled&&this.visible&&this.accept.call(this.element[0],e.currentItem||e.element)&&(this.isout=!0,this.isover=!1,this._deactivate.call(this,t)))}),i},dragStart:function(e,t){e.element.parentsUntil("body").on("scroll.droppable",function(){e.options.refreshPositions||a.ui.ddmanager.prepareOffsets(e,t)})},drag:function(e,t){e.options.refreshPositions&&a.ui.ddmanager.prepareOffsets(e,t),a.each(a.ui.ddmanager.droppables[e.options.scope]||[],function(){if(!(this.options.disabled||this.greedyChild||!this.visible)){var i,d,o,l=a.ui.intersect(e,this,this.options.tolerance,t),r=!l&&this.isover?"isout":l&&!this.isover?"isover":null;r&&(this.options.greedy&&(d=this.options.scope,o=this.element.parents(":data(ui-droppable)").filter(function(){return a(this).droppable("instance").options.scope===d}),o.length&&(i=a(o[0]).droppable("instance"),i.greedyChild=r==="isover")),i&&r==="isover"&&(i.isover=!1,i.isout=!0,i._out.call(i,t)),this[r]=!0,this[r==="isout"?"isover":"isout"]=!1,this[r==="isover"?"_over":"_out"].call(this,t),i&&r==="isout"&&(i.isout=!1,i.isover=!0,i._over.call(i,t)))}})},dragStop:function(e,t){e.element.parentsUntil("body").off("scroll.droppable"),e.options.refreshPositions||a.ui.ddmanager.prepareOffsets(e,t)}},a.uiBackCompat===!0&&a.widget("ui.droppable",a.ui.droppable,{options:{hoverClass:!1,activeClass:!1},_addActiveClass:function(){this._super(),this.options.activeClass&&this.element.addClass(this.options.activeClass)},_removeActiveClass:function(){this._super(),this.options.activeClass&&this.element.removeClass(this.options.activeClass)},_addHoverClass:function(){this._super(),this.options.hoverClass&&this.element.addClass(this.options.hoverClass)},_removeHoverClass:function(){this._super(),this.options.hoverClass&&this.element.removeClass(this.options.hoverClass)}}),a.ui.droppable})},92701:(_,A,m)=>{"use strict";var v,w;v=[m(33530),m(29930),m(65285),m(41758),m(79914)],w=function(b,a){const e={};e.init=function(){$("#widgets .dropdown .dropdown-menu a").on("click",function(l){const r=$(this);$("#widgets .tab-pane").removeClass("active");const n=r.attr("data-template");return $('#widgets .tab-pane[data-template="'+n+'"]').addClass("active"),$("#widgets .selected-template").text(n),$("#widgets .dropdown").trigger("click"),l.preventDefault(),!1}),$("#widget-selector").on("change",function(){$(".available-widgets [data-widget]").addClass("hide"),$('.available-widgets [data-widget="'+$(this).val()+'"]').removeClass("hide")}),$("#widget-selector").trigger("change"),d(),o(),$("#hide-drafts").on("click",function(){$(this).addClass("hidden"),$("#show-drafts").removeClass("hidden"),$('[component="drafts-container"]').addClass("hidden"),$('[component="widgets-container"]').addClass("col-md-12").removeClass("col-md-6")}),$("#show-drafts").on("click",function(){$(this).addClass("hidden"),$("#hide-drafts").removeClass("hidden"),$('[component="drafts-container"]').removeClass("hidden"),$('[component="widgets-container"]').addClass("col-md-6").removeClass("col-md-12")})};function t(){const l=$('[component="drafts-container"]');$('[data-location="drafts"]').appendTo(l),$("#widgets .available-widgets .widget-panel").draggable({helper:function(n){return $(n.target).parents(".widget-panel").clone()},distance:10,connectToSortable:".widget-area"}),$("#widgets .available-containers .containers > [data-container-html]").draggable({helper:function(n){let s=$(n.target);return s=s.attr("data-container-html")?s:s.parents("[data-container-html]"),s.clone().addClass("block").width(s.width()).css("opacity","0.5")},distance:10}).each(function(){$(this).attr("data-container-html",$(this).attr("data-container-html").replace(/\\\{([\s\S]*?)\\\}/g,"{$1}"))}),$("#widgets .widget-area").sortable({update:function(n,s){i(s.item)},start:function(){l.find('[data-location="drafts"]>div').removeClass("overflow-auto").css({"max-height":"initial"})},stop:function(){l.find('[data-location="drafts"]>div').addClass("overflow-auto").css({"max-height":"calc(100vh - 200px)"})},connectWith:"div"}).on("click",".delete-widget",function(){const n=$(this).parents(".widget-panel");b.confirm("[[admin/extend/widgets:alert.confirm-delete]]",function(s){s&&n.remove()})}).on("mouseup","> .card > .card-header",function(n){$(this).parent().is(".ui-sortable-helper")||$(n.target).closest(".delete-widget").length||$(this).parent().children(".card-body").toggleClass("hidden")}),$("#save").on("click",r);function r(){const n=[];$("#widgets [data-template][data-location]").each(function(s,c){c=$(c);const p=c.attr("data-template"),u=c.attr("data-location"),f=c.children(".widget-area"),h=[];f.find(".widget-panel[data-widget]").each(function(){const g={};$(this).find("form").serializeArray().forEach(E=>{const{name:C,value:x}=E;C&&(g[C]?(Array.isArray(g[C])||(g[C]=[g[C]]),g[C].push(x)):g[C]=x)}),h.push({widget:$(this).attr("data-widget"),data:g})}),n.push({template:p,location:u,widgets:h})}),socket.emit("admin.widgets.set",n,function(s){if(s)return a.error(s);const c=document.getElementById("save");c.classList.toggle("saved",!0),setTimeout(()=>{c.classList.toggle("saved",!1)},5e3)})}$(".color-selector").on("click",".btn",function(){const n=$(this),s=n.parents(".color-selector"),c=s.parents("[data-container-html]"),p=[];s.children().each(function(){p.push($(this).attr("data-class"))}),c.removeClass(p.join(" ")).addClass(n.attr("data-class")),c.attr("data-container-html",c.attr("data-container-html").replace(/class="[a-zA-Z0-9-\s]+"/,'class="'+c[0].className.replace(" pointer ui-draggable ui-draggable-handle","")+'"'))})}function i(l){l.hasClass("block")||l.addClass("block").css("width","").css("height","").droppable({accept:"[data-container-html]",drop:function(r,n){const s=$(this);s.find(".card-body .container-html").val(n.draggable.attr("data-container-html")),s.find(".card-body").removeClass("hidden")},hoverClass:"container-hover"}).children(".card-header").append('<div class="float-end pointer"><span class="delete-widget"><i class="fa fa-times-circle"></i></span></div><div class="float-start pointer"><span class="toggle-widget"><i class="fa fa-chevron-circle-down"></i></span>&nbsp;</div>').children("small").html("")}function d(){function l(r,n){if(n.title){const s=r.find(".card-header strong");s.text(s.text()+" - "+n.title)}return r.find("input, textarea, select").each(function(){const s=$(this),c=n[s.attr("name")];s.attr("type")==="checkbox"?s.prop("checked",!!c).trigger("change"):s.val(c)}),r}$.get(config.relative_path+"/api/admin/extend/widgets",function(r){const n=r.areas;for(let s=0;s<n.length;s+=1){const c=n[s],p=$('#widgets .area[data-template="'+c.template+'"][data-location="'+c.location+'"]').find(".widget-area");p.html("");for(let u=0;u<c.data.length;u+=1){const f=c.data[u],h=$('.available-widgets [data-widget="'+f.widget+'"]').clone(!0).removeClass("hide");p.append(l(h,f.data)),i(h)}}t()})}function o(){const l=$('[component="clone"]'),r=$('[component="clone/button"]');l.find(".dropdown-menu li").on("click",function(){const n=$(this).find("a").text();r.translateHtml("[[admin/extend/widgets:clone-from]] <strong>"+n+"</strong>"),r.attr("data-template",n)}),r.on("click",function(){const n=r.attr("data-template");if(!n)return a.error("[[admin/extend/widgets:error.select-clone]]");const s=$("#active-widgets .active.tab-pane[data-template] .area"),c=$('#active-widgets .tab-pane[data-template="'+n+'"] .area'),p=s.map(function(){return $(this).attr("data-location")}).get(),u=c.map(function(){const h=$(this).attr("data-location");return p.indexOf(h)!==-1?h:void 0}).get().filter(function(h){return h});function f(h){$('#active-widgets .tab-pane[data-template="'+n+'"] [data-location="'+h+'"]').each(function(){$(this).find("[data-widget]").each(function(){const g=$(this).clone(!0);$('#active-widgets .active.tab-pane[data-template]:not([data-template="global"]) [data-location="'+h+'"] .widget-area').append(g)})})}for(let h=0,g=u.length;h<g;h++){const y=u[h];f(y)}a.success("[[admin/extend/widgets:alert.clone-success]]")})}return e}.apply(A,v),w!==void 0&&(_.exports=w)}}]);
