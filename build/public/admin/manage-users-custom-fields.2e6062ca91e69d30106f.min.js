(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[39723],{71135:(p,y,i)=>{var c,d;c=[i(33530),i(29930),i(67308),i(65285)],d=function(l,r,h){const m={};m.init=function(){const t=$("table");t.on("click",'[data-action="edit"]',function(){const n=$(this).parents("[data-key]");f(u(n))}),t.on("click",'[data-action="delete"]',function(){const n=$(this).attr("data-key"),e=$(this).parents("[data-key]");l.confirm(`[[admin/manage/user-custom-fields:delete-field-confirm-x, ${n}]]`,function(a){a&&e.remove()})}),$("tbody").sortable({handle:'[component="sort/handle"]',axis:"y",zIndex:9999}),$("#new").on("click",()=>f()),$("#save").on("click",()=>{const n=[];$("tbody tr[data-key]").each((e,a)=>{n.push(u($(a)))}),socket.emit("admin.user.saveCustomFields",n,function(e){if(e)return r.error(e);r.success("[[admin/manage/user-custom-fields:custom-fields-saved]]")})})};function u(t){return{key:t.attr("data-key"),name:t.attr("data-name"),icon:t.attr("data-icon"),type:t.attr("data-type"),"select-options":t.attr("data-select-options"),visibility:t.attr("data-visibility"),"min:rep":t.attr("data-min-rep")}}async function f(t=null){const n=await app.parseAndTranslate("admin/partials/manage-custom-user-fields-modal",t),e=l.dialog({message:n,onEscape:!0,title:t?"[[admin/manage/user-custom-fields:edit-field]]":"[[admin/manage/user-custom-fields:create-field]]",buttons:{submit:{label:"[[global:save]]",callback:function(){const a=e.find("form").serializeObject();(a.type==="select"||a.type==="select-multi")&&(a.selectOptionsFormatted=a["select-options"].trim().split(`
`).join(", ")),app.parseAndTranslate("admin/manage/users/custom-fields","fields",{fields:[a]},s=>{if(t){const o=t.key;$(`tbody [data-key="${o}"]`).replaceWith(s)}else $("tbody").append(s)})}}}});e.find("#type-select").on("change",function(){const a=$(this).val();e.find("[data-input-type]").addClass("hidden"),e.find(`[data-input-type-${a}]`).removeClass("hidden")}),e.find("#icon-select").on("click",function(){return h.init($(this).find("i"),function(a,s,o){o.push(s),e.find('[name="icon"]').val(o.join(" "))}),!1})}return m}.apply(y,c),d!==void 0&&(p.exports=d)}}]);
