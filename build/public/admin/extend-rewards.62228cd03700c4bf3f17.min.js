"use strict";(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[91268],{14488:(b,k,l)=>{var f,c;f=[l(29930),l(65285)],c=function(d){const u={};let r,m,h,v;u.init=function(){r=ajaxify.data.rewards,m=ajaxify.data.active,h=ajaxify.data.conditions,v=ajaxify.data.conditionals,$("[data-selected]").each(function(){x($(this))}),$("#active").on("change","[data-selected]",function(){g($(this))}).on("click",".delete",function(){const e=$(this).parents("[data-id]"),t=e.attr("data-id");return socket.emit("admin.rewards.delete",{id:t},function(n){n?d.error(n):d.success("[[admin/extend/rewards:alert.delete-success]]")}),e.remove(),!1}).on("click",".toggle",function(){const e=$(this);return e.parent().find(".toggle").removeClass("hidden"),e.addClass("hidden"),!1}).sortable({handle:'[component="sort/handle"]',axis:"y",zIndex:9999}),$("#new").on("click",y),$("#save").on("click",A),E()};function x(e){switch(e.val(e.attr("data-selected")),e.attr("name")){case"rid":p(e);break}}function g(e){switch(e.attr("data-selected",e.val()),e.attr("name")){case"rid":p(e);break}}function p(e){const t=e.parents("[data-rid]"),n=t.find(".inputs");let s,a="";const o=r.find(i=>i.rid===e.attr("data-selected"));if(o&&(s=o.inputs,t.attr("data-rid",o.rid)),!s)return d.error("[[admin/extend/rewards:alert.no-inputs-found]] "+e.attr("data-selected"));s.forEach(function(i){switch(a+=`<label class="form-label text-nowrap" for="${i.name}">${i.label}<br />`,i.type){case"select":a+=`<select class="form-select form-select-sm" name="${i.name}" >`,i.values.forEach(function(w){a+=`<option value="${w.value}">${w.name}</option>`});break;case"text":a+=`<input type="text" class="form-control form-control-sm" name="${i.name}"  />`;break}a+="</label>"}),n.html(a)}function E(){$("[data-rid]").each(function(e){const t=$(this).find(".inputs"),n=m[e].rewards;for(const[s,a]of Object.entries(n))t.find('[name="'+s+'"]').val(a)})}function y(){const e=$("#active"),t={active:[{disabled:!0,value:"",claimable:1,rid:null,id:null}],conditions:h,conditionals:v,rewards:r};app.parseAndTranslate("admin/extend/rewards","active",t,function(n){e.append(n),n.find("select").val("")})}function A(){const e=[];$("#active li").each(function(){const t={rewards:{}},n=$(this).find("form.main").serializeArray(),s=$(this).find("form.rewards").serializeArray();n.forEach(function(a){t[a.name]=a.value}),s.forEach(function(a){t.rewards[a.name]=a.value}),t.id=$(this).attr("data-id"),t.disabled=$(this).find(".toggle.disable").hasClass("hidden"),e.push(t)}),socket.emit("admin.rewards.save",e,function(t,n){if(t)return d.error(t);const s=document.getElementById("save");s.classList.toggle("saved",!0),setTimeout(()=>{s.classList.toggle("saved",!1)},5e3),$("#active li").each(function(a){$(this).attr("data-id")||$(this).attr("data-id",n[a].id)})})}return u}.apply(k,f),c!==void 0&&(b.exports=c)}}]);
