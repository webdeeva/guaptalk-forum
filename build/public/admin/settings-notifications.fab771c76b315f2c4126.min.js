"use strict";(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[1091,13417,34271,34405,49897,58087,99127],{29821:(x,y,i)=>{var l,m;l=[i(34405)],m=function(p){const g={};return g.init=function(){const A=$('[data-field="welcomeUid"]');p.user(A,function(h,E){setTimeout(function(){A.val(E.item.user.uid)})})},g}.apply(y,l),m!==void 0&&(x.exports=m)},34405:(x,y,i)=>{var l,m;l=[i(49897),i(29930),i(36e3),i(9787),i(35786)],m=function(p,g,{Textcomplete:A},{TextareaEditor:h},{ContenteditableEditor:E}){const f={},D={delay:200,appendTo:null};f.init=u=>{const r={...D,...u},{input:o,onSelect:t}=r;app.loadJQueryUI(function(){o.autocomplete({...r,open:function(){$(this).autocomplete("widget").css("z-index",100005)},select:function(n,e){v(o,t,n,e)}})})},f.user=function(u,r,o){typeof r=="function"&&(o=r,r={}),r=r||{},f.init({input:u,onSelect:o,source:(t,n)=>{r.query=t.term,p.get("/api/users",r,function(e,s){if(e)return g.error(e);if(s&&s.users){const d=s.users.map(function(a){const c=$("<div></div>").html(a.username).text();return a&&{label:c,value:c,user:{uid:a.uid,name:a.username,slug:a.userslug,username:a.username,userslug:a.userslug,displayname:a.displayname,picture:a.picture,banned:a.banned,"icon:text":a["icon:text"],"icon:bgColor":a["icon:bgColor"]}}});n(d)}$(".ui-autocomplete a").attr("data-ajaxify","false")})}})},f.group=function(u,r){f.init({input:u,onSelect:r,source:(o,t)=>{socket.emit("groups.search",{query:o.term},function(n,e){if(n)return g.error(n);if(e&&e.length){const s=e.map(function(d){return d&&{label:d.name,value:d.name,group:d}});t(s)}$(".ui-autocomplete a").attr("data-ajaxify","false")})}})},f.tag=function(u,r){f.init({input:u,onSelect:r,delay:100,source:(o,t)=>{socket.emit("topics.autocompleteTags",{query:o.term,cid:ajaxify.data.cid||0},function(n,e){if(n)return g.error(n);e&&t(e),$(".ui-autocomplete a").attr("data-ajaxify","false")})}})};function v(u,r,o,t){r=r||function(){};const n=jQuery.Event("keypress");n.which=13,n.keyCode=13,setTimeout(function(){u.trigger(n)},100),r(o,t)}return f.setup=function({element:u,strategies:r,options:o}){const t=u.get(0);if(t){var n;if(t.nodeName==="TEXTAREA"||t.nodeName==="INPUT"?n=new h(t):t.nodeName==="DIV"&&t.getAttribute("contenteditable")==="true"&&(n=new E(t)),!n)throw new Error("unknown target element type");t.setAttribute("dir",document.querySelector("html").getAttribute("data-dir"));var e=new A(n,r,{dropdown:o});return e.on("rendered",function(){e.dropdown.items.length&&e.dropdown.items[0].activate()}),e}},f}.apply(y,l),m!==void 0&&(x.exports=m)},49897:(x,y,i)=>{i.r(y),i.d(y,{del:()=>o,get:()=>f,head:()=>D,patch:()=>u,post:()=>v,put:()=>r});var l=i(91749),m=i.n(l),p=i(33530),g=i.n(p);const A=config.relative_path+"/api/v3";async function h(t,n){if(t.url=t.url.startsWith("/api")?config.relative_path+t.url:A+t.url,typeof n=="function"){E(t).then(e=>n(null,e),e=>n(e));return}try{return await E(t)}catch(e){if(e.message==="A valid login session was not found. Please log in and try again."){const{url:s}=await(0,l.fire)("filter:admin.reauth",{url:"login"});return(0,p.confirm)("[[error:api.reauth-required]]",d=>{d&&ajaxify.go(s)})}throw e}}async function E(t){const{url:n}=t;delete t.url,t.data&&!(t.data instanceof FormData)&&(t.data=JSON.stringify(t.data||{}),t.headers["content-type"]="application/json; charset=utf-8"),{options:t}=await(0,l.fire)("filter:api.options",{options:t}),t.data&&(t.body=t.data,delete t.data);const e=await fetch(n,t),{headers:s}=e;if(s.get("x-redirect"))return E({url:s.get("x-redirect"),...t});const d=s.get("content-type"),a=d&&d.startsWith("application/json");let c;if(t.method!=="HEAD"&&(a?c=await e.json():c=await e.text()),!e.ok)throw c?new Error(a?c.status.message:c):new Error(e.statusText);return a&&c&&c.hasOwnProperty("status")&&c.hasOwnProperty("response")?c.response:c}function f(t,n,e){return h({url:t+(n&&Object.keys(n).length?"?"+$.param(n):"")},e)}function D(t,n,e){return h({url:t+(n&&Object.keys(n).length?"?"+$.param(n):""),method:"HEAD"},e)}function v(t,n,e){return h({url:t,method:"POST",data:n,headers:{"x-csrf-token":config.csrf_token}},e)}function u(t,n,e){return h({url:t,method:"PATCH",data:n,headers:{"x-csrf-token":config.csrf_token}},e)}function r(t,n,e){return h({url:t,method:"PUT",data:n,headers:{"x-csrf-token":config.csrf_token}},e)}function o(t,n,e){return h({url:t,method:"DELETE",data:n,headers:{"x-csrf-token":config.csrf_token}},e)}}}]);
