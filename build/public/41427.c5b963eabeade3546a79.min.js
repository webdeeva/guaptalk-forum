"use strict";(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[1091,13201,15794,25432,33069,34271,34590,41427,49897,61861,68326,69749,87212,87549,92717,98813,99127],{10870:(E,C,l)=>{var g,f;g=[l(33530),l(17459),l(68636),l(29930),l(91749)],f=function(m,p,a,u,v){const r={};let w,y;r.show=function(){v.one("action:ajaxify.end",()=>{o(),n(),r.showEmailConfirmWarning()})},r.showEmailConfirmWarning=function(i){if(!config.emailPrompt||!app.user.uid||parseInt(a.getItem("email-confirm-dismiss"),10)===1)return;const t={alert_id:"email_confirm",type:"warning",timeout:0,closefn:()=>{a.setItem("email-confirm-dismiss",1)}};!app.user.email&&!app.user.isEmailConfirmSent?(t.message="[[error:no-email-to-confirm]]",t.clickfn=function(){u.remove("email_confirm"),ajaxify.go("user/"+app.user.userslug+"/edit/email")},u.alert(t)):!app.user["email:confirmed"]&&!app.user.isEmailConfirmSent?(t.message=i||"[[error:email-not-confirmed]]",t.clickfn=function(){u.remove("email_confirm"),ajaxify.go("/me/edit/email")},u.alert(t)):!app.user["email:confirmed"]&&app.user.isEmailConfirmSent&&(t.message="[[error:email-not-confirmed-email-sent]]",u.alert(t))};function n(){!config.cookies.enabled||!navigator.cookieEnabled||app.inAdmin||a.getItem("cookieconsent")==="1"||(config.cookies.message=p.unescape(config.cookies.message),config.cookies.dismiss=p.unescape(config.cookies.dismiss),config.cookies.link=p.unescape(config.cookies.link),config.cookies.link_url=p.unescape(config.cookies.link_url),app.parseAndTranslate("partials/cookie-consent",config.cookies,function(i){$(document.body).append(i),$(document.body).addClass("cookie-consent-open");const t=$(".cookie-consent");t.find("button").on("click",function(){a.setItem("cookieconsent","1"),t.remove(),$(document.body).removeClass("cookie-consent-open")})}))}function o(){const i=utils.params({full:!0});w=i.has("loggedin"),y=i.get("register"),w&&(u.alert({type:"success",title:"[[global:welcome-back]] "+app.user.username+"!",message:"[[global:you-have-successfully-logged-in]]",timeout:5e3}),i.delete("loggedin")),y&&(m.alert({message:utils.escapeHTML(decodeURIComponent(y))}),i.delete("register")),i.has("lang")&&i.get("lang")===config.defaultLang&&(console.info(`The "lang" parameter was passed in to set the language to "${i.get("lang")}", but that is already the forum default language.`),i.delete("lang"));const t=i.toString();ajaxify.updateHistory(ajaxify.currentPage+(t?`?${t}`:"")+document.location.hash,!0)}return r.showInvalidSession=function(){m.alert({title:"[[error:invalid-session]]",message:"[[error:invalid-session-text]]",closeButton:!1,callback:function(){window.location.reload()}})},r.showSessionMismatch=function(){m.alert({title:"[[error:session-mismatch]]",message:"[[error:session-mismatch-text]]",closeButton:!1,callback:function(){window.location.reload()}})},r}.apply(C,g),f!==void 0&&(E.exports=f)},11599:(E,C,l)=>{var g,f;g=[l(52473),l(91749),l(49897)],f=function(m,p,a){const u={};u.prepareDOM=function(){const n=$('[component="chat/dropdown"]');n.on("show.bs.dropdown",o=>{y("loadChatsDropdown",$(o.target).parent().find('[component="chat/list"]'))}),n.each((o,i)=>{const t=$(i).parent().find(".dropdown-menu");t.hasClass("show")&&y("loadChatsDropdown",t.find('[component="chat/list"]'))}),socket.removeListener("event:chats.receive",v),socket.on("event:chats.receive",v),socket.removeListener("event:chats.typing",r),socket.on("event:chats.typing",r),socket.removeListener("event:chats.roomRename",w),socket.on("event:chats.roomRename",w),socket.on("event:unread.updateChatCount",async function(o){if(o){const[d,x]=await app.require(["chat","forum/chats"]);if(d.isFromBlockedUser(o.fromUid)||d.isLookingAtRoom(o.roomId)||app.user.uid===parseInt(o.fromUid,10))return;x.markChatPageElUnread(o),x.updateTeaser(o.roomId,o.teaser)}let{count:i}=await a.get("/chats/unread");const t=m.get("chat/icon");i=Math.max(0,i),t.toggleClass("fa-comment",i>0).toggleClass("fa-comment-o",i<=0);const c=i>99?"99+":i;m.get("chat/icon").toggleClass("unread-count",i>0).attr("data-content",c),m.get("chat/count").toggleClass("hidden",i<=0).text(c),p.fire("action:chat.updateCount",{count:i})})};function v(n){y("onChatMessageReceived",n)}function r(n){y("onUserTyping",n)}function w(n){y("onRoomRename",n)}async function y(n,o){(await app.require("chat"))[n](o)}return u}.apply(C,g),f!==void 0&&(E.exports=f)},14063:(E,C,l)=>{E=l.nmd(E);var g,f;g=[l(17459),l(91749)],f=function(m,p){const a={};let u=!1;a.init=function(){if(a.taskbar=$('[component="taskbar"]'),a.tasklist=a.taskbar.find("ul"),!a.taskbar.length||!a.tasklist.length){u=!0;return}a.taskbar.on("click","li",async function(){const n=$(this),o=n.attr("data-module"),i=n.attr("data-uuid"),t=await app.require(o);return n.hasClass("active")?t.minimize(i):(r(),t.load(i),a.toggleNew(i,!1),a.tasklist.removeClass("active"),n.addClass("active")),!1}),$(window).on("action:app.loggedOut",function(){a.closeAll()})},a.close=async function(n,o){if(u)return;if(a.tasklist.find('[data-module="'+E+'"][data-uuid="'+o+'"]').length){const t=await app.require(n);t&&typeof t.close=="function"&&t.close(o)}},a.closeAll=function(n){if(u)return;let o="[data-uuid]";n&&(o='[data-module="'+n+'"]'+o),a.tasklist.find(o).each(function(i,t){a.close(n||t.getAttribute("data-module"),t.getAttribute("data-uuid"))})},a.discard=function(n,o){if(u)return;a.tasklist.find('[data-module="'+n+'"][data-uuid="'+o+'"]').remove(),v()},a.push=function(n,o,i,t){if(t=t||function(){},u)return t();const c=a.tasklist.find('li[data-uuid="'+o+'"]'),d={module:n,uuid:o,options:i,element:c};p.fire("filter:taskbar.push",d),!c.length&&d.module?w(d,t):t(c)},a.get=function(n){return u?[]:$('[data-module="'+n+'"]').map(function(i,t){return $(t).data()})},a.minimize=function(n,o){if(u)return;a.tasklist.find('[data-module="'+n+'"][data-uuid="'+o+'"]').toggleClass("active",!1)},a.toggleNew=function(n,o,i){if(u)return;a.tasklist.find('[data-uuid="'+n+'"]').toggleClass("new",o),i||p.fire("action:taskbar.toggleNew",n)},a.updateActive=function(n){if(u)return;const o=a.tasklist.find("li");o.removeClass("active"),o.filter('[data-uuid="'+n+'"]').addClass("active"),$("[data-uuid]:not([data-module])").toggleClass("modal-unfocused",!0),$('[data-uuid="'+n+'"]:not([data-module])').toggleClass("modal-unfocused",!1)},a.isActive=function(n){return u?!1:a.tasklist.find('li[data-uuid="'+n+'"]').hasClass("active")};function v(){if(u)return;a.tasklist.find("li").length>0?a.taskbar.attr("data-active","1"):a.taskbar.removeAttr("data-active")}function r(){u||a.tasklist.find(".active").removeClass("active")}function w(n,o){if(u)return o();m.translate(n.options.title,function(i){const t=$("<div></div>").text(i||"NodeBB Task").html(),c=$("<li></li>").addClass(n.options.className).html('<a href="#"'+(n.options.image?` style="background-image: url('`+n.options.image.replace(/&#x2F;/g,"/")+`'); background-size: cover;"`:"")+">"+(n.options.icon?'<i class="fa '+n.options.icon+'"></i> ':"")+'<span aria-label="'+t+'" component="taskbar/title">'+t+"</span></a>").attr({title:t,"data-module":n.module,"data-uuid":n.uuid}).addClass(n.options.state!==void 0?n.options.state:"active");(!n.options.state||n.options.state==="active")&&r(),a.tasklist.append(c),v(),n.element=c,c.data(n),p.fire("action:taskbar.pushed",n),o(c)})}const y=function(n,o,i){switch(o){case"title":n.find('[component="taskbar/title"]').text(i);break;case"icon":n.find("i").attr("class","fa fa-"+i);break;case"image":n.find("a").css("background-image",i?'url("'+i.replace(/&#x2F;/g,"/")+'")':"");break;case"background-color":n.find("a").css("background-color",i);break;case"color":n.find("a").css("color",i);break}};return a.update=function(n,o,i){if(u)return;const t=a.tasklist.find('[data-module="'+n+'"][data-uuid="'+o+'"]');if(!t.length)return;const c=t.data();Object.keys(i).forEach(function(d){c[d]=i[d],y(t,d,i[d])}),t.data(c)},a}.apply(C,g),f!==void 0&&(E.exports=f)},19046:(E,C,l)=>{var g,f;g=[l(91749)],f=function(m){const p={},a={ignoring:1,notwatching:2,watching:3};p.initUnreadTopics=function(){const r=app.user.unreadData;function w(o){if(o&&o.posts&&o.posts.length&&r){const i=o.posts[0];if(parseInt(i.uid,10)===parseInt(app.user.uid,10)||!i.topic.isFollowing&&i.categoryWatchState!==a.watching)return;const t=i.topic.tid;(!r[""][t]||!r.new[t]||!r.watched[t]||!r.unreplied[t])&&n(t),r[""][t]||(y(""),r[""][t]=!0),i.isMain&&parseInt(i.uid,10)!==parseInt(app.user.uid,10)&&!r.new[t]&&(y("new"),r.new[t]=!0),parseInt(i.topic.postcount,10)<=1&&!r.unreplied[t]&&(y("unreplied"),r.unreplied[t]=!0),i.topic.isFollowing&&!r.watched[t]&&(y("watched"),r.watched[t]=!0)}}function y(o){const i="/unread"+(o?"?filter="+o:""),t=1+parseInt($('a[href="'+config.relative_path+i+'"].navigation-link i').attr("data-content"),10);v(i,t)}function n(o){$('[data-tid="'+o+'"]').addClass("unread")}$(window).on("action:ajaxify.end",function(){ajaxify.data.template.topic&&["","new","watched","unreplied"].forEach(function(o){delete r[o][ajaxify.data.tid]})}),socket.removeListener("event:new_post",w),socket.on("event:new_post",w),socket.removeListener("event:unread.updateCount",u),socket.on("event:unread.updateCount",u)};function u(r){v("/unread",r.unreadTopicCount),v("/unread?filter=new",r.unreadNewTopicCount),v("/unread?filter=watched",r.unreadWatchedTopicCount),v("/unread?filter=unreplied",r.unreadUnrepliedTopicCount)}function v(r,w){if(!utils.isNumber(w))return;w=Math.max(0,w);const y=w>99?"99+":w,n=$('a[href="'+config.relative_path+r+'"].navigation-link');n.find("i").toggleClass("unread-count",w>0).attr("data-content",y),n.find('[component="navigation/count"]').toggleClass("hidden",w<=0).text(w),n.length&&($('#mobile-menu [data-unread-url="'+r+'"]').attr("data-content",y),$('[component="unread/count"][data-unread-url="'+r+'"]').toggleClass("hidden",w<=0).text(y)),m.fire("action:unread.updateCount",{url:r,count:w})}return p.updateUnreadTopicCount=v,p}.apply(C,g),f!==void 0&&(E.exports=f)},25967:(E,C,l)=>{var g,f;g=[l(33530)],f=function(m){const p={};return p.init=function(){$("body").on("click",'[component="pagination/select-page"]',function(){return m.prompt("[[global:enter-page-number]]",function(a){p.loadPage(a)}),!1})},p.loadPage=function(a,u){if(u=u||function(){},a=parseInt(a,10),!utils.isNumber(a)||a<1||a>ajaxify.data.pagination.pageCount)return;const v=utils.params();v.page=a;const r=window.location.pathname+"?"+$.param(v);ajaxify.go(r,u)},p.nextPage=function(a){p.loadPage(ajaxify.data.pagination.currentPage+1,a)},p.previousPage=function(a){p.loadPage(ajaxify.data.pagination.currentPage-1,a)},p}.apply(C,g),f!==void 0&&(E.exports=f)},29869:E=>{E.exports=function(C,l,g){l.setGlobal("true",!0),l.setGlobal("false",!1);const f=24*60*60*1e3,m={displayMenuItem:a,buildMetaTag:u,buildLinkTag:v,stringify:r,escape:w,stripTags:y,buildCategoryIcon:n,buildCategoryLabel:o,generateCategoryBackground:i,generateChildrenCategories:t,generateTopicClass:c,membershipBtn:d,spawnPrivilegeStates:x,localeToHTML:I,renderTopicImage:S,renderDigestAvatar:k,userAgentIcons:T,buildAvatar:F,increment:b,generateWroteReplied:A,generateRepliedTo:M,generateWrote:O,encodeURIComponent:W,isoTimeToLocaleString:j,shouldHideReplyContainer:K,humanReadableNumber:q,formattedNumber:H,txEscape:z,generatePlaceholderWave:Y,register:G,__escape:p};function p(e){return e}function a(e,s){const h=e.navigation[s];return!(!h||h.route.match("/users")&&e.user&&!e.user.privileges["view:users"]||h.route.match("/tags")&&e.user&&!e.user.privileges["view:tags"]||h.route.match("/groups")&&e.user&&!e.user.privileges["view:groups"])}function u(e){const s=e.name?'name="'+e.name+'" ':"",h=e.property?'property="'+e.property+'" ':"",_=e.content?'content="'+e.content.replace(/\n/g," ")+'" ':"";return"<meta "+s+h+_+`/>
	`}function v(e){const s=["link","rel","as","type","href","sizes","title","crossorigin"],[h,_,P,D,N,B,U,L]=s.map(R=>e[R]?`${R}="${e[R]}" `:"");return"<link "+h+_+P+D+B+U+N+L+`/>
	`}function r(e){return JSON.stringify(e).replace(/&/gm,"&amp;").replace(/</gm,"&lt;").replace(/>/gm,"&gt;").replace(/"/g,"&quot;")}function w(e){return C.escapeHTML(e)}function y(e){return C.stripHTMLTags(e)}function n(e,s,h){return e?`<span class="icon d-inline-flex justify-content-center align-items-center align-middle ${h}" style="${i(e)} width:${s}; height: ${s}; font-size: ${parseInt(s,10)/2}px;">${e.icon?`<i class="fa fa-fw ${e.icon}"></i>`:""}</span>`:""}function o(e,s="a",h=""){if(!e)return"";const _=s==="a"?`href="${g}/category/${e.slug}"`:"";return`<${s} ${_} class="badge px-1 text-truncate text-decoration-none ${h}" style="color: ${e.color};background-color: ${e.bgColor};border-color: ${e.bgColor}!important; max-width: 70vw;">
			${e.icon&&e.icon!=="fa-nbb-none"?`<i class="fa fa-fw ${e.icon}"></i>`:""}
			${e.name}
		</${s}>`}function i(e){if(!e)return"";const s=[];return e.bgColor&&(s.push("background-color: "+e.bgColor),s.push(`border-color: ${e.bgColor}!important`)),e.color&&s.push("color: "+e.color),e.backgroundImage&&(s.push("background-image: url("+e.backgroundImage+")"),e.imageClass&&s.push("background-size: "+e.imageClass)),s.join("; ")+";"}function t(e){let s="";return!e||!e.children||!e.children.length||(e.children.forEach(function(h){if(h&&!h.isSection){const _=h.link?h.link:g+"/category/"+h.slug;s+='<span class="category-children-item float-start"><div role="presentation" class="icon float-start" style="'+i(h)+'"><i class="fa fa-fw '+h.icon+'"></i></div><a href="'+_+'"><small>'+h.name+"</small></a></span>"}}),s=s&&'<span class="category-children">'+s+"</span>"),s}function c(e){return["locked","pinned","deleted","unread","scheduled"].filter(h=>!!e[h]).join(" ")}function d(e,s=""){return e.isMember&&e.name!=="administrators"?`<button class="btn btn-danger ${s}" data-action="leave" data-group="${e.displayName}" ${e.disableLeave?" disabled":""}><i class="fa fa-times"></i> [[groups:membership.leave-group]]</button>`:e.isPending&&e.name!=="administrators"?`<button class="btn btn-warning disabled ${s}"><i class="fa fa-clock-o"></i> [[groups:membership.invitation-pending]]</button>`:e.isInvited?`<button class="btn btn-warning" data-action="rejectInvite" data-group="${e.displayName}">[[groups:membership.reject]]</button><button class="btn btn-success" data-action="acceptInvite" data-group="${e.name}"><i class="fa fa-plus"></i> [[groups:membership.accept-invitation]]</button>`:!e.disableJoinRequests&&e.name!=="administrators"?`<button class="btn btn-success ${s}" data-action="join" data-group="${e.displayName}"><i class="fa fa-plus"></i> [[groups:membership.join-group]]</button>`:""}function x(e,s,h,_){const P=[];for(const[D,N]of Object.entries(h))P.push({name:D,state:N,type:_[D]});return P.map(function(D){const N=["groups:moderate","groups:posts:upvote","groups:posts:downvote","groups:local:login","groups:group:create"],B=["groups:find","groups:read","groups:topics:read","groups:view:users","groups:view:tags","groups:view:groups"],U=["groups:moderate"];let L=["groups:view:users","groups:find","groups:read","groups:topics:read","groups:topics:create","groups:topics:reply","groups:topics:tag","groups:posts:edit","groups:posts:history","groups:posts:delete","groups:posts:upvote","groups:posts:downvote","groups:topics:delete"];e===-1&&(L=L.slice(3));const R=s==="guests"&&(N.includes(D.name)||D.name.startsWith("groups:admin:"))||s==="spiders"&&!B.includes(D.name)||s==="fediverse"&&!L.includes(D.name)||s==="Global Moderators"&&U.includes(D.name);return`
				<td data-privilege="${D.name}" data-value="${D.state}" data-type="${D.type}">
					<div class="form-check text-center">
						<input class="form-check-input float-none${R?' d-none"':""}" autocomplete="off" type="checkbox"${D.state?" checked":""}${R?' disabled="disabled" aria-diabled="true"':""} />
					</div>
				</td>
			`}).join("")}function I(e,s){return e=e||s||"en-GB",e.replace("_","-")}function S(e){return e.thumb?'<img src="'+e.thumb+'" class="img-circle user-img" title="'+e.user.displayname+'" />':'<img component="user/picture" data-uid="'+e.user.uid+'" src="'+e.user.picture+'" class="user-img" title="'+e.user.displayname+'" />'}function k(e){return e.teaser?e.teaser.user.picture?'<img style="vertical-align: middle; width: 32px; height: 32px; border-radius: 50%;" src="'+e.teaser.user.picture+'" title="'+e.teaser.user.username+'" />':'<div style="vertical-align: middle; width: 32px; height: 32px; line-height: 32px; font-size: 16px; background-color: '+e.teaser.user["icon:bgColor"]+'; color: white; text-align: center; display: inline-block; border-radius: 50%;">'+e.teaser.user["icon:text"]+"</div>":e.user.picture?'<img style="vertical-align: middle; width: 32px; height: 32px; border-radius: 50%;" src="'+e.user.picture+'" title="'+e.user.username+'" />':'<div style="vertical-align: middle; width: 32px; height: 32px; line-height: 32px; font-size: 16px; background-color: '+e.user["icon:bgColor"]+'; color: white; text-align: center; display: inline-block; border-radius: 50%;">'+e.user["icon:text"]+"</div>"}function T(e){let s="";switch(e.platform){case"Linux":s+='<i class="fa fa-fw fa-linux"></i>';break;case"Microsoft Windows":s+='<i class="fa fa-fw fa-windows"></i>';break;case"Apple Mac":s+='<i class="fa fa-fw fa-apple"></i>';break;case"Android":s+='<i class="fa fa-fw fa-android"></i>';break;case"iPad":s+='<i class="fa fa-fw fa-tablet"></i>';break;case"iPod":case"iPhone":s+='<i class="fa fa-fw fa-mobile"></i>';break;default:s+='<i class="fa fa-fw fa-question-circle"></i>';break}switch(e.browser){case"Chrome":s+='<i class="fa fa-fw fa-chrome"></i>';break;case"Firefox":s+='<i class="fa fa-fw fa-firefox"></i>';break;case"Safari":s+='<i class="fa fa-fw fa-safari"></i>';break;case"IE":s+='<i class="fa fa-fw fa-internet-explorer"></i>';break;case"Edge":s+='<i class="fa fa-fw fa-edge"></i>';break;default:s+='<i class="fa fa-fw fa-question-circle"></i>';break}return s}function F(e,s,h,_,P){e||(e=this),_=_||"";const D=new Map([["title",e.displayname],["data-uid",e.uid],["class",`avatar ${_}${h?" avatar-rounded":""}`]]),N=[`--avatar-size: ${s};`],B=L=>Array.from(L).reduce((R,[J,Q])=>(R+=` ${J}="${Q}"`,R),"");let U="";return e.picture&&(U+=`<img${B(D)} alt="${e.displayname}" loading="lazy" component="${P||"avatar/picture"}" src="${e.picture}" style="${N.join(" ")}" onError="this.remove()" itemprop="image" />`),U+=`<span${B(D)} component="${P||"avatar/icon"}" style="${N.join(" ")} background-color: ${e["icon:bgColor"]}">${e["icon:text"]}</span>`,U}function b(e,s){return String(e+parseInt(s,10))}function A(e,s){return e.toPid?M(e,s):O(e,s)}function M(e,s){const h=e.parent&&e.parent.displayname?e.parent.displayname:"[[global:guest]]";return`[[topic:replied-to-user-${e.timestamp<Date.now()-s*f?"on":"ago"}, ${e.toPid}, ${g}/post/${encodeURIComponent(e.toPid)}, ${h}, ${g}/post/${encodeURIComponent(e.pid)}, ${e.timestampISO}]]`}function O(e,s){return`[[topic:wrote-${e.timestamp<Date.now()-s*f?"on":"ago"}, ${g}/post/${encodeURIComponent(e.pid)}, ${e.timestampISO}]]`}function W(e){return encodeURIComponent(e)}function j(e,s="en-GB"){return new Date(e).toLocaleString([s],{dateStyle:"short",timeStyle:"short"}).replace(/,/g,"&#44;")}function K(e){return!!(e.replies.count<=0||e.replies.hasSingleImmediateReply)}function q(e,s=1){return C.makeNumberHumanReadable(e,s)}function H(e){return C.addCommas(e)}function z(e){return String(e).replace(/%/g,"&#37;").replace(/,/g,"&#44;")}function Y(e){return e.map(h=>h==="divider"?'<li class="dropdown-divider"></li>':`
			<li class="dropdown-item placeholder-wave">
				<div class="placeholder" style="width: 20px;"></div>
				<div class="placeholder col-${h}"></div>
			</li>`).join("")}function G(){Object.keys(m).forEach(function(e){l.registerHelper(e,m[e])})}return m}},30076:(E,C,l)=>{var g,f;const m=l(29869);g=[l(77918),l(81335)],f=function(p,a){return m(p,a,config.relative_path)}.apply(C,g),f!==void 0&&(E.exports=f)},49897:(E,C,l)=>{l.r(C),l.d(C,{del:()=>i,get:()=>r,head:()=>w,patch:()=>n,post:()=>y,put:()=>o});var g=l(91749),f=l.n(g),m=l(33530),p=l.n(m);const a=config.relative_path+"/api/v3";async function u(t,c){if(t.url=t.url.startsWith("/api")?config.relative_path+t.url:a+t.url,typeof c=="function"){v(t).then(d=>c(null,d),d=>c(d));return}try{return await v(t)}catch(d){if(d.message==="A valid login session was not found. Please log in and try again."){const{url:x}=await(0,g.fire)("filter:admin.reauth",{url:"login"});return(0,m.confirm)("[[error:api.reauth-required]]",I=>{I&&ajaxify.go(x)})}throw d}}async function v(t){const{url:c}=t;delete t.url,t.data&&!(t.data instanceof FormData)&&(t.data=JSON.stringify(t.data||{}),t.headers["content-type"]="application/json; charset=utf-8"),{options:t}=await(0,g.fire)("filter:api.options",{options:t}),t.data&&(t.body=t.data,delete t.data);const d=await fetch(c,t),{headers:x}=d;if(x.get("x-redirect"))return v({url:x.get("x-redirect"),...t});const I=x.get("content-type"),S=I&&I.startsWith("application/json");let k;if(t.method!=="HEAD"&&(S?k=await d.json():k=await d.text()),!d.ok)throw k?new Error(S?k.status.message:k):new Error(d.statusText);return S&&k&&k.hasOwnProperty("status")&&k.hasOwnProperty("response")?k.response:k}function r(t,c,d){return u({url:t+(c&&Object.keys(c).length?"?"+$.param(c):"")},d)}function w(t,c,d){return u({url:t+(c&&Object.keys(c).length?"?"+$.param(c):""),method:"HEAD"},d)}function y(t,c,d){return u({url:t,method:"POST",data:c,headers:{"x-csrf-token":config.csrf_token}},d)}function n(t,c,d){return u({url:t,method:"PATCH",data:c,headers:{"x-csrf-token":config.csrf_token}},d)}function o(t,c,d){return u({url:t,method:"PUT",data:c,headers:{"x-csrf-token":config.csrf_token}},d)}function i(t,c,d){return u({url:t,method:"DELETE",data:c,headers:{"x-csrf-token":config.csrf_token}},d)}},68636:(E,C,l)=>{var g;g=function(){function f(){this._store={},this._keys=[]}f.prototype.isMock=!0,f.prototype.setItem=function(a,u){a=String(a),this._keys.indexOf(a)===-1&&this._keys.push(a),this._store[a]=u},f.prototype.getItem=function(a){return a=String(a),this._keys.indexOf(a)===-1?null:this._store[a]},f.prototype.removeItem=function(a){a=String(a),this._keys=this._keys.filter(function(u){return u!==a}),this._store[a]=null},f.prototype.clear=function(){this._keys=[],this._store={}},f.prototype.key=function(a){return a=parseInt(a,10)||0,this._keys[a]},Object.defineProperty&&Object.defineProperty(f.prototype,"length",{get:function(){return this._keys.length}});let m;const p=Date.now().toString();try{if(m=window.localStorage,m.setItem(p,p),m.getItem(p)!==p)throw Error("localStorage behaved unexpectedly");return m.removeItem(p),m}catch(a){console.warn(a),console.warn("localStorage failed, falling back on sessionStorage");try{if(m=window.sessionStorage,m.setItem(p,p),m.getItem(p)!==p)throw Error("sessionStorage behaved unexpectedly");return m.removeItem(p),m}catch(u){return console.warn(u),console.warn("sessionStorage failed, falling back on memory storage"),new f}}}.call(C,l,C,E),g!==void 0&&(E.exports=g)},69749:(E,C,l)=>{var g,f;g=[l(17459),l(68636),l(91749),l(29930),l(89336)],f=function(m,p,a,u,v){const r={current:{}};r.init=function(n){if(!config.searchEnabled)return;n=n||{in:config.searchDefaultInQuick||"titles"},$('[component="search/form"]').each((i,t)=>{w($(t),n)})};function w(n,o){const i=n.find('[component="search/button"]'),t=n.find('[component="search/fields"]'),c=t.find('input[name="query"]'),d=t.find("#quick-search-container"),x=t.hasClass("hidden"),I=/^(@|acct:)?[\w-]+@.+$/;x&&t.off("focusout").on("focusout",function(){setTimeout(function(){t.find(":focus").length||(t.addClass("hidden"),i.removeClass("hidden"))},200)}),c.off("focus");const S={inputEl:c,resultEl:d};r.enableQuickSearch({searchOptions:o,searchElements:S}),i.off("click").on("click",function(k){return!config.loggedIn&&!app.user.privileges["search:content"]?(u.alert({message:"[[error:search-requires-login]]",timeout:3e3}),ajaxify.go("login"),!1):(k.stopPropagation(),r.showAndFocusInput(n),!1)}),n.off("submit").on("submit",function(){const k=$(this).find('input[name="query"]'),T=r.getSearchPreferences();return T.term=k.val(),T.in=o.in,I.test(T.term)&&(T.in="users"),a.fire("action:search.submit",{searchOptions:T,searchElements:S}),r.query(T,function(){k.val(""),c.trigger("blur")}),!1})}r.enableQuickSearch=function(n){if(!config.searchEnabled||!app.user.privileges["search:content"])return;const o=Object.assign({in:config.searchDefaultInQuick||"titles"},n.searchOptions),i=n.searchElements.resultEl,t=n.searchElements.inputEl;let c=t.val();const d=i.find(".filter-category");function x(){ajaxify.data.template.category&&ajaxify.data.cid&&m.translate("[[search:search-in-category, "+ajaxify.data.name+"]]",function(b){const A=$("<div></div>").html(b).text();d.find(".name").text(A)}),d.toggleClass("hidden",!(ajaxify.data.template.category&&ajaxify.data.cid))}function I(){n.searchOptions=Object.assign({},o),n.searchOptions.term=t.val(),x(),ajaxify.data.template.category&&ajaxify.data.cid&&d.find('input[type="checkbox"]').is(":checked")&&(n.searchOptions.categories=[ajaxify.data.cid],n.searchOptions.searchChildren=!0),n.hideDuringSearch||(i.removeClass("hidden").find(".quick-search-results-container").html(""),i.find(".loading-indicator").removeClass("hidden")),a.fire("action:search.quick.start",n),n.searchOptions.searchOnly=1,r.api(n.searchOptions,function(b){if(i.find(".loading-indicator").addClass("hidden"),n.searchOptions.in==="categories"){if(!b.categories||n.hideOnNoMatches&&!b.categories.length)return i.addClass("hidden").find(".quick-search-results-container").html("");b.dropdown={maxWidth:"400px",maxHeight:"500px",...n.dropdown},app.parseAndTranslate("partials/quick-category-search-results",b,A=>{A.length&&A.find(".timeago").timeago(),i.toggleClass("hidden",!A.length||!t.is(":focus")).find(".quick-search-results-container").html(A.length?A:""),a.fire("action:search.quick.complete",{data:b,options:n})})}else{if(!b.posts||n.hideOnNoMatches&&!b.posts.length)return i.addClass("hidden").find(".quick-search-results-container").html("");b.posts.forEach(function(A){const M=$("<div>"+A.content+"</div>").text(),O=t.val().toLowerCase().replace(/^in:topic-\d+/,""),W=Math.max(0,M.toLowerCase().indexOf(O)-40);A.snippet=utils.escapeHTML((W>0?"...":"")+M.slice(W,W+80)+(M.length-W>80?"...":""))}),b.dropdown={maxWidth:"400px",maxHeight:"500px",...n.dropdown},app.parseAndTranslate("partials/quick-search-results",b,function(A){A.length&&A.find(".timeago").timeago(),i.toggleClass("hidden",!A.length||!t.is(":focus")).find(".quick-search-results-container").html(A.length?A:"");const M=i.find(".quick-search-results .quick-search-title, .quick-search-results .snippet");r.highlightMatches(n.searchOptions.term,M),a.fire("action:search.quick.complete",{data:b,options:n})})}})}i.find('.filter-category input[type="checkbox"]').on("change",function(){t.focus(),I()}),t.off("keyup").on("keyup",utils.debounce(function(){if(t.val().length<3){i.addClass("hidden"),c=t.val();return}if(t.val()!==c){if(c=t.val(),!t.is(":focus"))return i.addClass("hidden");I()}},500)),i.on("mousedown",".quick-search-results > *",function(){$(window).one("mouseup",function(){i.addClass("hidden")})});const S=t.parent(),k=i.parent();S.on("focusout",T),k.on("focusout",T);function T(){setTimeout(function(){!S.find(":focus").length&&!k.find(":focus").length&&!i.hasClass("hidden")&&i.addClass("hidden")},200)}let F=!1;a.on("action:ajaxify.end",function(){ajaxify.isCold()||(F=!0),i.addClass("hidden")}),t.on("focus",function(){const b=t.val();c=b,b&&i.find("#quick-search-results").children().length&&(x(),F?(I(),F=!1):i.removeClass("hidden"),t[0].setSelectionRange(b.startsWith("in:topic")?b.indexOf(" ")+1:0,b.length))}),t.off("refresh").on("refresh",function(){I()})},r.showAndFocusInput=function(n){const o=n.parents(".dropdown-menu");if(o.length){const i=o.siblings("[data-bs-toggle]"),t=v.Dropdown.getOrCreateInstance(i[0]);t&&t.show()}else n.find('[component="search/fields"]').removeClass("hidden"),n.find('[component="search/button"]').addClass("hidden"),n.find('[component="search/fields"] input[name="query"]').trigger("focus")},r.query=function(n,o){o=o||function(){},ajaxify.go("search?"+y(n),o)},r.api=function(n,o){const i=config.relative_path+"/api/search?"+y(n);n.hasOwnProperty("searchOnly")&&delete n.searchOnly;const t=config.relative_path+"/search?"+y(n);$.get(i,function(c){c.url=t,o(c)})};function y(n){const o=n.in||"titles",i=n.term.replace(/^[ ?#]*/,""),t={...n,term:i,in:o};return a.fire("action:search.createQueryString",{query:t,data:n}),$.param(t)}return r.getSearchPreferences=function(){try{return JSON.parse(p.getItem("search-preferences")||"{}")}catch(n){return console.error(n),{}}},r.highlightMatches=function(n,o){if(!n||!o.length)return;n=utils.escapeHTML(n.replace(/^"/,"").replace(/"$/,"").trim());const i=n.split(" ").filter(c=>c.length>1).map(function(c){return utils.escapeRegexChars(c)}).join("|"),t=new RegExp("("+i+")","gi");o.each(function(){const c=$(this),d=[];c.find("*").each(function(){$(this).after("<!-- "+d.length+" -->"),d.push($("<div></div>").append($(this)))}),c.html(c.html().replace(t,function(x,I){return'<strong class="search-match fw-bold text-decoration-underline">'+I+"</strong>"})),d.forEach(function(x,I){c.html(c.html().replace("<!-- "+I+" -->",function(){return x.html()}))})}),$(".search-results .content").find("img:not(.not-responsive)").addClass("img-fluid")},r}.apply(C,g),f!==void 0&&(E.exports=f)},71949:(E,C,l)=>{var g;g=function(){const f={};f.prepareDOM=function(){const a=$('[component="notifications"] [data-bs-toggle="dropdown"]');a.on("show.bs.dropdown",async u=>{const v=await app.require("notifications"),r=$(u.target);v.loadNotifications(r,r.parent().find('[component="notifications/list"]'))}),a.each((u,v)=>{const r=$(v),w=r.parent().find(".dropdown-menu");w.hasClass("show")&&app.require("notifications").then(y=>{y.loadNotifications(r,w.find('[component="notifications/list"]'))})}),socket.removeListener("event:new_notification",m),socket.on("event:new_notification",m),socket.removeListener("event:notifications.updateCount",p),socket.on("event:notifications.updateCount",p)};async function m(a){(await app.require("notifications")).onNewNotification(a)}async function p(a){(await app.require("notifications")).updateNotifCount(a)}return f}.call(C,l,C,E),g!==void 0&&(E.exports=g)},86174:(E,C,l)=>{var g,f;g=[l(19046),l(71949),l(11599),l(29930)],f=function(m,p,a,u){const v={};v.prepareDOM=function(){app.user.uid>0&&m.initUnreadTopics(),p.prepareDOM(),a.prepareDOM(),r(),w(),y()};function r(){$('[component="header/usercontrol"] [data-status]').off("click").on("click",function(n){const o=$(this).attr("data-status");socket.emit("user.setStatus",o,function(i){if(i)return u.error(i);$('[data-uid="'+app.user.uid+'"] [component="user/status"], [component="header/profilelink"] [component="user/status"]').removeClass("away online dnd offline").addClass(o),$('[component="header/usercontrol"] [data-status]').each(function(){$(this).toggleClass("selected",$(this).attr("data-status")===o)}),app.user.status=o}),n.preventDefault()})}function w(){const n=utils.findBootstrapEnvironment();if(n==="xs"||n==="sm"||utils.isTouchDevice())return;const o=$("#header-menu .nav-item[title]");o.tooltip({trigger:"manual",animation:!1,placement:"bottom"}),o.on("mouseenter",function(i){const t=$(i.target);t.hasClass("dropdown-menu")||!!t.parents(".dropdown-menu").length||$(this).tooltip("show")}),o.on("click mouseleave",function(){$(this).tooltip("hide")})}function y(){$("body").on("click",'[component="user/logout"]',function(){return l.e(20739).then(function(){var n=[l(75427)];(function(o){o()}).apply(null,n)}).catch(l.oe),!1})}return v}.apply(C,g),f!==void 0&&(E.exports=f)}}]);
