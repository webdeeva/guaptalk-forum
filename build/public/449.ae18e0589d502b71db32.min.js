(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[449,6232,18732,33069],{449:(p,h,f)=>{p.exports=f(91943)},14063:(p,h,f)=>{"use strict";p=f.nmd(p);var m,E;m=[f(17459),f(91749)],E=function(F,a){const t={};let n=!1;t.init=function(){if(t.taskbar=$('[component="taskbar"]'),t.tasklist=t.taskbar.find("ul"),!t.taskbar.length||!t.tasklist.length){n=!0;return}t.taskbar.on("click","li",async function(){const i=$(this),e=i.attr("data-module"),o=i.attr("data-uuid"),r=await app.require(e);return i.hasClass("active")?r.minimize(o):(c(),r.load(o),t.toggleNew(o,!1),t.tasklist.removeClass("active"),i.addClass("active")),!1}),$(window).on("action:app.loggedOut",function(){t.closeAll()})},t.close=async function(i,e){if(n)return;if(t.tasklist.find('[data-module="'+p+'"][data-uuid="'+e+'"]').length){const r=await app.require(i);r&&typeof r.close=="function"&&r.close(e)}},t.closeAll=function(i){if(n)return;let e="[data-uuid]";i&&(e='[data-module="'+i+'"]'+e),t.tasklist.find(e).each(function(o,r){t.close(i||r.getAttribute("data-module"),r.getAttribute("data-uuid"))})},t.discard=function(i,e){if(n)return;t.tasklist.find('[data-module="'+i+'"][data-uuid="'+e+'"]').remove(),l()},t.push=function(i,e,o,r){if(r=r||function(){},n)return r();const s=t.tasklist.find('li[data-uuid="'+e+'"]'),u={module:i,uuid:e,options:o,element:s};a.fire("filter:taskbar.push",u),!s.length&&u.module?g(u,r):r(s)},t.get=function(i){return n?[]:$('[data-module="'+i+'"]').map(function(o,r){return $(r).data()})},t.minimize=function(i,e){if(n)return;t.tasklist.find('[data-module="'+i+'"][data-uuid="'+e+'"]').toggleClass("active",!1)},t.toggleNew=function(i,e,o){if(n)return;t.tasklist.find('[data-uuid="'+i+'"]').toggleClass("new",e),o||a.fire("action:taskbar.toggleNew",i)},t.updateActive=function(i){if(n)return;const e=t.tasklist.find("li");e.removeClass("active"),e.filter('[data-uuid="'+i+'"]').addClass("active"),$("[data-uuid]:not([data-module])").toggleClass("modal-unfocused",!0),$('[data-uuid="'+i+'"]:not([data-module])').toggleClass("modal-unfocused",!1)},t.isActive=function(i){return n?!1:t.tasklist.find('li[data-uuid="'+i+'"]').hasClass("active")};function l(){if(n)return;t.tasklist.find("li").length>0?t.taskbar.attr("data-active","1"):t.taskbar.removeAttr("data-active")}function c(){n||t.tasklist.find(".active").removeClass("active")}function g(i,e){if(n)return e();F.translate(i.options.title,function(o){const r=$("<div></div>").text(o||"NodeBB Task").html(),s=$("<li></li>").addClass(i.options.className).html('<a href="#"'+(i.options.image?` style="background-image: url('`+i.options.image.replace(/&#x2F;/g,"/")+`'); background-size: cover;"`:"")+">"+(i.options.icon?'<i class="fa '+i.options.icon+'"></i> ':"")+'<span aria-label="'+r+'" component="taskbar/title">'+r+"</span></a>").attr({title:r,"data-module":i.module,"data-uuid":i.uuid}).addClass(i.options.state!==void 0?i.options.state:"active");(!i.options.state||i.options.state==="active")&&c(),t.tasklist.append(s),l(),i.element=s,s.data(i),a.fire("action:taskbar.pushed",i),e(s)})}const k=function(i,e,o){switch(e){case"title":i.find('[component="taskbar/title"]').text(o);break;case"icon":i.find("i").attr("class","fa fa-"+o);break;case"image":i.find("a").css("background-image",o?'url("'+o.replace(/&#x2F;/g,"/")+'")':"");break;case"background-color":i.find("a").css("background-color",o);break;case"color":i.find("a").css("color",o);break}};return t.update=function(i,e,o){if(n)return;const r=t.tasklist.find('[data-module="'+i+'"][data-uuid="'+e+'"]');if(!r.length)return;const s=r.data();Object.keys(o).forEach(function(u){s[u]=o[u],k(r,u,o[u])}),r.data(s)},t}.apply(h,m),E!==void 0&&(p.exports=E)},51916:p=>{/*!
* screenfull
* v5.2.0 - 2021-11-03
* (c) Sindre Sorhus; MIT License
*/(function(){"use strict";var h=typeof window<"u"&&typeof window.document<"u"?window.document:{},f=p.exports,m=function(){for(var a,t=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],n=0,l=t.length,c={};n<l;n++)if(a=t[n],a&&a[1]in h){for(n=0;n<a.length;n++)c[t[0][n]]=a[n];return c}return!1}(),E={change:m.fullscreenchange,error:m.fullscreenerror},F={request:function(a,t){return new Promise(function(n,l){var c=function(){this.off("change",c),n()}.bind(this);this.on("change",c),a=a||h.documentElement;var g=a[m.requestFullscreen](t);g instanceof Promise&&g.then(c).catch(l)}.bind(this))},exit:function(){return new Promise(function(a,t){if(!this.isFullscreen){a();return}var n=function(){this.off("change",n),a()}.bind(this);this.on("change",n);var l=h[m.exitFullscreen]();l instanceof Promise&&l.then(n).catch(t)}.bind(this))},toggle:function(a,t){return this.isFullscreen?this.exit():this.request(a,t)},onchange:function(a){this.on("change",a)},onerror:function(a){this.on("error",a)},on:function(a,t){var n=E[a];n&&h.addEventListener(n,t,!1)},off:function(a,t){var n=E[a];n&&h.removeEventListener(n,t,!1)},raw:m};if(!m){f?p.exports={isEnabled:!1}:window.screenfull={isEnabled:!1};return}Object.defineProperties(F,{isFullscreen:{get:function(){return!!h[m.fullscreenElement]}},element:{enumerable:!0,get:function(){return h[m.fullscreenElement]}},isEnabled:{enumerable:!0,get:function(){return!!h[m.fullscreenEnabled]}}}),f?p.exports=F:window.screenfull=F})()},57904:(p,h,f)=>{"use strict";var m,E;m=[f(14063)],E=function(F){var a={},t=0,n=.3,l=.05,c=768,g=$("body"),k=$(window),i=$('[component="navbar"]');const e=document.getElementById("content");var o=i[0];function r(){return localStorage.getItem("composer:resizeRatio")||.5}function s(d){localStorage.setItem("composer:resizeRatio",Math.min(d,1))}function u(){var d;o?d=o.getBoundingClientRect():d={bottom:0};var b=Math.max(d.bottom,0),w={top:0,left:0,right:window.innerWidth,bottom:window.innerHeight};return w.width=w.right,w.height=w.bottom,w.boundedTop=b,w.boundedHeight=w.bottom-b,w}function v(d,b){var w=u(),z=d[0],D=window.getComputedStyle(z),P=parseInt(D.getPropertyValue("min-height"),10),M=Math.max(P/window.innerHeight,n);if(w.width>=c){const I=(w.height-w.boundedHeight)/w.height;b=Math.min(Math.max(b,M+I),1);var y=b*w.boundedHeight/w.height;z.style.top=((1-y)*100).toString()+"%";var S=z.getBoundingClientRect();e.style.paddingBottom=(S.bottom-S.top).toString()+"px"}else z.style.top=0,e.style.paddingBottom=0;d.ratio=b,F.updateActive(d.attr("data-uuid"))}var R=v,T=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame;return T&&(R=function(d,b){T(function(){v(d,b),setTimeout(function(){k.trigger("action:composer.resize"),d.trigger("action:composer.resize")},0)})}),a.reposition=function(d){var b=r();b>=1-l&&(b=1,d.addClass("maximized")),R(d,b)},a.maximize=function(d,b){b?R(d,1):a.reposition(d)},a.handleResize=function(d){var b=0,w=0,z=0,D=d.find(".resizer"),P=D[0];function M(x){var B=P.getBoundingClientRect(),A=(B.top+B.bottom)/2;b=(A-x.clientY)/2,w=x.clientY,k.on("mousemove",y),k.on("mouseup",S),g.on("touchmove",I)}function y(x){var B=x.clientY-b,A=u(),C=(A.height-B)/A.boundedHeight;R(d,C)}function S(x){x.preventDefault(),z=x.clientY,d.find("textarea").focus(),k.off("mousemove",y),k.off("mouseup",S),g.off("touchmove",I);var B=z-b,A=u(),C=(A.height-B)/A.boundedHeight;z-w===0&&d.hasClass("maximized")?(d.removeClass("maximized"),C=!t||t>=1-l?.5:t,R(d,C)):z-w===0||C>=1-l?(R(d,1),d.addClass("maximized"),t=C):d.removeClass("maximized"),s(C)}function I(x){x.preventDefault(),y(x.touches[0])}D.on("mousedown",function(x){x.button===0&&(x.preventDefault(),M(x))}).on("touchstart",function(x){x.preventDefault(),M(x.touches[0])}).on("touchend",S)},a}.apply(h,m),E!==void 0&&(p.exports=E)},62590:(p,h,f)=>{"use strict";var m,E;m=[f(91749)],E=function(F){var a={};return a.render=function(t,n){if(n=n||function(){},!t.find(".preview-container").is(":visible"))return n();var l=t.find("textarea");socket.emit("plugins.composer.renderPreview",l.val(),function(c,g){c||(g=$("<div>"+g+"</div>"),g.find("img:not(.not-responsive)").addClass("img-fluid"),t.find(".preview").html(g),F.fire("action:composer.preview",{postContainer:t,preview:g}),n())})},a.matchScroll=function(t){if(t.find(".preview-container").is(":visible")){var n=t.find("textarea"),l=t.find(".preview");if(n.length&&l.length){var c=n[0].scrollHeight-n.height();if(c===0)return;var g=n.scrollTop()/c;l.scrollTop(Math.max(l[0].scrollHeight-l.height(),0)*g)}}},a.handleToggler=function(t){const n=t.get(0);a.env=utils.findBootstrapEnvironment();const l=["xs","sm"].includes(a.env),c=n.querySelector('.formatting-bar [data-action="preview"]'),g=c.querySelector(".show-text"),k=c.querySelector(".hide-text"),i=localStorage.getItem("composer:previewToggled"),e=config["composer-default"]&&config["composer-default"].hidePreviewOnOpen==="on";let o=!l&&(i===null&&!e||i==="true");const r=n.querySelector(".preview-container"),s=n.querySelector(".write-container");if(!c)return;function u(v){l?(r.classList.toggle("hide",!1),s.classList.toggle("maximized",!1),r.classList.toggle("d-none",!v),r.classList.toggle("d-flex",v),r.classList.toggle("w-100",v),s.classList.toggle("d-flex",!v),s.classList.toggle("d-none",v),s.classList.toggle("w-100",!v)):(r.classList.toggle("hide",!v),s.classList.toggle("w-50",v),s.classList.toggle("w-100",!v),localStorage.setItem("composer:previewToggled",v)),g.classList.toggle("hide",v),k.classList.toggle("hide",!v),v&&a.render(t),a.matchScroll(t)}a.toggle=u,c.addEventListener("click",v=>{v.button===0&&(o=!o,u(o))}),u(o)},a}.apply(h,m),E!==void 0&&(p.exports=E)},89596:(p,h,f)=>{p.exports=f(62590)},91943:(p,h,f)=>{"use strict";var m,E;m=[f(89596),f(99594),f(36159),f(51916)],E=function(F,a,t,n){var l={},c={picture:function(){var e=this;e.find("#files").attr("accept","image/*").click()},upload:function(){var e=this;e.find("#files").attr("accept","").click()},thumbs:function(){l.exitFullscreen();var e=this;Promise.all([f.e(20056),f.e(40559),f.e(5785),f.e(74566)]).then(function(){var o=[f(71431)];(function(r){const s=e.get(0).getAttribute("data-uuid"),u=r.posts[s];(u.action==="topics.post"||u.action==="posts.edit"&&u.isMain)&&t.modal.open({id:s,pid:u.pid}).then(()=>{e.trigger("thumb.uploaded"),r.updateThumbCount(s,e)})}).apply(null,o)}).catch(f.oe)},tags:function(){var e=this;e.find(".tags-container").toggleClass("hidden")},zen:function(){var e=this;$(window).one("resize",function(){function o(){n.isFullscreen||(app.toggleNavbar(!0),$("html").removeClass("zen-mode"),a.reposition(e),$(window).off("resize",o))}n.isFullscreen&&(app.toggleNavbar(!1),$("html").addClass("zen-mode"),e.find(".write").focus(),$(window).on("resize",o),$(window).one("action:composer.topics.post action:composer.posts.reply action:composer.posts.edit action:composer.discard",n.exit))}),n.toggle(e.get(0)),$(window).trigger("action:composer.fullscreen",{postContainer:e})}},g=[];l.exitFullscreen=function(){n.isEnabled&&n.isFullscreen&&n.exit()},l.addComposerButtons=function(){const e=$(".formatting-bar"),o=e.find(".formatting-group #fileForm");g.forEach(s=>{let u="";Array.isArray(s.dropdownItems)&&s.dropdownItems.length?u=i(s):u=`
					<li title="${s.title||""}">
						<button data-format="${s.name}" class="btn btn-sm btn-link text-reset position-relative" aria-label="${s.title||""}">
							<i class="${s.iconClass}"></i>
							${k(s)}
						</button>
					</li>
				`,o.before(u)}),e.find(".formatting-group>li").tooltip({container:"#content",animation:!1,trigger:"manual"}).on("mouseenter",function(s){const u=$(s.target);u.hasClass("dropdown-menu")||!!u.parents(".dropdown-menu").length||$(this).tooltip("show")}).on("click mouseleave",function(){$(this).tooltip("hide")})};function k(e){let o="";return e.badge&&(o='<span class="px-1 position-absolute top-0 start-100 translate-middle badge rounded text-bg-info"></span>'),o}function i(e){const o=e.dropdownItems.map(function(r){return`
				<li>
					<a href="#" data-format="${r.name}" class="dropdown-item rounded-1 position-relative" role="menuitem">
						<i class="${r.iconClass} text-secondary"></i> ${r.text}
						${k(r)}
					</a>
				</li>
			`});return`
			<li class="dropdown bottom-sheet" tab-index="-1" title="${e.title}">
				<button class="btn btn-sm btn-link text-reset" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false" aria-label="${e.title}">
					<i class="${e.iconClass}"></i>
				</button>
				<ul class="dropdown-menu p-1" role="menu">
				${o}
				</ul>
			</li>
		`}return l.addButton=function(e,o,r,s){s=s||e.replace("fa fa-",""),c[s]=o,g.push({name:s,iconClass:e,title:r})},l.addDropdown=function(e){g.push({iconClass:e.iconClass,title:e.title,dropdownItems:e.dropdownItems}),e.dropdownItems.forEach(o=>{o.name&&o.onClick&&(c[o.name]=o.onClick)})},l.getDispatchTable=function(){return c},l.addButtonDispatch=function(e,o){c[e]=o},l.addHandler=function(e){e.on("click",".formatting-bar [data-format]",function(o){var r=$(this).attr("data-format"),s=$(this).parents('[component="composer"]').find("textarea")[0];c.hasOwnProperty(r)&&(c[r].call(e,s,s.selectionStart,s.selectionEnd,o),F.render(e))})},l}.apply(h,m),E!==void 0&&(p.exports=E)},99594:(p,h,f)=>{p.exports=f(57904)}}]);
