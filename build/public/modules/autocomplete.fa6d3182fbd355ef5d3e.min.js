"use strict";(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[1091,13417,34271,34405,49897,99127],{34405:(P,g,c)=>{var h,y;h=[c(49897),c(29930),c(36e3),c(9787),c(35786)],y=function(E,p,{Textcomplete:x},{TextareaEditor:l},{ContenteditableEditor:m}){const f={},A={delay:200,appendTo:null};f.init=i=>{const r={...A,...i},{input:o,onSelect:t}=r;app.loadJQueryUI(function(){o.autocomplete({...r,open:function(){$(this).autocomplete("widget").css("z-index",100005)},select:function(n,e){w(o,t,n,e)}})})},f.user=function(i,r,o){typeof r=="function"&&(o=r,r={}),r=r||{},f.init({input:i,onSelect:o,source:(t,n)=>{r.query=t.term,E.get("/api/users",r,function(e,s){if(e)return p.error(e);if(s&&s.users){const d=s.users.map(function(a){const u=$("<div></div>").html(a.username).text();return a&&{label:u,value:u,user:{uid:a.uid,name:a.username,slug:a.userslug,username:a.username,userslug:a.userslug,displayname:a.displayname,picture:a.picture,banned:a.banned,"icon:text":a["icon:text"],"icon:bgColor":a["icon:bgColor"]}}});n(d)}$(".ui-autocomplete a").attr("data-ajaxify","false")})}})},f.group=function(i,r){f.init({input:i,onSelect:r,source:(o,t)=>{socket.emit("groups.search",{query:o.term},function(n,e){if(n)return p.error(n);if(e&&e.length){const s=e.map(function(d){return d&&{label:d.name,value:d.name,group:d}});t(s)}$(".ui-autocomplete a").attr("data-ajaxify","false")})}})},f.tag=function(i,r){f.init({input:i,onSelect:r,delay:100,source:(o,t)=>{socket.emit("topics.autocompleteTags",{query:o.term,cid:ajaxify.data.cid||0},function(n,e){if(n)return p.error(n);e&&t(e),$(".ui-autocomplete a").attr("data-ajaxify","false")})}})};function w(i,r,o,t){r=r||function(){};const n=jQuery.Event("keypress");n.which=13,n.keyCode=13,setTimeout(function(){i.trigger(n)},100),r(o,t)}return f.setup=function({element:i,strategies:r,options:o}){const t=i.get(0);if(t){var n;if(t.nodeName==="TEXTAREA"||t.nodeName==="INPUT"?n=new l(t):t.nodeName==="DIV"&&t.getAttribute("contenteditable")==="true"&&(n=new m(t)),!n)throw new Error("unknown target element type");t.setAttribute("dir",document.querySelector("html").getAttribute("data-dir"));var e=new x(n,r,{dropdown:o});return e.on("rendered",function(){e.dropdown.items.length&&e.dropdown.items[0].activate()}),e}},f}.apply(g,h),y!==void 0&&(P.exports=y)},49897:(P,g,c)=>{c.r(g),c.d(g,{del:()=>o,get:()=>f,head:()=>A,patch:()=>i,post:()=>w,put:()=>r});var h=c(91749),y=c.n(h),E=c(33530),p=c.n(E);const x=config.relative_path+"/api/v3";async function l(t,n){if(t.url=t.url.startsWith("/api")?config.relative_path+t.url:x+t.url,typeof n=="function"){m(t).then(e=>n(null,e),e=>n(e));return}try{return await m(t)}catch(e){if(e.message==="A valid login session was not found. Please log in and try again."){const{url:s}=await(0,h.fire)("filter:admin.reauth",{url:"login"});return(0,E.confirm)("[[error:api.reauth-required]]",d=>{d&&ajaxify.go(s)})}throw e}}async function m(t){const{url:n}=t;delete t.url,t.data&&!(t.data instanceof FormData)&&(t.data=JSON.stringify(t.data||{}),t.headers["content-type"]="application/json; charset=utf-8"),{options:t}=await(0,h.fire)("filter:api.options",{options:t}),t.data&&(t.body=t.data,delete t.data);const e=await fetch(n,t),{headers:s}=e;if(s.get("x-redirect"))return m({url:s.get("x-redirect"),...t});const d=s.get("content-type"),a=d&&d.startsWith("application/json");let u;if(t.method!=="HEAD"&&(a?u=await e.json():u=await e.text()),!e.ok)throw u?new Error(a?u.status.message:u):new Error(e.statusText);return a&&u&&u.hasOwnProperty("status")&&u.hasOwnProperty("response")?u.response:u}function f(t,n,e){return l({url:t+(n&&Object.keys(n).length?"?"+$.param(n):"")},e)}function A(t,n,e){return l({url:t+(n&&Object.keys(n).length?"?"+$.param(n):""),method:"HEAD"},e)}function w(t,n,e){return l({url:t,method:"POST",data:n,headers:{"x-csrf-token":config.csrf_token}},e)}function i(t,n,e){return l({url:t,method:"PATCH",data:n,headers:{"x-csrf-token":config.csrf_token}},e)}function r(t,n,e){return l({url:t,method:"PUT",data:n,headers:{"x-csrf-token":config.csrf_token}},e)}function o(t,n,e){return l({url:t,method:"DELETE",data:n,headers:{"x-csrf-token":config.csrf_token}},e)}}}]);
