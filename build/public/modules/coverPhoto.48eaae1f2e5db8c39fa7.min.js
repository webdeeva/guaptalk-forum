(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[97082],{18675:()=>{(function(g){var f=g(window),c=function(n,s,e,i){if(arguments.length===3||i){if(e<n)return n;if(e>s)return s}return e},l=function(n){n.clientX=n.originalEvent.touches[0].clientX,n.clientY=n.originalEvent.touches[0].clientY},v=function(n){var s=(n.css("background-image").match(/^url\(['"]?(.*?)['"]?\)$/i)||[])[1];if(s){var e={width:0,height:0},i=new Image;return i.onload=function(){if(n.css("background-size")=="cover"){var t=n.innerWidth(),d=n.innerHeight(),r=t/d,u=i.width/i.height,o=1;u>=r?o=d/i.height:o=t/i.width,e.width=i.width*o,e.height=i.height*o}else e.width=i.width,e.height=i.height},i.src=s,e}};function h(n,s){this.element=n,this.options=s,this.init()}h.prototype.init=function(){var n=g(this.element),s=(n.css("background-image").match(/^url\(['"]?(.*?)['"]?\)$/i)||[])[1],e=this.options;if(s){var i={width:0,height:0};(e.bound||e.units=="percent")&&(i=v(n)),g(window).on("keydown.dbg",t=>{var d=n.css("background-position").match(/(-?\d+).*?\s(-?\d+)/)||[],r=parseInt(d[1])||0,u=parseInt(d[2])||0;e.units=="percent"&&(r=Math.round(r/-200*i.width),u=Math.round(u/-200*i.height));var o=0,a=0;return t.which===37?o=-5:t.which===39?o=5:t.which===38?a=-5:t.which===40&&(a=5),e.units==="percent"?(r=e.axis==="y"?r:c(-i.width/2,0,r+o,e.bound),u=e.axis==="x"?u:c(-i.height/2,0,u+a,e.bound),n.css("background-position",r/i.width*-200+"% "+u/i.height*-200+"%")):(r=e.axis==="y"?r:c(n.innerWidth()-i.width,0,r+o,e.bound),u=e.axis==="x"?u:c(n.innerHeight()-i.height,0,u+a,e.bound)),[37,38,39,40].includes(t.which)?!1:void 0}),n.on("mousedown.dbg touchstart.dbg",function(t){if(t.target===n[0]){if(t.preventDefault(),t.originalEvent.touches)l(t);else if(t.which!==1)return;var d=t.clientX,r=t.clientY,u=n.css("background-position").match(/(-?\d+).*?\s(-?\d+)/)||[],o=parseInt(u[1])||0,a=parseInt(u[2])||0;e.units=="percent"&&(o=Math.round(o/-200*i.width),a=Math.round(a/-200*i.height)),f.on("mousemove.dbg touchmove.dbg",function(b){b.preventDefault(),b.originalEvent.touches&&l(b);var p=b.clientX,m=b.clientY;e.units=="percent"?(o=e.axis==="y"?o:c(-i.width/2,0,o+p-d,e.bound),a=e.axis==="x"?a:c(-i.height/2,0,a+m-r,e.bound),n.css("background-position",o/i.width*-200+"% "+a/i.height*-200+"%")):(o=e.axis==="y"?o:c(n.innerWidth()-i.width,0,o+p-d,e.bound),a=e.axis==="x"?a:c(n.innerHeight()-i.height,0,a+m-r,e.bound),n.css("background-position",o+"px "+a+"px")),d=p,r=m}),f.on("mouseup.dbg touchend.dbg mouseleave.dbg",function(){e.done&&e.done(),f.off("mousemove.dbg touchmove.dbg"),f.off("mouseup.dbg touchend.dbg mouseleave.dbg")})}})}},h.prototype.disable=function(){var n=g(this.element);n.off("mousedown.dbg touchstart.dbg"),f.off("mousemove.dbg touchmove.dbg mouseup.dbg touchend.dbg mouseleave.dbg keydown.dbg")},g.fn.backgroundDraggable=function(n){var s=Array.prototype.slice.call(arguments,1);return this.each(function(){var e=g(this),i;typeof n>"u"||typeof n=="object"?(n=g.extend({},g.fn.backgroundDraggable.defaults,n),i=new h(this,n),e.data("dbg",i)):typeof n=="string"&&e.data("dbg")&&(i=e.data("dbg"),h.prototype[n].apply(i,s))})},g.fn.backgroundDraggable.defaults={bound:!0,axis:void 0,units:"pixels"}})(jQuery)},36684:(g,f,c)=>{"use strict";var l,v;l=[c(29930),c(18675)],v=function(h){const n={coverEl:null,saveFn:null};n.init=function(e,i,t,d){n.coverEl=e,n.saveFn=i,e.find(".upload").on("click",t),e.find(".resize").on("click",function(){s(e)}),e.find(".remove").on("click",d),e.on("dragover",n.onDragOver).on("drop",n.onDrop),e.find(".save").on("click",n.save),e.addClass("initialised")},n.onDragOver=function(e){e.stopPropagation(),e.preventDefault(),e.originalEvent.dataTransfer.dropEffect="copy"},n.onDrop=function(e){e.stopPropagation(),e.preventDefault();const i=e.originalEvent.dataTransfer.files,t=new FileReader;i.length&&i[0].type.match("image.*")&&(t.onload=function(d){n.coverEl.css("background-image","url("+d.target.result+")"),n.newCover=d.target.result},t.readAsDataURL(i[0]),s(n.coverEl))};function s(e){e.toggleClass("active",1).backgroundDraggable({axis:"y",units:"percent"}),h.alert({alert_id:"drag_start",title:"[[modules:cover.dragging-title]]",message:"[[modules:cover.dragging-message]]",timeout:5e3})}return n.save=function(){n.coverEl.addClass("saving"),n.saveFn(n.newCover||void 0,n.coverEl.css("background-position"),function(e){e?h.error(e):(n.coverEl.toggleClass("active",0),n.coverEl.backgroundDraggable("disable"),n.coverEl.off("dragover",n.onDragOver),n.coverEl.off("drop",n.onDrop),h.success("[[modules:cover.saved]]")),n.coverEl.removeClass("saving")})},n}.apply(f,l),v!==void 0&&(g.exports=v)}}]);
