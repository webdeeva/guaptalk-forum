(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[1091,25764,33069,34271,49897,69185,86198,99127],{13342:(y,p,l)=>{y.exports=l(41644)},14063:(y,p,l)=>{"use strict";y=l.nmd(y);var h,m;h=[l(17459),l(91749)],m=function(C,k){const s={};let o=!1;s.init=function(){if(s.taskbar=$('[component="taskbar"]'),s.tasklist=s.taskbar.find("ul"),!s.taskbar.length||!s.tasklist.length){o=!0;return}s.taskbar.on("click","li",async function(){const t=$(this),n=t.attr("data-module"),a=t.attr("data-uuid"),e=await app.require(n);return t.hasClass("active")?e.minimize(a):(i(),e.load(a),s.toggleNew(a,!1),s.tasklist.removeClass("active"),t.addClass("active")),!1}),$(window).on("action:app.loggedOut",function(){s.closeAll()})},s.close=async function(t,n){if(o)return;if(s.tasklist.find('[data-module="'+y+'"][data-uuid="'+n+'"]').length){const e=await app.require(t);e&&typeof e.close=="function"&&e.close(n)}},s.closeAll=function(t){if(o)return;let n="[data-uuid]";t&&(n='[data-module="'+t+'"]'+n),s.tasklist.find(n).each(function(a,e){s.close(t||e.getAttribute("data-module"),e.getAttribute("data-uuid"))})},s.discard=function(t,n){if(o)return;s.tasklist.find('[data-module="'+t+'"][data-uuid="'+n+'"]').remove(),f()},s.push=function(t,n,a,e){if(e=e||function(){},o)return e();const c=s.tasklist.find('li[data-uuid="'+n+'"]'),r={module:t,uuid:n,options:a,element:c};k.fire("filter:taskbar.push",r),!c.length&&r.module?d(r,e):e(c)},s.get=function(t){return o?[]:$('[data-module="'+t+'"]').map(function(a,e){return $(e).data()})},s.minimize=function(t,n){if(o)return;s.tasklist.find('[data-module="'+t+'"][data-uuid="'+n+'"]').toggleClass("active",!1)},s.toggleNew=function(t,n,a){if(o)return;s.tasklist.find('[data-uuid="'+t+'"]').toggleClass("new",n),a||k.fire("action:taskbar.toggleNew",t)},s.updateActive=function(t){if(o)return;const n=s.tasklist.find("li");n.removeClass("active"),n.filter('[data-uuid="'+t+'"]').addClass("active"),$("[data-uuid]:not([data-module])").toggleClass("modal-unfocused",!0),$('[data-uuid="'+t+'"]:not([data-module])').toggleClass("modal-unfocused",!1)},s.isActive=function(t){return o?!1:s.tasklist.find('li[data-uuid="'+t+'"]').hasClass("active")};function f(){if(o)return;s.tasklist.find("li").length>0?s.taskbar.attr("data-active","1"):s.taskbar.removeAttr("data-active")}function i(){o||s.tasklist.find(".active").removeClass("active")}function d(t,n){if(o)return n();C.translate(t.options.title,function(a){const e=$("<div></div>").text(a||"NodeBB Task").html(),c=$("<li></li>").addClass(t.options.className).html('<a href="#"'+(t.options.image?` style="background-image: url('`+t.options.image.replace(/&#x2F;/g,"/")+`'); background-size: cover;"`:"")+">"+(t.options.icon?'<i class="fa '+t.options.icon+'"></i> ':"")+'<span aria-label="'+e+'" component="taskbar/title">'+e+"</span></a>").attr({title:e,"data-module":t.module,"data-uuid":t.uuid}).addClass(t.options.state!==void 0?t.options.state:"active");(!t.options.state||t.options.state==="active")&&i(),s.tasklist.append(c),f(),t.element=c,c.data(t),k.fire("action:taskbar.pushed",t),n(c)})}const u=function(t,n,a){switch(n){case"title":t.find('[component="taskbar/title"]').text(a);break;case"icon":t.find("i").attr("class","fa fa-"+a);break;case"image":t.find("a").css("background-image",a?'url("'+a.replace(/&#x2F;/g,"/")+'")':"");break;case"background-color":t.find("a").css("background-color",a);break;case"color":t.find("a").css("color",a);break}};return s.update=function(t,n,a){if(o)return;const e=s.tasklist.find('[data-module="'+t+'"][data-uuid="'+n+'"]');if(!e.length)return;const c=e.data();Object.keys(a).forEach(function(r){c[r]=a[r],u(e,r,a[r])}),e.data(c)},s}.apply(p,h),m!==void 0&&(y.exports=m)},41644:(y,p,l)=>{"use strict";var h,m;h=[l(65348),l(14063),l(49897)],m=function(C,k,s){var o={},f;o.init=function(t,n){var a=t.find(".category-list-container");a.length&&(t.on("action:composer.resize",function(){i(t)}),o.updateTaskbar(t,n),f=C.init(a.find('[component="category-selector"]'),{privilege:"topics:create",states:["watching","tracking","notwatching","ignoring"],onSelect:function(e){n.hasOwnProperty("cid")&&u(t,n,e)}}),f&&(n.cid&&n.category?f.selectedCategory={cid:n.cid,name:n.category.name}:ajaxify.data.template.compose&&ajaxify.data.selectedCategory&&(f.selectedCategory={cid:ajaxify.data.cid,name:ajaxify.data.selectedCategory}),t.find(".category-name").translateHtml(f.selectedCategory?f.selectedCategory.name:"[[modules:composer.select-category]]").on("click",function(){C.modal({privilege:"topics:create",states:["watching","tracking","notwatching","ignoring"],openOnLoad:!0,showLinks:!1,onSubmit:function(e){t.find(".category-name").text(e.name),f.selectCategory(e.cid),n.hasOwnProperty("cid")&&u(t,n,e)}})}),i(t)))};function i(t){t.find('.category-list-container [component="category-selector"]').toggleClass("dropup",t.outerHeight()<$(window).height()/2)}o.getSelectedCid=function(){var t;return f&&(t=f.getSelectedCategory()),t?t.cid:0},o.updateTaskbar=function(t,n){parseInt(n.cid,10)&&s.get(`/categories/${n.cid}`,{}).then(function(a){d(t,a)})};function d(t,n){if(n){var a=t.attr("data-uuid");k.update("composer",a,{image:n.backgroundImage,color:n.color,"background-color":n.bgColor,icon:n.icon&&n.icon.slice(3)})}}async function u(t,n,a){n.cid=a.cid;const e=await window.fetch(`${config.relative_path}/api/category/${encodeURIComponent(a.cid)}`).then(c=>c.json());n.category=e,d(t,e),l.e(56382).then(function(){var c=[l(72573),l(52543),l(92762)];(function(r,g,E){r.onChangeCategory(e),g.onChangeCategory(t,n,a.cid,e),E.onChangeCategory(t,n),$(window).trigger("action:composer.changeCategory",{postContainer:t,postData:n,selectedCategory:a,categoryData:e})}).apply(null,c)}).catch(l.oe)}return o}.apply(p,h),m!==void 0&&(y.exports=m)},49897:(y,p,l)=>{"use strict";l.r(p),l.d(p,{del:()=>a,get:()=>i,head:()=>d,patch:()=>t,post:()=>u,put:()=>n});var h=l(91749),m=l.n(h),C=l(33530),k=l.n(C);const s=config.relative_path+"/api/v3";async function o(e,c){if(e.url=e.url.startsWith("/api")?config.relative_path+e.url:s+e.url,typeof c=="function"){f(e).then(r=>c(null,r),r=>c(r));return}try{return await f(e)}catch(r){if(r.message==="A valid login session was not found. Please log in and try again."){const{url:g}=await(0,h.fire)("filter:admin.reauth",{url:"login"});return(0,C.confirm)("[[error:api.reauth-required]]",E=>{E&&ajaxify.go(g)})}throw r}}async function f(e){const{url:c}=e;delete e.url,e.data&&!(e.data instanceof FormData)&&(e.data=JSON.stringify(e.data||{}),e.headers["content-type"]="application/json; charset=utf-8"),{options:e}=await(0,h.fire)("filter:api.options",{options:e}),e.data&&(e.body=e.data,delete e.data);const r=await fetch(c,e),{headers:g}=r;if(g.get("x-redirect"))return f({url:g.get("x-redirect"),...e});const E=g.get("content-type"),v=E&&E.startsWith("application/json");let b;if(e.method!=="HEAD"&&(v?b=await r.json():b=await r.text()),!r.ok)throw b?new Error(v?b.status.message:b):new Error(r.statusText);return v&&b&&b.hasOwnProperty("status")&&b.hasOwnProperty("response")?b.response:b}function i(e,c,r){return o({url:e+(c&&Object.keys(c).length?"?"+$.param(c):"")},r)}function d(e,c,r){return o({url:e+(c&&Object.keys(c).length?"?"+$.param(c):""),method:"HEAD"},r)}function u(e,c,r){return o({url:e,method:"POST",data:c,headers:{"x-csrf-token":config.csrf_token}},r)}function t(e,c,r){return o({url:e,method:"PATCH",data:c,headers:{"x-csrf-token":config.csrf_token}},r)}function n(e,c,r){return o({url:e,method:"PUT",data:c,headers:{"x-csrf-token":config.csrf_token}},r)}function a(e,c,r){return o({url:e,method:"DELETE",data:c,headers:{"x-csrf-token":config.csrf_token}},r)}},65348:(y,p,l)=>{"use strict";var h,m;h=[l(96349),l(33530),l(91749),l(17459)],m=function(C,k,s,o){const f={};return f.init=function(i,d){if(!i||!i.length)return;d=d||{};const u=d.onSelect||function(){};d.states=d.states||["watching","tracking","notwatching","ignoring"],d.template=d.template||"partials/category/selector-dropdown-left",s.fire("action:category.selector.options",{el:i,options:d}),C.init(i,d);const t={el:i,selectedCategory:null};i.on("click","[data-cid]",function(){const a=$(this);return a.hasClass("disabled")?!1:(t.selectCategory(a.attr("data-cid")),u(t.selectedCategory))});let n=t.el.find('[component="category-selector-selected"]').html();return o.translate(n,a=>{n=a}),t.selectCategory=function(a){const e=t.el.find('[data-cid="'+a+'"]');t.selectedCategory={cid:a,name:e.attr("data-name")},e.length?t.el.find('[component="category-selector-selected"]').html(e.find('[component="category-markup"]').html()):t.el.find('[component="category-selector-selected"]').html(n)},t.getSelectedCategory=function(){return t.selectedCategory},t.getSelectedCid=function(){return t.selectedCategory?t.selectedCategory.cid:0},d.hasOwnProperty("selectedCategory")&&app.parseAndTranslate(d.template,{selectedCategory:d.selectedCategory},function(a){t.el.find('[component="category-selector-selected"]').html(a.find('[component="category-selector-selected"]').html())}),t},f.modal=function(i){i=i||{},i.onSelect=i.onSelect||function(){},i.onSubmit=i.onSubmit||function(){},app.parseAndTranslate("admin/partials/categories/select-category",{message:i.message},function(d){const u=k.dialog({title:i.title||"[[modules:composer.select-category]]",message:d,buttons:{save:{label:"[[global:select]]",className:"btn-primary",callback:n}}}),t=f.init(u.find('[component="category-selector"]'),i);function n(a){return a.preventDefault(),t.selectedCategory&&(i.onSubmit(t.selectedCategory),u.modal("hide")),!1}i.openOnLoad&&u.on("shown.bs.modal",function(){u.find(".dropdown-toggle").dropdown("toggle")}),u.find("form").on("submit",n)})},f}.apply(p,h),m!==void 0&&(y.exports=m)},96349:(y,p,l)=>{"use strict";var h,m;h=[l(29930),l(89336),l(49897)],m=function(C,k,s){const o={};return o.init=function(f,i){let d=i.defaultCategories||null;i=i||{},i.privilege=i.privilege||"topics:read",i.states=i.states||["watching","tracking","notwatching","ignoring"],i.cacheList=i.hasOwnProperty("cacheList")?i.cacheList:!0;let u=[];Array.isArray(i.localCategories)&&(u=i.localCategories.map(c=>({...c})),d&&(d=[...u,...d])),i.selectedCids=i.selectedCids||ajaxify.data.selectedCids||[];const t=f.find('[component="category-selector-search"]');if(!t.length)return;const n=t.parents('[component="category/dropdown"]').length>0||t.parents('[component="category-selector"]').length>0;f.on("show.bs.dropdown",function(){n&&t.removeClass("hidden");function c(){const r=t.find("input").val();r.length>1||!r&&!d?a(r,function(g){d=i.cacheList&&(d||g),e(g)}):!r&&d&&e(d)}t.on("click",function(r){r.preventDefault(),r.stopPropagation()}),t.find("input").val("").on("keyup",utils.debounce(c,300)),c()}),f.on("shown.bs.dropdown",function(){["xs","sm"].includes(utils.findBootstrapEnvironment())||t.find("input").focus()}),f.on("hide.bs.dropdown",function(){n&&t.addClass("hidden"),t.off("click"),t.find("input").off("keyup")});function a(c,r){s.get("/search/categories",{search:c,query:utils.params(),parentCid:i.parentCid||0,selectedCids:i.selectedCids,privilege:i.privilege,states:i.states,showLinks:i.showLinks},function(g,{categories:E}){if(g)return C.error(g);r(u.concat(E))})}function e(c){const r=i.selectedCids.map(String);c.forEach(function(g){g.selected=r.includes(String(g.cid))}),app.parseAndTranslate(i.template,{categoryItems:c.slice(0,200),selectedCategory:ajaxify.data.selectedCategory,allCategoriesUrl:ajaxify.data.allCategoriesUrl},function(g){f.find('[component="category/list"]').html(g.find('[component="category/list"]').html()),f.find('[component="category/list"] [component="category/no-matches"]').toggleClass("hidden",!!c.length);const E=k.Dropdown.getInstance(f.find(".dropdown-toggle").get(0));E&&E.update()})}},o}.apply(p,h),m!==void 0&&(y.exports=m)}}]);
