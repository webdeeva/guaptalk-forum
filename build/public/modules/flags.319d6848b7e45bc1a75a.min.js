"use strict";(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[1091,6574,34271,47282,49897,99127],{6574:(P,E,l)=>{var h,y;h=[l(91749),l(52473),l(49897),l(29930)],y=function(i,D,m,a){const c={};let o,d,u;c.showFlagModal=function(r){r.remote=URL.canParse(r.id)?new URL(r.id).hostname:!1,app.parseAndTranslate("modals/flag",r,function(e){o=e,o.on("hidden.bs.modal",function(){o.remove()}),d=o.find("#flag-post-commit"),u=o.find("#flag-reason-custom"),o.on("click",'input[name="flag-reason"]',function(){$(this).attr("id")==="flag-reason-other"?(u.removeAttr("disabled"),u.val().length||d.attr("disabled",!0)):(u.attr("disabled",!0),d.removeAttr("disabled"))}),d.on("click",function(){const n=$('input[name="flag-reason"]:checked');let t=n.val();n.attr("id")==="flag-reason-other"&&(t=u.val());const f=$('input[name="flag-notify-remote"]').is(":checked");v(r.type,r.id,t,f)}),o.on("click","#flag-reason-other",function(){u.focus()}),o.modal("show"),i.fire("action:flag.showModal",{modalEl:o,type:r.type,id:r.id,remote:r.remote}),o.find("#flag-reason-custom").on("keyup blur change",A)})},c.resolve=function(r){m.put(`/flags/${r}`,{state:"resolved"}).then(()=>{a.success("[[flags:resolved]]"),i.fire("action:flag.resolved",{flagId:r})}).catch(a.error)},c.rescind=function(r){m.del(`/flags/${r}/report`).then(()=>{a.success("[[flags:report-rescinded]]"),i.fire("action:flag.rescinded",{flagId:r})}).catch(a.error)},c.purge=function(r){m.del(`/flags/${r}`).then(()=>{a.success("[[flags:purged]]"),i.fire("action:flag.purged",{flagId:r})}).catch(a.error)};function v(r,e,n,t=!1){if(!r||!e||!n)return;const f={type:r,id:e,reason:n,notifyRemote:t};m.post("/flags",f,function(g,p){if(g)return a.error(g);if(o.modal("hide"),a.success("[[flags:modal-submit-success]]"),r==="post"){const s=D.get("post","pid",e);s.find('[component="post/flag"]').addClass("hidden").parent().attr("hidden",""),s.find('[component="post/already-flagged"]').removeClass("hidden").parent().attr("hidden",null)}i.fire("action:flag.create",{flagId:p,data:f})})}function A(){o.find("#flag-reason-custom").val()?d.removeAttr("disabled"):d.attr("disabled",!0)}return c}.apply(E,h),y!==void 0&&(P.exports=y)},49897:(P,E,l)=>{l.r(E),l.d(E,{del:()=>r,get:()=>o,head:()=>d,patch:()=>v,post:()=>u,put:()=>A});var h=l(91749),y=l.n(h),i=l(33530),D=l.n(i);const m=config.relative_path+"/api/v3";async function a(e,n){if(e.url=e.url.startsWith("/api")?config.relative_path+e.url:m+e.url,typeof n=="function"){c(e).then(t=>n(null,t),t=>n(t));return}try{return await c(e)}catch(t){if(t.message==="A valid login session was not found. Please log in and try again."){const{url:f}=await(0,h.fire)("filter:admin.reauth",{url:"login"});return(0,i.confirm)("[[error:api.reauth-required]]",g=>{g&&ajaxify.go(f)})}throw t}}async function c(e){const{url:n}=e;delete e.url,e.data&&!(e.data instanceof FormData)&&(e.data=JSON.stringify(e.data||{}),e.headers["content-type"]="application/json; charset=utf-8"),{options:e}=await(0,h.fire)("filter:api.options",{options:e}),e.data&&(e.body=e.data,delete e.data);const t=await fetch(n,e),{headers:f}=t;if(f.get("x-redirect"))return c({url:f.get("x-redirect"),...e});const g=f.get("content-type"),p=g&&g.startsWith("application/json");let s;if(e.method!=="HEAD"&&(p?s=await t.json():s=await t.text()),!t.ok)throw s?new Error(p?s.status.message:s):new Error(t.statusText);return p&&s&&s.hasOwnProperty("status")&&s.hasOwnProperty("response")?s.response:s}function o(e,n,t){return a({url:e+(n&&Object.keys(n).length?"?"+$.param(n):"")},t)}function d(e,n,t){return a({url:e+(n&&Object.keys(n).length?"?"+$.param(n):""),method:"HEAD"},t)}function u(e,n,t){return a({url:e,method:"POST",data:n,headers:{"x-csrf-token":config.csrf_token}},t)}function v(e,n,t){return a({url:e,method:"PATCH",data:n,headers:{"x-csrf-token":config.csrf_token}},t)}function A(e,n,t){return a({url:e,method:"PUT",data:n,headers:{"x-csrf-token":config.csrf_token}},t)}function r(e,n,t){return a({url:e,method:"DELETE",data:n,headers:{"x-csrf-token":config.csrf_token}},t)}}}]);
