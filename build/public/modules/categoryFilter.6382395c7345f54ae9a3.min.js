"use strict";(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[1091,34271,49897,51831,69185,99127],{39259:(A,C,l)=>{var y,m;y=[l(96349),l(49897),l(91749)],m=function(p,v,E){const f={};f.init=function(n,r){if(!n||!n.length)return;r=r||{},r.states=r.states||["watching","tracking","notwatching","ignoring"],r.template=r.template||"partials/category/filter-dropdown-left",E.fire("action:category.filter.options",{el:n,options:r}),p.init(n,r);let i=[],c=[];Array.isArray(r.selectedCids)?i=r.selectedCids.map(String):Array.isArray(ajaxify.data.selectedCids)&&(i=ajaxify.data.selectedCids.map(String)),c=i.slice(),n.on("hidden.bs.dropdown",function(){let d=c.length!==i.length;if(c.forEach(function(u,e){u!==i[e]&&(d=!0)}),c=i.slice(),d&&(r.updateButton?r.updateButton({el:n,changed:d,selectedCids:i.slice()}):r.updateButton!==!1&&o(n,i)),r.onHidden){r.onHidden({changed:d,selectedCids:i.slice()});return}if(d){let u=window.location.pathname;const e=utils.params();i.length?e.cid=i:delete e.cid,delete e.page,Object.keys(e).length&&(u+="?"+$.param(e)),ajaxify.go(u)}}),n.on("click",'[component="category/list"] [data-cid]',function(d){const u=n.find('[component="category/list"]'),e=$(this),a=e.find("a").attr("href");if(a&&a!=="#"&&a.length){d.stopPropagation();return}const t=e.attr("data-cid"),s=e.find('[component="category/select/icon"]');return t!=="all"?(i.includes(t)?i.splice(i.indexOf(t),1):i.push(t),i.sort(function(g,w){return g-w}),s.toggleClass("invisible"),u.find('[data-cid="all"] i').toggleClass("invisible",!!i.length)):(n.find('[component="category/select/icon"]').addClass("invisible"),u.find('[data-cid="all"] i').removeClass("invisible"),i=[]),r.selectedCids=i,r.onSelect&&r.onSelect({cid:t,selectedCids:i.slice()}),!1})};function o(n,r){r.length>1?i({icon:"fa-plus",name:"[[unread:multiple-categories-selected]]",bgColor:"#ddd"}):r.length===1?v.get(`/categories/${r[0]}`,{}).then(i):i();function i(c){app.parseAndTranslate("partials/category/filter-dropdown-content",{selectedCategory:c},function(d){n.find("button").replaceWith($("<div/>").html(d).find("button"))})}}return f}.apply(C,y),m!==void 0&&(A.exports=m)},49897:(A,C,l)=>{l.r(C),l.d(C,{del:()=>u,get:()=>n,head:()=>r,patch:()=>c,post:()=>i,put:()=>d});var y=l(91749),m=l.n(y),p=l(33530),v=l.n(p);const E=config.relative_path+"/api/v3";async function f(e,a){if(e.url=e.url.startsWith("/api")?config.relative_path+e.url:E+e.url,typeof a=="function"){o(e).then(t=>a(null,t),t=>a(t));return}try{return await o(e)}catch(t){if(t.message==="A valid login session was not found. Please log in and try again."){const{url:s}=await(0,y.fire)("filter:admin.reauth",{url:"login"});return(0,p.confirm)("[[error:api.reauth-required]]",g=>{g&&ajaxify.go(s)})}throw t}}async function o(e){const{url:a}=e;delete e.url,e.data&&!(e.data instanceof FormData)&&(e.data=JSON.stringify(e.data||{}),e.headers["content-type"]="application/json; charset=utf-8"),{options:e}=await(0,y.fire)("filter:api.options",{options:e}),e.data&&(e.body=e.data,delete e.data);const t=await fetch(a,e),{headers:s}=t;if(s.get("x-redirect"))return o({url:s.get("x-redirect"),...e});const g=s.get("content-type"),w=g&&g.startsWith("application/json");let h;if(e.method!=="HEAD"&&(w?h=await t.json():h=await t.text()),!t.ok)throw h?new Error(w?h.status.message:h):new Error(t.statusText);return w&&h&&h.hasOwnProperty("status")&&h.hasOwnProperty("response")?h.response:h}function n(e,a,t){return f({url:e+(a&&Object.keys(a).length?"?"+$.param(a):"")},t)}function r(e,a,t){return f({url:e+(a&&Object.keys(a).length?"?"+$.param(a):""),method:"HEAD"},t)}function i(e,a,t){return f({url:e,method:"POST",data:a,headers:{"x-csrf-token":config.csrf_token}},t)}function c(e,a,t){return f({url:e,method:"PATCH",data:a,headers:{"x-csrf-token":config.csrf_token}},t)}function d(e,a,t){return f({url:e,method:"PUT",data:a,headers:{"x-csrf-token":config.csrf_token}},t)}function u(e,a,t){return f({url:e,method:"DELETE",data:a,headers:{"x-csrf-token":config.csrf_token}},t)}},96349:(A,C,l)=>{var y,m;y=[l(29930),l(89336),l(49897)],m=function(p,v,E){const f={};return f.init=function(o,n){let r=n.defaultCategories||null;n=n||{},n.privilege=n.privilege||"topics:read",n.states=n.states||["watching","tracking","notwatching","ignoring"],n.cacheList=n.hasOwnProperty("cacheList")?n.cacheList:!0;let i=[];Array.isArray(n.localCategories)&&(i=n.localCategories.map(a=>({...a})),r&&(r=[...i,...r])),n.selectedCids=n.selectedCids||ajaxify.data.selectedCids||[];const c=o.find('[component="category-selector-search"]');if(!c.length)return;const d=c.parents('[component="category/dropdown"]').length>0||c.parents('[component="category-selector"]').length>0;o.on("show.bs.dropdown",function(){d&&c.removeClass("hidden");function a(){const t=c.find("input").val();t.length>1||!t&&!r?u(t,function(s){r=n.cacheList&&(r||s),e(s)}):!t&&r&&e(r)}c.on("click",function(t){t.preventDefault(),t.stopPropagation()}),c.find("input").val("").on("keyup",utils.debounce(a,300)),a()}),o.on("shown.bs.dropdown",function(){["xs","sm"].includes(utils.findBootstrapEnvironment())||c.find("input").focus()}),o.on("hide.bs.dropdown",function(){d&&c.addClass("hidden"),c.off("click"),c.find("input").off("keyup")});function u(a,t){E.get("/search/categories",{search:a,query:utils.params(),parentCid:n.parentCid||0,selectedCids:n.selectedCids,privilege:n.privilege,states:n.states,showLinks:n.showLinks},function(s,{categories:g}){if(s)return p.error(s);t(i.concat(g))})}function e(a){const t=n.selectedCids.map(String);a.forEach(function(s){s.selected=t.includes(String(s.cid))}),app.parseAndTranslate(n.template,{categoryItems:a.slice(0,200),selectedCategory:ajaxify.data.selectedCategory,allCategoriesUrl:ajaxify.data.allCategoriesUrl},function(s){o.find('[component="category/list"]').html(s.find('[component="category/list"]').html()),o.find('[component="category/list"] [component="category/no-matches"]').toggleClass("hidden",!!a.length);const g=v.Dropdown.getInstance(o.find(".dropdown-toggle").get(0));g&&g.update()})}},f}.apply(C,y),m!==void 0&&(A.exports=m)}}]);
