(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[6232,25150,74953,86706,86924,97650],{20460:function(D,S,u){var T,R,j=this&&this.__awaiter||function(o,i,e,a){function r(n){return n instanceof e?n:new e(function(f){f(n)})}return new(e||(e=Promise))(function(n,f){function l(s){try{t(a.next(s))}catch(y){f(y)}}function p(s){try{t(a.throw(s))}catch(y){f(y)}}function t(s){s.done?n(s.value):r(s.value).then(l,p)}t((a=a.apply(o,i||[])).next())})},g=this&&this.__generator||function(o,i){var e={label:0,sent:function(){if(n[0]&1)throw n[1];return n[1]},trys:[],ops:[]},a,r,n,f=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return f.next=l(0),f.throw=l(1),f.return=l(2),typeof Symbol=="function"&&(f[Symbol.iterator]=function(){return this}),f;function l(t){return function(s){return p([t,s])}}function p(t){if(a)throw new TypeError("Generator is already executing.");for(;f&&(f=0,t[0]&&(e=0)),e;)try{if(a=1,r&&(n=t[0]&2?r.return:t[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,t[1])).done)return n;switch(r=0,n&&(t=[t[0]&2,n.value]),t[0]){case 0:case 1:n=t;break;case 4:return e.label++,{value:t[1],done:!1};case 5:e.label++,r=t[1],t=[0];continue;case 7:t=e.ops.pop(),e.trys.pop();continue;default:if(n=e.trys,!(n=n.length>0&&n[n.length-1])&&(t[0]===6||t[0]===2)){e=0;continue}if(t[0]===3&&(!n||t[1]>n[0]&&t[1]<n[3])){e.label=t[1];break}if(t[0]===6&&e.label<n[1]){e.label=n[1],n=t;break}if(n&&e.label<n[2]){e.label=n[2],e.ops.push(t);break}n[2]&&e.ops.pop(),e.trys.pop();continue}t=i.call(o,e)}catch(s){t=[6,s],r=0}finally{a=n=0}if(t[0]&5)throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}};T=[u,S],R=function(o,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.strategy=i.search=i.table=i.buster=i.base=void 0,i.buildEmoji=r,i.init=f;var e="".concat(config.assetBaseUrl,"/plugins/nodebb-plugin-emoji");i.base=e;var a=config["cache-buster"];i.buster=a;function r(l,p){var t=":".concat(l.name,":"),s=p?" defer":"";return l.image?`<img
      `.concat(p?"data-":"",'src="').concat(e,"/emoji/").concat(l.pack,"/").concat(l.image,"?").concat(a,`"
      class="not-responsive emoji emoji-`).concat(l.pack," emoji--").concat(l.name," ").concat(s,`"
      title="`).concat(t,`"
      alt="`).concat(l.character,`"
    />`):`<span
    class="emoji-`.concat(l.pack," emoji--").concat(l.name,`"
    title="`).concat(t,`"
  ><span>`).concat(l.character,"</span></span>")}i.strategy={match:/\B:([^\s\n:]+)$/,search:function(l,p){p((0,i.search)(l.toLowerCase().replace(/[_-]/g,"")).slice(0,10))},index:1,replace:function(l){return":".concat(l.name,": ")},template:function(l){return"".concat(r(l)," ").concat(l.name)},cache:!0};var n;function f(l){var p=this;return n=n||Promise.all([new Promise(function(t,s){u.e(30363).then(function(){var y=[u(89713)];t.apply(null,y)}.bind(this)).catch(s.bind(this))}),new Promise(function(t,s){u.e(95983).then(function(){var y=[u(30593)];t.apply(null,y)}.bind(this)).catch(s.bind(this))}),new Promise(function(t,s){Promise.all([u.e(23662),u.e(65285),u.e(449),u.e(88189)]).then(function(){var y=[u(449)];t.apply(null,y)}.bind(this)).catch(s.bind(this))}),$.getJSON("".concat(e,"/emoji/table.json?").concat(a))]).then(function(t){var s=t[0],y=t[1],E=t[2],b=t[3];i.table=b;var A=Object.keys(i.table).map(function(h){var v=i.table[h];return{name:h,aliases:v.aliases,keywords:v.keywords,character:v.character,image:v.image,pack:v.pack}});function w(h,v){for(var d=v.length,c=0;c<d;c+=1)if(s(h,v[c]))return v[c];return null}function x(h){function v(d,c){var m=c*(1+y(h,d));return d.startsWith(h)?m-2:m}return A.filter(function(d){if(s(h,d.name))return d.score=v(d.name,1),!0;var c=w(h,d.aliases);if(c)return d.score=v(c,3),!0;var m=w(h,d.keywords);return m?(d.score=v(m,7),!0):!1}).sort(function(d,c){return d.score-c.score}).sort(function(d,c){var m=+d.name.startsWith(h),C=+c.name.startsWith(h);return C-m})}i.search=x,E.addButtonDispatch("emoji-add-emoji",function(h,v,d,c){new Promise(function(m,C){u.e(86924).then(function(){var I=[u(86924)];m.apply(null,I)}.bind(this)).catch(C.bind(this))}).then(function(m){var C=m.toggleForInsert;return C(h,v,d,c)})})}).catch(function(t){return j(p,void 0,void 0,function(){var s,y;return g(this,function(E){switch(E.label){case 0:return s=Error("[[emoji:meta-load-failed]]"),console.error(s),[4,app.require("alerts")];case 1:throw y=E.sent(),y.error(s),t}})})}),l&&n.then(function(){return setTimeout(l,0)}),n}}.apply(S,T),R!==void 0&&(D.exports=R)},26940:(D,S,u)=>{D.exports=u(94510)},41088:(D,S,u)=>{"use strict";var T;T=function(){const R={};return R.apply=function(j){$(j).on("mousewheel",function(g){const o=this.scrollTop,i=this.scrollHeight,e=Math.round(this.getBoundingClientRect().height);if(g.originalEvent.deltaY<0&&o===0||g.originalEvent.deltaY>0&&e+o>=i)return!1})},R}.call(S,u,S,D),T!==void 0&&(D.exports=T)},46243:(D,S,u)=>{D.exports=u(20460)},62590:(D,S,u)=>{"use strict";var T,R;T=[u(91749)],R=function(j){var g={};return g.render=function(o,i){if(i=i||function(){},!o.find(".preview-container").is(":visible"))return i();var e=o.find("textarea");socket.emit("plugins.composer.renderPreview",e.val(),function(a,r){a||(r=$("<div>"+r+"</div>"),r.find("img:not(.not-responsive)").addClass("img-fluid"),o.find(".preview").html(r),j.fire("action:composer.preview",{postContainer:o,preview:r}),i())})},g.matchScroll=function(o){if(o.find(".preview-container").is(":visible")){var i=o.find("textarea"),e=o.find(".preview");if(i.length&&e.length){var a=i[0].scrollHeight-i.height();if(a===0)return;var r=i.scrollTop()/a;e.scrollTop(Math.max(e[0].scrollHeight-e.height(),0)*r)}}},g.handleToggler=function(o){const i=o.get(0);g.env=utils.findBootstrapEnvironment();const e=["xs","sm"].includes(g.env),a=i.querySelector('.formatting-bar [data-action="preview"]'),r=a.querySelector(".show-text"),n=a.querySelector(".hide-text"),f=localStorage.getItem("composer:previewToggled"),l=config["composer-default"]&&config["composer-default"].hidePreviewOnOpen==="on";let p=!e&&(f===null&&!l||f==="true");const t=i.querySelector(".preview-container"),s=i.querySelector(".write-container");if(!a)return;function y(E){e?(t.classList.toggle("hide",!1),s.classList.toggle("maximized",!1),t.classList.toggle("d-none",!E),t.classList.toggle("d-flex",E),t.classList.toggle("w-100",E),s.classList.toggle("d-flex",!E),s.classList.toggle("d-none",E),s.classList.toggle("w-100",!E)):(t.classList.toggle("hide",!E),s.classList.toggle("w-50",E),s.classList.toggle("w-100",!E),localStorage.setItem("composer:previewToggled",E)),r.classList.toggle("hide",E),n.classList.toggle("hide",!E),E&&g.render(o),g.matchScroll(o)}g.toggle=y,a.addEventListener("click",E=>{E.button===0&&(p=!p,y(p))}),y(p)},g}.apply(S,T),R!==void 0&&(D.exports=R)},74369:(D,S,u)=>{var T,R;T=[u,S,u(17459),u(81335),u(26940),u(41088),u(46243)],R=function(j,g,o,i,e,a,r){"use strict";Object.defineProperty(g,"__esModule",{value:!0}),g.dialogActions=void 0,g.init=s,g.toggle=y,g.toggleForInsert=E;var n=$("html");g.dialogActions={open:function(b){return n.addClass("emoji-insert"),b.addClass("open"),b.appendTo(document.fullscreenElement||"body"),utils.isTouchDevice()||b.find(".emoji-dialog-search").focus(),setTimeout(function(){$(document).off("click",f).on("click",f)},0),b},close:function(b){return $(document).off("click",f),n.removeClass("emoji-insert"),b.removeClass("open")}};function f(b){var A=$("#emoji-dialog");!$(b.target).is(".emoji-dialog *")&&A.length&&g.dialogActions.close(A)}var l={people:10,nature:9,food:8,activity:7,travel:6,objects:5,symbols:4,flags:3,regional:2,modifier:1,other:0};config.emojiCustomFirst&&(l.custom=100);var p=o.Translator.create();function t(b,A){return b<A?-1:b>A?1:0}function s(b){Promise.all([$.getJSON("".concat(r.base,"/emoji/categories.json?").concat(r.buster)),$.getJSON("".concat(r.base,"/emoji/packs.json?").concat(r.buster)),new Promise(function(A){(0,r.init)(A)})]).then(function(A){var w=A[0],x=A[1],h=Object.keys(w).map(function(v){var d=w[v].map(function(c){return r.table[c]});return{name:v,emojis:d.map(function(c){return{name:c.name,html:(0,r.buildEmoji)(c,!0)}}).sort(function(c,m){return t(c.name,m.name)})}}).sort(function(v,d){var c=l[v.name]||0,m=l[d.name]||0;return m-c});return(0,i.render)("partials/emoji-dialog",{categories:h,packs:x})}).then(function(A){return p.translate(A)}).then(function(A){var w=$(A).appendTo(document.fullscreenElement||"body");w.find(".emoji-dialog-search").on("input",function(c){var m=c.target.value;if(!m){w.find(".emoji-dialog-search-results").addClass("hidden"),w.find(".nav-tabs .emoji-dialog-search-results").next().find("a").tab("show");return}var C=(0,r.search)(m).slice(0,100).map(function(I){return'<a class="emoji-link" name="'.concat(I.name,'" href="#">').concat((0,r.buildEmoji)(I,!1),"</a>")}).join(`
`);w.find(".tab-pane.emoji-dialog-search-results").html(C),w.find(".emoji-dialog-search-results").removeClass("hidden"),w.find(".nav-tabs .emoji-dialog-search-results a").tab("show"),w.find(".emoji-dialog-search").focus()});var x=w.find(".emoji-tabs .tab-content");function h(c){var m=x[0].getBoundingClientRect(),C=Math.ceil(m.width*m.height/(40*40));c.find(".emoji-link img.defer").filter(function(I,P){if(I<=C)return!0;var _=P.getBoundingClientRect();return _.right>m.left&&_.left<m.right&&_.bottom>m.top&&_.top<m.bottom}).removeClass("defer").each(function(I,P){var _=P.getAttribute("data-src");P.setAttribute("src",_)})}var v=w.find(".emoji-tabs .nav-tabs a").click(function(c){c.preventDefault(),$(c.target).tab("show")}).on("show.bs.tab",function(c){h($(c.target.getAttribute("href")))}).eq(1);setTimeout(function(){return v.trigger("show.bs.tab")},10),x.on("scroll",function(){h(x.find(".tab-pane.active"))}),(0,a.apply)(x[0]);var d=function(){return g.dialogActions.close(w)};$(window).on(["action:composer.discard","action:composer.submit","action:composer.minimize","action:chat.minimize","action:chat.closed"].join(" "),d),w.find(".close").on("click",d),b(w)}).catch(function(A){console.error("Failed to initialize emoji dialog",A)})}function y(b,A){function w(h){if(h.hasClass("open")){g.dialogActions.close(h);return}h.off("click").on("click",".emoji-link",function(c){c.preventDefault();var m=c.currentTarget.name;A(c,m,h)});var v=b?b.getBoundingClientRect():{top:window.innerHeight/3,left:window.innerWidth/3},d={bottom:"auto",top:"auto",right:"auto",left:"auto"};v.top>440?d.top="".concat(v.top-400,"px"):d.top="".concat(v.top+40,"px"),v.left<window.innerWidth/2?d.left="".concat(v.left+40,"px"):d.left="".concat(v.left-400,"px"),h.css(d),g.dialogActions.open(h)}var x=$("#emoji-dialog");x.length?w(x):s(w)}function E(b,A,w,x){var h;x&&x.target?h=$(x.target):h=$(b).parents(".composer-container").find('[data-format="emoji-add-emoji"]'),h=h[0],y(h,function(v,d){var c=":".concat(d,": "),m=b.selectionStart,C=b.selectionEnd,I=C+c.length,P=m===C?I:m;(0,e.insertIntoTextarea)(b,c),(0,e.updateTextareaSelection)(b,P,I),$(b).trigger("input")})}}.apply(S,T),R!==void 0&&(D.exports=R)},86924:(D,S,u)=>{D.exports=u(74369)},89596:(D,S,u)=>{D.exports=u(62590)},94510:(D,S,u)=>{"use strict";var T,R;T=[u(89596)],R=function(j){var g={};return g.insertIntoTextarea=function(o,i){var e={context:this,textarea:o,value:i,preventDefault:!1};if($(window).trigger("action:composer.insertIntoTextarea",e),!e.preventDefault){var a=$(e.textarea),r=a.val(),n=a.parents('[component="composer"]');a.val(r.slice(0,e.textarea.selectionStart)+e.value+r.slice(e.textarea.selectionStart)),j.render(n)}},g.replaceSelectionInTextareaWith=function(o,i){var e={context:this,textarea:o,value:i,preventDefault:!1};if($(window).trigger("action:composer.replaceSelectionInTextareaWith",e),!e.preventDefault){var a=$(e.textarea),r=a.val(),n=a.parents('[component="composer"]');a.val(r.slice(0,e.textarea.selectionStart)+e.value+r.slice(e.textarea.selectionEnd)),j.render(n)}},g.wrapSelectionInTextareaWith=function(o,i,e){var a={context:this,textarea:o,leading:i,trailing:e,preventDefault:!1};if($(window).trigger("action:composer.wrapSelectionInTextareaWith",a),!a.preventDefault){e===void 0&&(e=i);var r=$(o),n=r.val(),f=/^(\s*)([\s\S]*?)(\s*)$/.exec(n.slice(o.selectionStart,o.selectionEnd));return f[2]||(f=[null,"",n.slice(o.selectionStart,o.selectionEnd),""]),r.val(n.slice(0,o.selectionStart)+f[1]+i+f[2]+e+f[3]+n.slice(o.selectionEnd)),[f[1].length,f[3].length]}},g.updateTextareaSelection=function(o,i,e){var a={context:this,textarea:o,start:i,end:e,preventDefault:!1};$(window).trigger("action:composer.updateTextareaSelection",a),!a.preventDefault&&(o.setSelectionRange(a.start,a.end),$(a.textarea).focus())},g.getBlockData=function(o,i,e){var a=o.value;i=i.replace(/[-[\]/{}()*+?.\\^$|]/g,"\\$&");var r=new RegExp(i,"g"),n,f=[],l;for(a=a.split(`
`).reduce(function(p,t){return p!==null||(p=e<=t.length?t:null,p===null&&(e-=t.length+1)),p},null);(n=r.exec(a))!==null;)f.push(n.index);return l={in:!!(f.reduce(function(p,t){return e>=t+2&&(p+=1),p},0)%2),atEnd:f.reduce(function(p,t){return p||e===t},!1)},l.atEnd=l.in?l.atEnd:!1,l},g}.apply(S,T),R!==void 0&&(D.exports=R)}}]);
