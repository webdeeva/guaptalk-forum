"use strict";(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[24459,34405],{24459:(A,v,s)=>{var p,f;p=[s(34405),s(29930)],f=function(h,g){const y={};let a;y.init=async function(E){if(a)return;const l=E.attr("data-pid");let e=await socket.emit("posts.getEditors",{pid:l});app.parseAndTranslate("modals/manage-editors",{editors:e},function(t){a=t;const d=a.find("#manage_editors_commit");$("body").append(a),a.find("#manage_editors_cancel").on("click",u),d.on("click",function(){b(l)}),h.user(a.find("#username"),{filters:["notbanned"]},function(i,n){e.find(c=>String(c.uid)===String(n.item.user.uid))||(e.push(n.item.user),app.parseAndTranslate("modals/manage-editors","editors",{editors:e},function(c){a.find('[component="topic/editors"]').html(c),a.find("#username").val("")}))}),a.on("click","button.remove-user-icon",function(){const i=$(this).parents("[data-uid]"),n=i.attr("data-uid");e=e.filter(o=>String(o.uid)!==String(n)),i.remove()})})};function b(E){const l=a.find('[component="topic/editors"]>[data-uid]').map((e,t)=>$(t).attr("data-uid")).get();socket.emit("posts.saveEditors",{pid:E,uids:l},function(e){if(e)return g.error(e);u()})}function u(){a&&(a.remove(),a=null)}return y}.apply(v,p),f!==void 0&&(A.exports=f)},34405:(A,v,s)=>{var p,f;p=[s(49897),s(29930),s(36e3),s(9787),s(35786)],f=function(h,g,{Textcomplete:y},{TextareaEditor:a},{ContenteditableEditor:b}){const u={},E={delay:200,appendTo:null};u.init=e=>{const t={...E,...e},{input:d,onSelect:i}=t;app.loadJQueryUI(function(){d.autocomplete({...t,open:function(){$(this).autocomplete("widget").css("z-index",100005)},select:function(n,o){l(d,i,n,o)}})})},u.user=function(e,t,d){typeof t=="function"&&(d=t,t={}),t=t||{},u.init({input:e,onSelect:d,source:(i,n)=>{t.query=i.term,h.get("/api/users",t,function(o,c){if(o)return g.error(o);if(c&&c.users){const m=c.users.map(function(r){const x=$("<div></div>").html(r.username).text();return r&&{label:x,value:x,user:{uid:r.uid,name:r.username,slug:r.userslug,username:r.username,userslug:r.userslug,displayname:r.displayname,picture:r.picture,banned:r.banned,"icon:text":r["icon:text"],"icon:bgColor":r["icon:bgColor"]}}});n(m)}$(".ui-autocomplete a").attr("data-ajaxify","false")})}})},u.group=function(e,t){u.init({input:e,onSelect:t,source:(d,i)=>{socket.emit("groups.search",{query:d.term},function(n,o){if(n)return g.error(n);if(o&&o.length){const c=o.map(function(m){return m&&{label:m.name,value:m.name,group:m}});i(c)}$(".ui-autocomplete a").attr("data-ajaxify","false")})}})},u.tag=function(e,t){u.init({input:e,onSelect:t,delay:100,source:(d,i)=>{socket.emit("topics.autocompleteTags",{query:d.term,cid:ajaxify.data.cid||0},function(n,o){if(n)return g.error(n);o&&i(o),$(".ui-autocomplete a").attr("data-ajaxify","false")})}})};function l(e,t,d,i){t=t||function(){};const n=jQuery.Event("keypress");n.which=13,n.keyCode=13,setTimeout(function(){e.trigger(n)},100),t(d,i)}return u.setup=function({element:e,strategies:t,options:d}){const i=e.get(0);if(i){var n;if(i.nodeName==="TEXTAREA"||i.nodeName==="INPUT"?n=new a(i):i.nodeName==="DIV"&&i.getAttribute("contenteditable")==="true"&&(n=new b(i)),!n)throw new Error("unknown target element type");i.setAttribute("dir",document.querySelector("html").getAttribute("data-dir"));var o=new y(n,t,{dropdown:d});return o.on("rendered",function(){o.dropdown.items.length&&o.dropdown.items[0].activate()}),o}},u}.apply(v,p),f!==void 0&&(A.exports=f)}}]);
