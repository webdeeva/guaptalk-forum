(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[6232,86706,86924,97650],{26940:(b,S,u)=>{b.exports=u(94510)},41088:(b,S,u)=>{"use strict";var A;A=function(){const E={};return E.apply=function(C){$(C).on("mousewheel",function(r){const t=this.scrollTop,i=this.scrollHeight,e=Math.round(this.getBoundingClientRect().height);if(r.originalEvent.deltaY<0&&t===0||r.originalEvent.deltaY>0&&e+t>=i)return!1})},E}.call(S,u,S,b),A!==void 0&&(b.exports=A)},62590:(b,S,u)=>{"use strict";var A,E;A=[u(91749)],E=function(C){var r={};return r.render=function(t,i){if(i=i||function(){},!t.find(".preview-container").is(":visible"))return i();var e=t.find("textarea");socket.emit("plugins.composer.renderPreview",e.val(),function(n,o){n||(o=$("<div>"+o+"</div>"),o.find("img:not(.not-responsive)").addClass("img-fluid"),t.find(".preview").html(o),C.fire("action:composer.preview",{postContainer:t,preview:o}),i())})},r.matchScroll=function(t){if(t.find(".preview-container").is(":visible")){var i=t.find("textarea"),e=t.find(".preview");if(i.length&&e.length){var n=i[0].scrollHeight-i.height();if(n===0)return;var o=i.scrollTop()/n;e.scrollTop(Math.max(e[0].scrollHeight-e.height(),0)*o)}}},r.handleToggler=function(t){const i=t.get(0);r.env=utils.findBootstrapEnvironment();const e=["xs","sm"].includes(r.env),n=i.querySelector('.formatting-bar [data-action="preview"]'),o=n.querySelector(".show-text"),m=n.querySelector(".hide-text"),f=localStorage.getItem("composer:previewToggled"),D=config["composer-default"]&&config["composer-default"].hidePreviewOnOpen==="on";let d=!e&&(f===null&&!D||f==="true");const h=i.querySelector(".preview-container"),_=i.querySelector(".write-container");if(!n)return;function y(v){e?(h.classList.toggle("hide",!1),_.classList.toggle("maximized",!1),h.classList.toggle("d-none",!v),h.classList.toggle("d-flex",v),h.classList.toggle("w-100",v),_.classList.toggle("d-flex",!v),_.classList.toggle("d-none",v),_.classList.toggle("w-100",!v)):(h.classList.toggle("hide",!v),_.classList.toggle("w-50",v),_.classList.toggle("w-100",!v),localStorage.setItem("composer:previewToggled",v)),o.classList.toggle("hide",v),m.classList.toggle("hide",!v),v&&r.render(t),r.matchScroll(t)}r.toggle=y,n.addEventListener("click",v=>{v.button===0&&(d=!d,y(d))}),y(d)},r}.apply(S,A),E!==void 0&&(b.exports=E)},74369:(b,S,u)=>{var A,E;A=[u,S,u(17459),u(81335),u(26940),u(41088),u(46243)],E=function(C,r,t,i,e,n,o){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.dialogActions=void 0,r.init=_,r.toggle=y,r.toggleForInsert=v;var m=$("html");r.dialogActions={open:function(c){return m.addClass("emoji-insert"),c.addClass("open"),c.appendTo(document.fullscreenElement||"body"),utils.isTouchDevice()||c.find(".emoji-dialog-search").focus(),setTimeout(function(){$(document).off("click",f).on("click",f)},0),c},close:function(c){return $(document).off("click",f),m.removeClass("emoji-insert"),c.removeClass("open")}};function f(c){var l=$("#emoji-dialog");!$(c.target).is(".emoji-dialog *")&&l.length&&r.dialogActions.close(l)}var D={people:10,nature:9,food:8,activity:7,travel:6,objects:5,symbols:4,flags:3,regional:2,modifier:1,other:0};config.emojiCustomFirst&&(D.custom=100);var d=t.Translator.create();function h(c,l){return c<l?-1:c>l?1:0}function _(c){Promise.all([$.getJSON("".concat(o.base,"/emoji/categories.json?").concat(o.buster)),$.getJSON("".concat(o.base,"/emoji/packs.json?").concat(o.buster)),new Promise(function(l){(0,o.init)(l)})]).then(function(l){var s=l[0],T=l[1],p=Object.keys(s).map(function(w){var x=s[w].map(function(a){return o.table[a]});return{name:w,emojis:x.map(function(a){return{name:a.name,html:(0,o.buildEmoji)(a,!0)}}).sort(function(a,g){return h(a.name,g.name)})}}).sort(function(w,x){var a=D[w.name]||0,g=D[x.name]||0;return g-a});return(0,i.render)("partials/emoji-dialog",{categories:p,packs:T})}).then(function(l){return d.translate(l)}).then(function(l){var s=$(l).appendTo(document.fullscreenElement||"body");s.find(".emoji-dialog-search").on("input",function(a){var g=a.target.value;if(!g){s.find(".emoji-dialog-search-results").addClass("hidden"),s.find(".nav-tabs .emoji-dialog-search-results").next().find("a").tab("show");return}var I=(0,o.search)(g).slice(0,100).map(function(j){return'<a class="emoji-link" name="'.concat(j.name,'" href="#">').concat((0,o.buildEmoji)(j,!1),"</a>")}).join(`
`);s.find(".tab-pane.emoji-dialog-search-results").html(I),s.find(".emoji-dialog-search-results").removeClass("hidden"),s.find(".nav-tabs .emoji-dialog-search-results a").tab("show"),s.find(".emoji-dialog-search").focus()});var T=s.find(".emoji-tabs .tab-content");function p(a){var g=T[0].getBoundingClientRect(),I=Math.ceil(g.width*g.height/(40*40));a.find(".emoji-link img.defer").filter(function(j,L){if(j<=I)return!0;var R=L.getBoundingClientRect();return R.right>g.left&&R.left<g.right&&R.bottom>g.top&&R.top<g.bottom}).removeClass("defer").each(function(j,L){var R=L.getAttribute("data-src");L.setAttribute("src",R)})}var w=s.find(".emoji-tabs .nav-tabs a").click(function(a){a.preventDefault(),$(a.target).tab("show")}).on("show.bs.tab",function(a){p($(a.target.getAttribute("href")))}).eq(1);setTimeout(function(){return w.trigger("show.bs.tab")},10),T.on("scroll",function(){p(T.find(".tab-pane.active"))}),(0,n.apply)(T[0]);var x=function(){return r.dialogActions.close(s)};$(window).on(["action:composer.discard","action:composer.submit","action:composer.minimize","action:chat.minimize","action:chat.closed"].join(" "),x),s.find(".close").on("click",x),c(s)}).catch(function(l){console.error("Failed to initialize emoji dialog",l)})}function y(c,l){function s(p){if(p.hasClass("open")){r.dialogActions.close(p);return}p.off("click").on("click",".emoji-link",function(a){a.preventDefault();var g=a.currentTarget.name;l(a,g,p)});var w=c?c.getBoundingClientRect():{top:window.innerHeight/3,left:window.innerWidth/3},x={bottom:"auto",top:"auto",right:"auto",left:"auto"};w.top>440?x.top="".concat(w.top-400,"px"):x.top="".concat(w.top+40,"px"),w.left<window.innerWidth/2?x.left="".concat(w.left+40,"px"):x.left="".concat(w.left-400,"px"),p.css(x),r.dialogActions.open(p)}var T=$("#emoji-dialog");T.length?s(T):_(s)}function v(c,l,s,T){var p;T&&T.target?p=$(T.target):p=$(c).parents(".composer-container").find('[data-format="emoji-add-emoji"]'),p=p[0],y(p,function(w,x){var a=":".concat(x,": "),g=c.selectionStart,I=c.selectionEnd,j=I+a.length,L=g===I?j:g;(0,e.insertIntoTextarea)(c,a),(0,e.updateTextareaSelection)(c,L,j),$(c).trigger("input")})}}.apply(S,A),E!==void 0&&(b.exports=E)},86924:(b,S,u)=>{b.exports=u(74369)},89596:(b,S,u)=>{b.exports=u(62590)},94510:(b,S,u)=>{"use strict";var A,E;A=[u(89596)],E=function(C){var r={};return r.insertIntoTextarea=function(t,i){var e={context:this,textarea:t,value:i,preventDefault:!1};if($(window).trigger("action:composer.insertIntoTextarea",e),!e.preventDefault){var n=$(e.textarea),o=n.val(),m=n.parents('[component="composer"]');n.val(o.slice(0,e.textarea.selectionStart)+e.value+o.slice(e.textarea.selectionStart)),C.render(m)}},r.replaceSelectionInTextareaWith=function(t,i){var e={context:this,textarea:t,value:i,preventDefault:!1};if($(window).trigger("action:composer.replaceSelectionInTextareaWith",e),!e.preventDefault){var n=$(e.textarea),o=n.val(),m=n.parents('[component="composer"]');n.val(o.slice(0,e.textarea.selectionStart)+e.value+o.slice(e.textarea.selectionEnd)),C.render(m)}},r.wrapSelectionInTextareaWith=function(t,i,e){var n={context:this,textarea:t,leading:i,trailing:e,preventDefault:!1};if($(window).trigger("action:composer.wrapSelectionInTextareaWith",n),!n.preventDefault){e===void 0&&(e=i);var o=$(t),m=o.val(),f=/^(\s*)([\s\S]*?)(\s*)$/.exec(m.slice(t.selectionStart,t.selectionEnd));return f[2]||(f=[null,"",m.slice(t.selectionStart,t.selectionEnd),""]),o.val(m.slice(0,t.selectionStart)+f[1]+i+f[2]+e+f[3]+m.slice(t.selectionEnd)),[f[1].length,f[3].length]}},r.updateTextareaSelection=function(t,i,e){var n={context:this,textarea:t,start:i,end:e,preventDefault:!1};$(window).trigger("action:composer.updateTextareaSelection",n),!n.preventDefault&&(t.setSelectionRange(n.start,n.end),$(n.textarea).focus())},r.getBlockData=function(t,i,e){var n=t.value;i=i.replace(/[-[\]/{}()*+?.\\^$|]/g,"\\$&");var o=new RegExp(i,"g"),m,f=[],D;for(n=n.split(`
`).reduce(function(d,h){return d!==null||(d=e<=h.length?h:null,d===null&&(e-=h.length+1)),d},null);(m=o.exec(n))!==null;)f.push(m.index);return D={in:!!(f.reduce(function(d,h){return e>=h+2&&(d+=1),d},0)%2),atEnd:f.reduce(function(d,h){return d||e===h},!1)},D.atEnd=D.in?D.atEnd:!1,D},r}.apply(S,A),E!==void 0&&(b.exports=E)}}]);
