"use strict";(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[98391],{63387:(g,h,a)=>{var u,r;u=[a(67910),a(7524),a(17459),a(49897),a(91749),a(33530),a(29930),a(86296)],r=function(b,y,f,c,l,m,s,x){const C={};C.init=function(){b.init(),$("#submitBtn").on("click",A),ajaxify.data.groupTitleArray.length===1&&ajaxify.data.groupTitleArray[0]===""&&$('#groupTitle option[value=""]').attr("selected",!0),E(),j(),v(),L(),M(),!ajaxify.data.isSelf&&ajaxify.data.canEdit&&$(`a[href="${config.relative_path}/user/${ajaxify.data.userslug}/edit/email"]`).on("click",()=>(x.init({uid:ajaxify.data.uid,email:ajaxify.data.email,onSuccess:function(){s.success("[[user:email-updated]]")}}),!1))};function A(){function e(){return $('[component="group/badge/list"] [component="group/badge/item"][data-selected="true"]').map((d,i)=>$(i).attr("data-value")).get()}const t=$('form[component="profile/edit/form"]'),n=t.serializeObject();return t.find("select[multiple]").each((o,d)=>{const i=$(d).attr("name");n[i]&&!Array.isArray(n[i])&&(n[i]=[n[i]]),n[i]=JSON.stringify(n[i]||[])}),n.uid=ajaxify.data.uid,n.groupTitle=n.groupTitle||"",n.groupTitle=JSON.stringify(e()),l.fire("action:profile.update",n),c.put("/users/"+n.uid,n).then(o=>{s.success("[[user:profile-update-success]]"),o.picture&&$("#user-current-picture").attr("src",o.picture),y.updateHeader(o.picture)}).catch(s.error),!1}function E(){$("#deleteAccountBtn").on("click",function(){return f.translate("[[user:delete-account-confirm]]",function(e){const t=m.confirm(e+'<p><input type="password" class="form-control" id="confirm-password" /></p>',function(n){if(!n)return;const o=t.find(".btn-primary");return o.html('<i class="fa fa-spinner fa-spin"></i>'),o.prop("disabled",!0),c.del(`/users/${ajaxify.data.uid}/account`,{password:$("#confirm-password").val()},function(d){function i(){f.translate("[[modules:bootbox.confirm]]",function(S){o.text(S),o.prop("disabled",!1)})}if(d)return i(),s.error(d);o.html('<i class="fa fa-check"></i>'),window.location.href=`${config.relative_path}/`}),!1});t.on("shown.bs.modal",function(){t.find("input").focus()})}),!1})}function j(){$("#confirm-email").on("click",function(){const e=$(this).attr("disabled",!0);socket.emit("user.emailConfirm",{},function(t){if(e.removeAttr("disabled"),t)return s.error(t);s.success("[[notifications:email-confirm-sent]]")})})}function p(e,t){return e.length?"("+e.val().length+"/"+t+")":""}function v(){const e=$("#signature");$("#signatureCharCountLeft").html(p(e,ajaxify.data.maximumSignatureLength)),e.on("keyup change",function(){$("#signatureCharCountLeft").html(p(e,ajaxify.data.maximumSignatureLength))})}function L(){const e=$("#aboutme");$("#aboutMeCharCountLeft").html(p(e,ajaxify.data.maximumAboutMeLength)),e.on("keyup change",function(){$("#aboutMeCharCountLeft").html(p(e,ajaxify.data.maximumAboutMeLength))})}function M(){const{allowMultipleBadges:e}=ajaxify.data;$('[component="group/toggle/hide"]').on("click",function(){const t=$(this).parents('[component="group/badge/item"]');t.attr("data-selected","false"),$(this).addClass("hidden"),t.find('[component="group/toggle/show"]').removeClass("hidden")}),$('[component="group/toggle/show"]').on("click",function(){e||($('[component="group/badge/list"] [component="group/toggle/show"]').removeClass("hidden"),$('[component="group/badge/list"] [component="group/toggle/hide"]').addClass("hidden"),$('[component="group/badge/list"] [component="group/badge/item"]').attr("data-selected","false"));const t=$(this).parents('[component="group/badge/item"]');t.attr("data-selected","true"),$(this).addClass("hidden"),t.find('[component="group/toggle/hide"]').removeClass("hidden")}),$('[component="group/order/up"]').on("click",function(){const t=$(this).parents('[component="group/badge/item"]');t.insertBefore(t.prev())}),$('[component="group/order/down"]').on("click",function(){const t=$(this).parents('[component="group/badge/item"]');t.insertAfter(t.next())})}return C}.apply(h,u),r!==void 0&&(g.exports=r)},86296:(g,h,a)=>{var u,r;u=[a(49897),a(33530),a(29930)],r=function(b,y,f){const c={};return c.init=function(l){const m=y.dialog({message:`
				<label class="form-label">[[admin/manage/users:new-email]]</label>
				<input id="newEmail" class="form-control" type="text" value="${utils.escapeHTML(l.email||"")}">
			`,title:"[[admin/manage/users:change-email]]",onEscape:!0,buttons:{cancel:{label:"[[admin/manage/users:alerts.button-cancel]]",className:"btn-link"},change:{label:"[[admin/manage/users:alerts.button-change]]",className:"btn-primary",callback:function(){const s=m.find("#newEmail").val();return b.post("/users/"+l.uid+"/emails",{skipConfirmation:!0,email:s}).then(()=>{m.modal("hide"),l.onSuccess(s)}).catch(f.error),!1}}}})},c}.apply(h,u),r!==void 0&&(g.exports=r)}}]);
