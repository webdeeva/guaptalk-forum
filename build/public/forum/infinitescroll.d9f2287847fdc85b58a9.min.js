"use strict";(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[1091,34271,49897,82858,99127],{22410:(D,p,c)=>{var d,E;d=[c(91749),c(29930),c(49897)],E=function(m,y,v){const i={};let l,u=0,s=!1,h,g=0;i.init=function(t,n){const e=$("body");typeof t=="function"?(l=t,h=e):(l=n,h=t||e),u=$(window).scrollTop(),$(window).off("scroll",w).on("scroll",w),e.height()<=$(window).height()&&(!ajaxify.data.hasOwnProperty("pageCount")||ajaxify.data.pageCount>1)&&l(1)};function w(){g&&clearTimeout(g),g=setTimeout(function(){g=0,x()},60)}function x(){const t=utils.findBootstrapEnvironment(),n=(t==="xs"||t==="sm")&&$("html").hasClass("composing");if(s||n||app.flags._glance)return;const e=$(window).scrollTop(),o=$(window).height(),a=h.height()-o,f=h.offset()?h.offset().top:0,r=100*(e-f)/(a<=0?o:a),O=15,P=85,T=e>u?1:-1;(r<O&&e<u||r>P&&e>u||r<0&&T>0&&a<0)&&l(T),u=e}return i.loadMore=function(t,n,e){if(s)return;s=!0;const o={method:t,data:n};m.fire("action:infinitescroll.loadmore",o),(o.method.startsWith("/")?v.get:socket.emit)(o.method,o.data,function(f,r){if(f)return s=!1,y.error(f);e(r,function(){s=!1})})},i.loadMoreXhr=function(t,n){if(s)return;s=!0;const e=config.relative_path+"/api"+location.pathname.replace(new RegExp("^"+config.relative_path),""),o={url:e,data:t};m.fire("action:infinitescroll.loadmore.xhr",o),$.get(e,t,function(a){n(a,function(){s=!1})}).fail(function(a){s=!1,y.error(String(a.responseJSON||"[[error:no-connection]]"))})},i.removeExtra=function(t,n,e){let o=$();if(t.length<=e)return o;const a=t.length-e;if(n>0){const f=$(document).height(),r=$(window).scrollTop();o=t.slice(0,a).remove(),$(window).scrollTop(r+($(document).height()-f))}else o=t.slice(t.length-a).remove();return o},i}.apply(p,d),E!==void 0&&(D.exports=E)},49897:(D,p,c)=>{c.r(p),c.d(p,{del:()=>x,get:()=>u,head:()=>s,patch:()=>g,post:()=>h,put:()=>w});var d=c(91749),E=c.n(d),m=c(33530),y=c.n(m);const v=config.relative_path+"/api/v3";async function i(t,n){if(t.url=t.url.startsWith("/api")?config.relative_path+t.url:v+t.url,typeof n=="function"){l(t).then(e=>n(null,e),e=>n(e));return}try{return await l(t)}catch(e){if(e.message==="A valid login session was not found. Please log in and try again."){const{url:o}=await(0,d.fire)("filter:admin.reauth",{url:"login"});return(0,m.confirm)("[[error:api.reauth-required]]",a=>{a&&ajaxify.go(o)})}throw e}}async function l(t){const{url:n}=t;delete t.url,t.data&&!(t.data instanceof FormData)&&(t.data=JSON.stringify(t.data||{}),t.headers["content-type"]="application/json; charset=utf-8"),{options:t}=await(0,d.fire)("filter:api.options",{options:t}),t.data&&(t.body=t.data,delete t.data);const e=await fetch(n,t),{headers:o}=e;if(o.get("x-redirect"))return l({url:o.get("x-redirect"),...t});const a=o.get("content-type"),f=a&&a.startsWith("application/json");let r;if(t.method!=="HEAD"&&(f?r=await e.json():r=await e.text()),!e.ok)throw r?new Error(f?r.status.message:r):new Error(e.statusText);return f&&r&&r.hasOwnProperty("status")&&r.hasOwnProperty("response")?r.response:r}function u(t,n,e){return i({url:t+(n&&Object.keys(n).length?"?"+$.param(n):"")},e)}function s(t,n,e){return i({url:t+(n&&Object.keys(n).length?"?"+$.param(n):""),method:"HEAD"},e)}function h(t,n,e){return i({url:t,method:"POST",data:n,headers:{"x-csrf-token":config.csrf_token}},e)}function g(t,n,e){return i({url:t,method:"PATCH",data:n,headers:{"x-csrf-token":config.csrf_token}},e)}function w(t,n,e){return i({url:t,method:"PUT",data:n,headers:{"x-csrf-token":config.csrf_token}},e)}function x(t,n,e){return i({url:t,method:"DELETE",data:n,headers:{"x-csrf-token":config.csrf_token}},e)}}}]);
