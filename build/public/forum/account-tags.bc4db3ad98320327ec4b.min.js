"use strict";(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[1852,34405],{34405:(E,A,s)=>{var m,l;m=[s(49897),s(29930),s(36e3),s(9787),s(35786)],l=function(w,f,{Textcomplete:y},{TextareaEditor:h},{ContenteditableEditor:x}){const u={},r={delay:200,appendTo:null};u.init=a=>{const t={...r,...a},{input:i,onSelect:e}=t;app.loadJQueryUI(function(){i.autocomplete({...t,open:function(){$(this).autocomplete("widget").css("z-index",100005)},select:function(n,o){d(i,e,n,o)}})})},u.user=function(a,t,i){typeof t=="function"&&(i=t,t={}),t=t||{},u.init({input:a,onSelect:i,source:(e,n)=>{t.query=e.term,w.get("/api/users",t,function(o,p){if(o)return f.error(o);if(p&&p.users){const g=p.users.map(function(c){const b=$("<div></div>").html(c.username).text();return c&&{label:b,value:b,user:{uid:c.uid,name:c.username,slug:c.userslug,username:c.username,userslug:c.userslug,displayname:c.displayname,picture:c.picture,banned:c.banned,"icon:text":c["icon:text"],"icon:bgColor":c["icon:bgColor"]}}});n(g)}$(".ui-autocomplete a").attr("data-ajaxify","false")})}})},u.group=function(a,t){u.init({input:a,onSelect:t,source:(i,e)=>{socket.emit("groups.search",{query:i.term},function(n,o){if(n)return f.error(n);if(o&&o.length){const p=o.map(function(g){return g&&{label:g.name,value:g.name,group:g}});e(p)}$(".ui-autocomplete a").attr("data-ajaxify","false")})}})},u.tag=function(a,t){u.init({input:a,onSelect:t,delay:100,source:(i,e)=>{socket.emit("topics.autocompleteTags",{query:i.term,cid:ajaxify.data.cid||0},function(n,o){if(n)return f.error(n);o&&e(o),$(".ui-autocomplete a").attr("data-ajaxify","false")})}})};function d(a,t,i,e){t=t||function(){};const n=jQuery.Event("keypress");n.which=13,n.keyCode=13,setTimeout(function(){a.trigger(n)},100),t(i,e)}return u.setup=function({element:a,strategies:t,options:i}){const e=a.get(0);if(e){var n;if(e.nodeName==="TEXTAREA"||e.nodeName==="INPUT"?n=new h(e):e.nodeName==="DIV"&&e.getAttribute("contenteditable")==="true"&&(n=new x(e)),!n)throw new Error("unknown target element type");e.setAttribute("dir",document.querySelector("html").getAttribute("data-dir"));var o=new y(n,t,{dropdown:i});return o.on("rendered",function(){o.dropdown.items.length&&o.dropdown.items[0].activate()}),o}},u}.apply(A,m),l!==void 0&&(E.exports=l)},43930:(E,A,s)=>{var m,l;m=[s(67910),s(29930),s(49897),s(91749),s(34405)],l=function(w,f,y,h,x){const u={};return u.init=function(){w.init();const r=$('[component="tags/watch"]');r.tagsinput({tagClass:"badge text-bg-info",confirmKeys:[13,44],trimValue:!0});const d=r.siblings(".bootstrap-tagsinput").find("input");d.translateAttr("aria-label","[[aria:user-watched-tags]]"),x.tag(d),ajaxify.data.tags.forEach(function(a){r.tagsinput("add",a)}),r.on("itemAdded",function(a){d.length&&d.autocomplete("close"),y.put(`/tags/${a.item}/follow`,{}).then(()=>{f.alert({alert_id:"follow_tag",message:"[[tags:following-tag.message]]",type:"success",timeout:5e3}),h.fire("action:tags.changeWatching",{tag:ajaxify.data.tag,type:"follow"})}).catch(t=>f.error(t))}),r.on("itemRemoved",function(a){y.del(`/tags/${a.item}/follow`,{}).then(()=>{f.alert({alert_id:"follow_tag",message:"[[tags:not-following-tag.message]]",type:"info",timeout:5e3}),h.fire("action:tags.changeWatching",{tag:ajaxify.data.tag,type:"unfollow"})}).catch(t=>f.error(t))})},u}.apply(A,m),l!==void 0&&(E.exports=l)}}]);
