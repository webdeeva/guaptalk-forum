"use strict";(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[34405,92380],{18030:(C,S,u)=>{var m,g;m=[u(67910),u(52473),u(49897),u(29930),u(91749),u(34405)],g=function(b,y,v,p,A,d){const w={};let h="";$(window).on("action:ajaxify.start",function(){const t=$("#bootswatchSkin");ajaxify.data.template.name==="account/settings"&&t.length&&t.val()!==h&&i(h)}),w.init=function(){h=$("#bootswatchSkin").length&&$("#bootswatchSkin").val(),b.init(),$("#submitBtn").on("click",function(){const t=l();return t.homePageRoute==="custom"&&t.homePageCustom?$.get(config.relative_path+"/"+t.homePageCustom,function(){n(t)}).fail(function(){p.error("[[error:invalid-home-page-route]]")}):n(t),!1}),$("#bootswatchSkin").on("change",function(){i($(this).val())}),$('[data-property="homePageRoute"]').on("change",r),r(),y.get("user/sessions").find(".timeago").timeago(),s()};function l(){const t={};$(".account").find("input, textarea, select").each(function(e,o){o=$(o);const f=o.attr("data-property");if(f){if(o.is("select")){t[f]=o.val();return}switch(o.attr("type")){case"checkbox":t[f]=o.is(":checked")?1:0;break;default:t[f]=o.val();break}}});const c=$('[component="chat/allow/list/user"][data-uid]').map((e,o)=>$(o).data("uid")).get(),a=$('[component="chat/deny/list/user"][data-uid]').map((e,o)=>$(o).data("uid")).get();return t.chatAllowList=JSON.stringify(c),t.chatDenyList=JSON.stringify(a),t}function n(t){v.put(`/users/${ajaxify.data.uid}/settings`,{settings:t}).then(c=>{p.success("[[success:settings-saved]]");let a=!1;for(const[e,o]of Object.entries(c))e==="userLang"&&config.userLang!==c.userLang&&(a=!0),e==="bootswatchSkin"?(h=c.bootswatchSkin,config.bootswatchSkin=h==="noskin"?"":h):config.hasOwnProperty(e)&&(config[e]=o);a&&parseInt(app.user.uid,10)===parseInt(ajaxify.data.theirid,10)&&window.location.reload()})}function r(){$('[data-property="homePageRoute"]').val()==="custom"?$("#homePageCustomContainer").show():($("#homePageCustomContainer").hide(),$('[data-property="homePageCustom"]').val(""))}function i(t){const c=Array.prototype.filter.call(document.querySelectorAll('link[rel="stylesheet"]'),function(k){return k.href.indexOf(config.relative_path+"/assets/client")!==-1})[0]||null;if(!c)return;t===""?t=config.defaultBootswatchSkin||"":t==="noskin"&&(t="");const a=$("body").attr("class").split(/\s+/).filter(function(k){return k.startsWith("skin-")});if(!a[0])return;let e=a[0].slice(5);if(e=e!=="noskin"?e:"",t===e){A.fire("action:skin.change",{skin:t,currentSkin:e});return}const o=$("html").attr("data-dir"),f=document.createElement("link");f.rel="stylesheet",f.type="text/css",f.href=config.relative_path+"/assets/client"+(t?"-"+t:"")+(o==="rtl"?"-rtl":"")+".css?"+config["cache-buster"],f.onload=function(){c.parentNode.removeChild(c),$("body").removeClass(a.join(" ")),$("body").addClass("skin-"+(t||"noskin")),A.fire("action:skin.change",{skin:t,currentSkin:e})},document.head.appendChild(f)}w.changeSkin=async function(t){app.user.uid&&await v.put(`/users/${app.user.uid}/settings`,{settings:{bootswatchSkin:t}}),config.bootswatchSkin=t==="noskin"?"":t,h=t,i(t)};function s(){d.user($("#chatAllowListAdd"),async function(c,a){const{user:e}=a.item;if(!e||String(e.uid)===String(app.user.uid))return;if($(`[component="chat/allow/list/user"][data-uid="${e.uid}"]`).length)return p.error("[[error:chat-allow-list-user-already-added]]");const o=await app.parseAndTranslate("account/settings","settings.chatAllowListUsers",{settings:{chatAllowListUsers:[a.item.user]}});$('[component="chat/allow/list"]').append(o),$("#chatAllowListAdd").val(""),t()}),d.user($("#chatDenyListAdd"),async function(c,a){const{user:e}=a.item;if(!e||String(e.uid)===String(app.user.uid))return;if($(`[component="chat/deny/list/user"][data-uid="${e.uid}"]`).length)return p.error("[[error:chat-deny-list-user-already-added]]");const o=await app.parseAndTranslate("account/settings","settings.chatDenyListUsers",{settings:{chatDenyListUsers:[a.item.user]}});$('[component="chat/deny/list"]').append(o),$("#chatDenyListAdd").val(""),t()}),$('[component="chat/allow/list"]').on("click",'[component="chat/allow/delete"]',function(){$(this).parent().remove(),t()}),$('[component="chat/deny/list"]').on("click",'[component="chat/deny/delete"]',function(){$(this).parent().remove(),t()});function t(){$('[component="chat/allow/list/no-users"]').toggleClass("hidden",!!$('[component="chat/allow/list/user"]').length),$('[component="chat/deny/list/no-users"]').toggleClass("hidden",!!$('[component="chat/deny/list/user"]').length)}}return w}.apply(S,m),g!==void 0&&(C.exports=g)},34405:(C,S,u)=>{var m,g;m=[u(49897),u(29930),u(36e3),u(9787),u(35786)],g=function(b,y,{Textcomplete:v},{TextareaEditor:p},{ContenteditableEditor:A}){const d={},w={delay:200,appendTo:null};d.init=l=>{const n={...w,...l},{input:r,onSelect:i}=n;app.loadJQueryUI(function(){r.autocomplete({...n,open:function(){$(this).autocomplete("widget").css("z-index",100005)},select:function(s,t){h(r,i,s,t)}})})},d.user=function(l,n,r){typeof n=="function"&&(r=n,n={}),n=n||{},d.init({input:l,onSelect:r,source:(i,s)=>{n.query=i.term,b.get("/api/users",n,function(t,c){if(t)return y.error(t);if(c&&c.users){const a=c.users.map(function(e){const o=$("<div></div>").html(e.username).text();return e&&{label:o,value:o,user:{uid:e.uid,name:e.username,slug:e.userslug,username:e.username,userslug:e.userslug,displayname:e.displayname,picture:e.picture,banned:e.banned,"icon:text":e["icon:text"],"icon:bgColor":e["icon:bgColor"]}}});s(a)}$(".ui-autocomplete a").attr("data-ajaxify","false")})}})},d.group=function(l,n){d.init({input:l,onSelect:n,source:(r,i)=>{socket.emit("groups.search",{query:r.term},function(s,t){if(s)return y.error(s);if(t&&t.length){const c=t.map(function(a){return a&&{label:a.name,value:a.name,group:a}});i(c)}$(".ui-autocomplete a").attr("data-ajaxify","false")})}})},d.tag=function(l,n){d.init({input:l,onSelect:n,delay:100,source:(r,i)=>{socket.emit("topics.autocompleteTags",{query:r.term,cid:ajaxify.data.cid||0},function(s,t){if(s)return y.error(s);t&&i(t),$(".ui-autocomplete a").attr("data-ajaxify","false")})}})};function h(l,n,r,i){n=n||function(){};const s=jQuery.Event("keypress");s.which=13,s.keyCode=13,setTimeout(function(){l.trigger(s)},100),n(r,i)}return d.setup=function({element:l,strategies:n,options:r}){const i=l.get(0);if(i){var s;if(i.nodeName==="TEXTAREA"||i.nodeName==="INPUT"?s=new p(i):i.nodeName==="DIV"&&i.getAttribute("contenteditable")==="true"&&(s=new A(i)),!s)throw new Error("unknown target element type");i.setAttribute("dir",document.querySelector("html").getAttribute("data-dir"));var t=new v(s,n,{dropdown:r});return t.on("rendered",function(){t.dropdown.items.length&&t.dropdown.items[0].activate()}),t}},d}.apply(S,m),g!==void 0&&(C.exports=g)}}]);
