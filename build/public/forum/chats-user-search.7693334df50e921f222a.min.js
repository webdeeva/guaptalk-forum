"use strict";(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[1091,34271,37147,49897,99127],{49897:(P,d,s)=>{s.r(d),s.d(d,{del:()=>a,get:()=>g,head:()=>y,patch:()=>A,post:()=>m,put:()=>n});var i=s(91749),f=s.n(i),h=s(33530),v=s.n(h);const p=config.relative_path+"/api/v3";async function u(e,r){if(e.url=e.url.startsWith("/api")?config.relative_path+e.url:p+e.url,typeof r=="function"){o(e).then(t=>r(null,t),t=>r(t));return}try{return await o(e)}catch(t){if(t.message==="A valid login session was not found. Please log in and try again."){const{url:l}=await(0,i.fire)("filter:admin.reauth",{url:"login"});return(0,h.confirm)("[[error:api.reauth-required]]",E=>{E&&ajaxify.go(l)})}throw t}}async function o(e){const{url:r}=e;delete e.url,e.data&&!(e.data instanceof FormData)&&(e.data=JSON.stringify(e.data||{}),e.headers["content-type"]="application/json; charset=utf-8"),{options:e}=await(0,i.fire)("filter:api.options",{options:e}),e.data&&(e.body=e.data,delete e.data);const t=await fetch(r,e),{headers:l}=t;if(l.get("x-redirect"))return o({url:l.get("x-redirect"),...e});const E=l.get("content-type"),D=E&&E.startsWith("application/json");let c;if(e.method!=="HEAD"&&(D?c=await t.json():c=await t.text()),!t.ok)throw c?new Error(D?c.status.message:c):new Error(t.statusText);return D&&c&&c.hasOwnProperty("status")&&c.hasOwnProperty("response")?c.response:c}function g(e,r,t){return u({url:e+(r&&Object.keys(r).length?"?"+$.param(r):"")},t)}function y(e,r,t){return u({url:e+(r&&Object.keys(r).length?"?"+$.param(r):""),method:"HEAD"},t)}function m(e,r,t){return u({url:e,method:"POST",data:r,headers:{"x-csrf-token":config.csrf_token}},t)}function A(e,r,t){return u({url:e,method:"PATCH",data:r,headers:{"x-csrf-token":config.csrf_token}},t)}function n(e,r,t){return u({url:e,method:"PUT",data:r,headers:{"x-csrf-token":config.csrf_token}},t)}function a(e,r,t){return u({url:e,method:"DELETE",data:r,headers:{"x-csrf-token":config.csrf_token}},t)}},53309:(P,d,s)=>{var i,f;i=[s(52473),s(49897),s(29930)],f=function(h,v,p){const u={};let o=[];u.init=function(n){n=n||{},o.length=0,h.get("chat/search").on("keyup",utils.debounce(y,250));const a=$('[component="chat/search/list"]');a.on("click","[data-uid]",function(){n.onSelect&&n.onSelect(o.find(e=>String(e.uid)===String($(this).attr("data-uid")))),g(a)})};function g(n){h.get("chat/search").val(""),m(n),n.find('[component="chat/search/no-users"]').addClass("hidden"),n.find('[component="chat/search/start-typing"]').removeClass("hidden")}function y(){const n=$('[component="chat/search/list"]'),a=h.get("chat/search").val();if(!a)return g(n);n.find('[component="chat/search/start-typing"]').addClass("hidden"),v.get("/api/users",{query:a,searchBy:"username",paginate:!1}).then(A).catch(p.error)}function m(n){o.length=0,n.find("[data-uid]").remove()}async function A(n){const a=$('[component="chat/search/list"]');if(m(a),n.users=n.users.filter(function(r){return parseInt(r.uid,10)!==parseInt(app.user.uid,10)}),o=n.users,!n.users.length)return a.find('[component="chat/search/no-users"]').removeClass("hidden");a.find('[component="chat/search/no-users"]').addClass("hidden");const e=await app.parseAndTranslate("modals/create-room","searchUsers",{searchUsers:n.users});a.append(e),a.parent().toggleClass("show",!0)}return u}.apply(d,i),f!==void 0&&(P.exports=f)}}]);
