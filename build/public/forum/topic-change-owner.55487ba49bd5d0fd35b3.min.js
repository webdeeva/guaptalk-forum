"use strict";(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[1091,3097,13417,17205,34271,34405,38395,49897,99127],{16227:(_,A,u)=>{var g,h;g=[u(52473)],h=function(f){const c={};let P;c.pids=[];let d=!1;c.init=function(i,o){c.pids.length=0,P=i,o=o||{},d=o.allowMainPostSelect||!1,$("#content").on("click",'[component="topic"] [component="post"]',a),y()};function a(i){i.stopPropagation();const o=$(this).attr("data-pid"),r=$('[component="topic"] [data-pid="'+o+'"]');!d&&parseInt($(this).attr("data-index"),10)===0||c.togglePostSelection(r,o)}c.disable=function(){c.pids.forEach(function(i){f.get("post","pid",i).toggleClass("selected",!1)}),$("#content").off("click",'[component="topic"] [component="post"]',a),x()},c.togglePostSelection=function(i,o){if(o){const r=c.pids.indexOf(o);r===-1?(c.pids.push(o),i.toggleClass("selected",!0)):(c.pids.splice(r,1),i.toggleClass("selected",!1)),c.pids.length&&c.pids.sort(function(t,e){return t-e}),typeof P=="function"&&P()}};function s(){return!1}function y(){$("#content").on("click",'[component="post"] button, [component="post"] a',s)}function x(){$("#content").off("click",'[component="post"] button, [component="post"] a',s)}return c}.apply(A,g),h!==void 0&&(_.exports=h)},17205:(_,A,u)=>{var g,h;g=[u(16227),u(34405),u(29930)],h=function(f,c,P){const d={};let a,s,y=0;d.init=function(e){a||app.parseAndTranslate("modals/change-owner",{},function(n){a=n,s=a.find("#change_owner_commit"),$("body").append(a),a.find("#change_owner_cancel").on("click",t),a.find("#username").on("keyup",i),f.init(o,{allowMainPostSelect:!0}),x(),e&&f.togglePostSelection(e,e.attr("data-pid")),s.on("click",function(){r()}),c.user(a.find("#username"),{filters:["notbanned"]},function(E,p){y=p.item.user.uid,i()})})};function x(){f.pids.length?a.find("#pids").translateHtml("[[topic:fork-pid-count, "+f.pids.length+"]]"):a.find("#pids").translateHtml("[[topic:fork-no-pids]]")}function i(){y&&a.find("#username").length&&a.find("#username").val().length&&f.pids.length?s.removeAttr("disabled"):s.attr("disabled",!0)}function o(){i(),x()}function r(){y&&socket.emit("posts.changeOwner",{pids:f.pids,toUid:y},function(e){if(e)return P.error(e);ajaxify.go(`/post/${f.pids[0]}`),t()})}function t(){a&&(a.remove(),a=null,f.disable())}return d}.apply(A,g),h!==void 0&&(_.exports=h)},34405:(_,A,u)=>{var g,h;g=[u(49897),u(29930),u(36e3),u(9787),u(35786)],h=function(f,c,{Textcomplete:P},{TextareaEditor:d},{ContenteditableEditor:a}){const s={},y={delay:200,appendTo:null};s.init=i=>{const o={...y,...i},{input:r,onSelect:t}=o;app.loadJQueryUI(function(){r.autocomplete({...o,open:function(){$(this).autocomplete("widget").css("z-index",100005)},select:function(e,n){x(r,t,e,n)}})})},s.user=function(i,o,r){typeof o=="function"&&(r=o,o={}),o=o||{},s.init({input:i,onSelect:r,source:(t,e)=>{o.query=t.term,f.get("/api/users",o,function(n,E){if(n)return c.error(n);if(E&&E.users){const p=E.users.map(function(l){const m=$("<div></div>").html(l.username).text();return l&&{label:m,value:m,user:{uid:l.uid,name:l.username,slug:l.userslug,username:l.username,userslug:l.userslug,displayname:l.displayname,picture:l.picture,banned:l.banned,"icon:text":l["icon:text"],"icon:bgColor":l["icon:bgColor"]}}});e(p)}$(".ui-autocomplete a").attr("data-ajaxify","false")})}})},s.group=function(i,o){s.init({input:i,onSelect:o,source:(r,t)=>{socket.emit("groups.search",{query:r.term},function(e,n){if(e)return c.error(e);if(n&&n.length){const E=n.map(function(p){return p&&{label:p.name,value:p.name,group:p}});t(E)}$(".ui-autocomplete a").attr("data-ajaxify","false")})}})},s.tag=function(i,o){s.init({input:i,onSelect:o,delay:100,source:(r,t)=>{socket.emit("topics.autocompleteTags",{query:r.term,cid:ajaxify.data.cid||0},function(e,n){if(e)return c.error(e);n&&t(n),$(".ui-autocomplete a").attr("data-ajaxify","false")})}})};function x(i,o,r,t){o=o||function(){};const e=jQuery.Event("keypress");e.which=13,e.keyCode=13,setTimeout(function(){i.trigger(e)},100),o(r,t)}return s.setup=function({element:i,strategies:o,options:r}){const t=i.get(0);if(t){var e;if(t.nodeName==="TEXTAREA"||t.nodeName==="INPUT"?e=new d(t):t.nodeName==="DIV"&&t.getAttribute("contenteditable")==="true"&&(e=new a(t)),!e)throw new Error("unknown target element type");t.setAttribute("dir",document.querySelector("html").getAttribute("data-dir"));var n=new P(e,o,{dropdown:r});return n.on("rendered",function(){n.dropdown.items.length&&n.dropdown.items[0].activate()}),n}},s}.apply(A,g),h!==void 0&&(_.exports=h)},49897:(_,A,u)=>{u.r(A),u.d(A,{del:()=>r,get:()=>s,head:()=>y,patch:()=>i,post:()=>x,put:()=>o});var g=u(91749),h=u.n(g),f=u(33530),c=u.n(f);const P=config.relative_path+"/api/v3";async function d(t,e){if(t.url=t.url.startsWith("/api")?config.relative_path+t.url:P+t.url,typeof e=="function"){a(t).then(n=>e(null,n),n=>e(n));return}try{return await a(t)}catch(n){if(n.message==="A valid login session was not found. Please log in and try again."){const{url:E}=await(0,g.fire)("filter:admin.reauth",{url:"login"});return(0,f.confirm)("[[error:api.reauth-required]]",p=>{p&&ajaxify.go(E)})}throw n}}async function a(t){const{url:e}=t;delete t.url,t.data&&!(t.data instanceof FormData)&&(t.data=JSON.stringify(t.data||{}),t.headers["content-type"]="application/json; charset=utf-8"),{options:t}=await(0,g.fire)("filter:api.options",{options:t}),t.data&&(t.body=t.data,delete t.data);const n=await fetch(e,t),{headers:E}=n;if(E.get("x-redirect"))return a({url:E.get("x-redirect"),...t});const p=E.get("content-type"),l=p&&p.startsWith("application/json");let m;if(t.method!=="HEAD"&&(l?m=await n.json():m=await n.text()),!n.ok)throw m?new Error(l?m.status.message:m):new Error(n.statusText);return l&&m&&m.hasOwnProperty("status")&&m.hasOwnProperty("response")?m.response:m}function s(t,e,n){return d({url:t+(e&&Object.keys(e).length?"?"+$.param(e):"")},n)}function y(t,e,n){return d({url:t+(e&&Object.keys(e).length?"?"+$.param(e):""),method:"HEAD"},n)}function x(t,e,n){return d({url:t,method:"POST",data:e,headers:{"x-csrf-token":config.csrf_token}},n)}function i(t,e,n){return d({url:t,method:"PATCH",data:e,headers:{"x-csrf-token":config.csrf_token}},n)}function o(t,e,n){return d({url:t,method:"PUT",data:e,headers:{"x-csrf-token":config.csrf_token}},n)}function r(t,e,n){return d({url:t,method:"DELETE",data:e,headers:{"x-csrf-token":config.csrf_token}},n)}}}]);
