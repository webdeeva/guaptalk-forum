"use strict";(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[1091,34271,36422,38395,44864,49897,99127],{16227:(A,_,r)=>{var p,m;p=[r(52473)],m=function(c){const a={};let E;a.pids=[];let l=!1;a.init=function(s,i){a.pids.length=0,E=s,i=i||{},l=i.allowMainPostSelect||!1,$("#content").on("click",'[component="topic"] [component="post"]',o),h()};function o(s){s.stopPropagation();const i=$(this).attr("data-pid"),g=$('[component="topic"] [data-pid="'+i+'"]');!l&&parseInt($(this).attr("data-index"),10)===0||a.togglePostSelection(g,i)}a.disable=function(){a.pids.forEach(function(s){c.get("post","pid",s).toggleClass("selected",!1)}),$("#content").off("click",'[component="topic"] [component="post"]',o),P()},a.togglePostSelection=function(s,i){if(i){const g=a.pids.indexOf(i);g===-1?(a.pids.push(i),s.toggleClass("selected",!0)):(a.pids.splice(g,1),s.toggleClass("selected",!1)),a.pids.length&&a.pids.sort(function(t,n){return t-n}),typeof E=="function"&&E()}};function f(){return!1}function h(){$("#content").on("click",'[component="post"] button, [component="post"] a',f)}function P(){$("#content").off("click",'[component="post"] button, [component="post"] a',f)}return a}.apply(_,p),m!==void 0&&(A.exports=m)},36422:(A,_,r)=>{var p,m;p=[r(16227),r(29930),r(49897)],m=function(c,a,E){const l={};let o,f,h,P;l.init=function(){P=ajaxify.data.tid,$(window).off("action:ajaxify.end",s).on("action:ajaxify.end",s),!o&&app.parseAndTranslate("modals/delete-posts",{},function(e){o=e,$("body").append(o),f=o.find("#delete_posts_confirm"),h=o.find("#purge_posts_confirm"),o.find("#delete_posts_cancel").on("click",n),c.init(function(){t(),g()},{allowMainPostSelect:!0}),g(),f.on("click",function(){i(f,d=>`/posts/${encodeURIComponent(d)}/state`)}),h.on("click",function(){i(h,d=>`/posts/${encodeURIComponent(d)}`)})})};function s(){(ajaxify.data.template.name!=="topic"||ajaxify.data.tid!==P)&&(n(),$(window).off("action:ajaxify.end",s))}function i(e,d){e.attr("disabled",!0),Promise.all(c.pids.map(y=>E.del(d(y),{}))).then(n).catch(a.error).finally(()=>{e.removeAttr("disabled")})}function g(){c.pids.length?o.find("#pids").translateHtml("[[topic:fork-pid-count, "+c.pids.length+"]]"):o.find("#pids").translateHtml("[[topic:fork-no-pids]]")}function t(){c.pids.length?(f.removeAttr("disabled"),h.removeAttr("disabled")):(f.attr("disabled",!0),h.attr("disabled",!0))}function n(){o&&(o.remove(),o=null,c.disable())}return l}.apply(_,p),m!==void 0&&(A.exports=m)},49897:(A,_,r)=>{r.r(_),r.d(_,{del:()=>g,get:()=>f,head:()=>h,patch:()=>s,post:()=>P,put:()=>i});var p=r(91749),m=r.n(p),c=r(33530),a=r.n(c);const E=config.relative_path+"/api/v3";async function l(t,n){if(t.url=t.url.startsWith("/api")?config.relative_path+t.url:E+t.url,typeof n=="function"){o(t).then(e=>n(null,e),e=>n(e));return}try{return await o(t)}catch(e){if(e.message==="A valid login session was not found. Please log in and try again."){const{url:d}=await(0,p.fire)("filter:admin.reauth",{url:"login"});return(0,c.confirm)("[[error:api.reauth-required]]",y=>{y&&ajaxify.go(d)})}throw e}}async function o(t){const{url:n}=t;delete t.url,t.data&&!(t.data instanceof FormData)&&(t.data=JSON.stringify(t.data||{}),t.headers["content-type"]="application/json; charset=utf-8"),{options:t}=await(0,p.fire)("filter:api.options",{options:t}),t.data&&(t.body=t.data,delete t.data);const e=await fetch(n,t),{headers:d}=e;if(d.get("x-redirect"))return o({url:d.get("x-redirect"),...t});const y=d.get("content-type"),k=y&&y.startsWith("application/json");let u;if(t.method!=="HEAD"&&(k?u=await e.json():u=await e.text()),!e.ok)throw u?new Error(k?u.status.message:u):new Error(e.statusText);return k&&u&&u.hasOwnProperty("status")&&u.hasOwnProperty("response")?u.response:u}function f(t,n,e){return l({url:t+(n&&Object.keys(n).length?"?"+$.param(n):"")},e)}function h(t,n,e){return l({url:t+(n&&Object.keys(n).length?"?"+$.param(n):""),method:"HEAD"},e)}function P(t,n,e){return l({url:t,method:"POST",data:n,headers:{"x-csrf-token":config.csrf_token}},e)}function s(t,n,e){return l({url:t,method:"PATCH",data:n,headers:{"x-csrf-token":config.csrf_token}},e)}function i(t,n,e){return l({url:t,method:"PUT",data:n,headers:{"x-csrf-token":config.csrf_token}},e)}function g(t,n,e){return l({url:t,method:"DELETE",data:n,headers:{"x-csrf-token":config.csrf_token}},e)}}}]);
