"use strict";(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[1091,28310,34271,49888,49897,69185,86198,99127],{28310:(A,y,l)=>{var g,m;g=[l(65348),l(29930),l(91749)],m=function(C,E,v){const a={};let r,t;a.init=function(e,n,o){r||(a.tids=e,a.currentCid=n,a.onComplete=o,a.moveAll=!e,i())};function i(){app.parseAndTranslate("modals/move-topic",{},function(e){r=e,$("body").append(r),(a.moveAll||a.tids&&a.tids.length>1)&&r.find(".card-header").translateText("[[topic:move-topics]]");const n=r.find('[component="category-selector"]');n.addClass("dropup"),C.init(n,{onSelect:f,privilege:"moderate"}),r.find("#move_thread_commit").on("click",c),r.find("#move_topic_cancel").on("click",s)})}function f(e){t=e,r.find("#move_thread_commit").prop("disabled",!1)}function c(){const e=r.find("#move_thread_commit");if(!e.prop("disabled")&&t&&t.cid){e.prop("disabled",!0),s();let n="[[topic:topic-move-success, "+t.name+"]]";a.tids&&a.tids.length>1?n="[[topic:topic-move-multiple-success, "+t.name+"]]":a.tids||(n="[[topic:topic-move-all-success, "+t.name+"]]");const o={tids:a.tids?a.tids.slice():null,cid:t.cid,currentCid:a.currentCid,onComplete:a.onComplete};if(config.undoTimeout>0)return E.alert({alert_id:"tids_move_"+(a.tids?a.tids.join("-"):"all"),title:"[[topic:thread-tools.move]]",message:n,type:"success",timeout:config.undoTimeout,timeoutfn:function(){u(o)},clickfn:function(d,h){delete h.timeoutfn,E.success("[[topic:topic-move-undone]]")}});u(o)}}function u(e){v.fire("action:topic.move",e),socket.emit(e.tids?"topics.move":"topics.moveAll",e,function(n){if(n)return E.error(n);typeof e.onComplete=="function"&&e.onComplete()})}function s(){r&&(r.remove(),r=null)}return a}.apply(y,g),m!==void 0&&(A.exports=m)},49897:(A,y,l)=>{l.r(y),l.d(y,{del:()=>s,get:()=>t,head:()=>i,patch:()=>c,post:()=>f,put:()=>u});var g=l(91749),m=l.n(g),C=l(33530),E=l.n(C);const v=config.relative_path+"/api/v3";async function a(e,n){if(e.url=e.url.startsWith("/api")?config.relative_path+e.url:v+e.url,typeof n=="function"){r(e).then(o=>n(null,o),o=>n(o));return}try{return await r(e)}catch(o){if(o.message==="A valid login session was not found. Please log in and try again."){const{url:d}=await(0,g.fire)("filter:admin.reauth",{url:"login"});return(0,C.confirm)("[[error:api.reauth-required]]",h=>{h&&ajaxify.go(d)})}throw o}}async function r(e){const{url:n}=e;delete e.url,e.data&&!(e.data instanceof FormData)&&(e.data=JSON.stringify(e.data||{}),e.headers["content-type"]="application/json; charset=utf-8"),{options:e}=await(0,g.fire)("filter:api.options",{options:e}),e.data&&(e.body=e.data,delete e.data);const o=await fetch(n,e),{headers:d}=o;if(d.get("x-redirect"))return r({url:d.get("x-redirect"),...e});const h=d.get("content-type"),D=h&&h.startsWith("application/json");let p;if(e.method!=="HEAD"&&(D?p=await o.json():p=await o.text()),!o.ok)throw p?new Error(D?p.status.message:p):new Error(o.statusText);return D&&p&&p.hasOwnProperty("status")&&p.hasOwnProperty("response")?p.response:p}function t(e,n,o){return a({url:e+(n&&Object.keys(n).length?"?"+$.param(n):"")},o)}function i(e,n,o){return a({url:e+(n&&Object.keys(n).length?"?"+$.param(n):""),method:"HEAD"},o)}function f(e,n,o){return a({url:e,method:"POST",data:n,headers:{"x-csrf-token":config.csrf_token}},o)}function c(e,n,o){return a({url:e,method:"PATCH",data:n,headers:{"x-csrf-token":config.csrf_token}},o)}function u(e,n,o){return a({url:e,method:"PUT",data:n,headers:{"x-csrf-token":config.csrf_token}},o)}function s(e,n,o){return a({url:e,method:"DELETE",data:n,headers:{"x-csrf-token":config.csrf_token}},o)}},65348:(A,y,l)=>{var g,m;g=[l(96349),l(33530),l(91749),l(17459)],m=function(C,E,v,a){const r={};return r.init=function(t,i){if(!t||!t.length)return;i=i||{};const f=i.onSelect||function(){};i.states=i.states||["watching","tracking","notwatching","ignoring"],i.template=i.template||"partials/category/selector-dropdown-left",v.fire("action:category.selector.options",{el:t,options:i}),C.init(t,i);const c={el:t,selectedCategory:null};t.on("click","[data-cid]",function(){const s=$(this);return s.hasClass("disabled")?!1:(c.selectCategory(s.attr("data-cid")),f(c.selectedCategory))});let u=c.el.find('[component="category-selector-selected"]').html();return a.translate(u,s=>{u=s}),c.selectCategory=function(s){const e=c.el.find('[data-cid="'+s+'"]');c.selectedCategory={cid:s,name:e.attr("data-name")},e.length?c.el.find('[component="category-selector-selected"]').html(e.find('[component="category-markup"]').html()):c.el.find('[component="category-selector-selected"]').html(u)},c.getSelectedCategory=function(){return c.selectedCategory},c.getSelectedCid=function(){return c.selectedCategory?c.selectedCategory.cid:0},i.hasOwnProperty("selectedCategory")&&app.parseAndTranslate(i.template,{selectedCategory:i.selectedCategory},function(s){c.el.find('[component="category-selector-selected"]').html(s.find('[component="category-selector-selected"]').html())}),c},r.modal=function(t){t=t||{},t.onSelect=t.onSelect||function(){},t.onSubmit=t.onSubmit||function(){},app.parseAndTranslate("admin/partials/categories/select-category",{message:t.message},function(i){const f=E.dialog({title:t.title||"[[modules:composer.select-category]]",message:i,buttons:{save:{label:"[[global:select]]",className:"btn-primary",callback:u}}}),c=r.init(f.find('[component="category-selector"]'),t);function u(s){return s.preventDefault(),c.selectedCategory&&(t.onSubmit(c.selectedCategory),f.modal("hide")),!1}t.openOnLoad&&f.on("shown.bs.modal",function(){f.find(".dropdown-toggle").dropdown("toggle")}),f.find("form").on("submit",u)})},r}.apply(y,g),m!==void 0&&(A.exports=m)},96349:(A,y,l)=>{var g,m;g=[l(29930),l(89336),l(49897)],m=function(C,E,v){const a={};return a.init=function(r,t){let i=t.defaultCategories||null;t=t||{},t.privilege=t.privilege||"topics:read",t.states=t.states||["watching","tracking","notwatching","ignoring"],t.cacheList=t.hasOwnProperty("cacheList")?t.cacheList:!0;let f=[];Array.isArray(t.localCategories)&&(f=t.localCategories.map(n=>({...n})),i&&(i=[...f,...i])),t.selectedCids=t.selectedCids||ajaxify.data.selectedCids||[];const c=r.find('[component="category-selector-search"]');if(!c.length)return;const u=c.parents('[component="category/dropdown"]').length>0||c.parents('[component="category-selector"]').length>0;r.on("show.bs.dropdown",function(){u&&c.removeClass("hidden");function n(){const o=c.find("input").val();o.length>1||!o&&!i?s(o,function(d){i=t.cacheList&&(i||d),e(d)}):!o&&i&&e(i)}c.on("click",function(o){o.preventDefault(),o.stopPropagation()}),c.find("input").val("").on("keyup",utils.debounce(n,300)),n()}),r.on("shown.bs.dropdown",function(){["xs","sm"].includes(utils.findBootstrapEnvironment())||c.find("input").focus()}),r.on("hide.bs.dropdown",function(){u&&c.addClass("hidden"),c.off("click"),c.find("input").off("keyup")});function s(n,o){v.get("/search/categories",{search:n,query:utils.params(),parentCid:t.parentCid||0,selectedCids:t.selectedCids,privilege:t.privilege,states:t.states,showLinks:t.showLinks},function(d,{categories:h}){if(d)return C.error(d);o(f.concat(h))})}function e(n){const o=t.selectedCids.map(String);n.forEach(function(d){d.selected=o.includes(String(d.cid))}),app.parseAndTranslate(t.template,{categoryItems:n.slice(0,200),selectedCategory:ajaxify.data.selectedCategory,allCategoriesUrl:ajaxify.data.allCategoriesUrl},function(d){r.find('[component="category/list"]').html(d.find('[component="category/list"]').html()),r.find('[component="category/list"] [component="category/no-matches"]').toggleClass("hidden",!!n.length);const h=E.Dropdown.getInstance(r.find(".dropdown-toggle").get(0));h&&h.update()})}},a}.apply(y,g),m!==void 0&&(A.exports=m)}}]);
