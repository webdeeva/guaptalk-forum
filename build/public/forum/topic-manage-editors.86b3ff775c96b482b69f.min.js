"use strict";(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[1091,13417,24459,34271,34405,49897,91579,99127],{24459:(D,y,s)=>{var m,h;m=[s(34405),s(29930)],h=function(A,v){const x={};let o;x.init=async function(E){if(o)return;const g=E.attr("data-pid");let r=await socket.emit("posts.getEditors",{pid:g});app.parseAndTranslate("modals/manage-editors",{editors:r},function(i){o=i;const a=o.find("#manage_editors_commit");$("body").append(o),o.find("#manage_editors_cancel").on("click",d),a.on("click",function(){p(g)}),A.user(o.find("#username"),{filters:["notbanned"]},function(t,e){r.find(c=>String(c.uid)===String(e.item.user.uid))||(r.push(e.item.user),app.parseAndTranslate("modals/manage-editors","editors",{editors:r},function(c){o.find('[component="topic/editors"]').html(c),o.find("#username").val("")}))}),o.on("click","button.remove-user-icon",function(){const t=$(this).parents("[data-uid]"),e=t.attr("data-uid");r=r.filter(n=>String(n.uid)!==String(e)),t.remove()})})};function p(E){const g=o.find('[component="topic/editors"]>[data-uid]').map((r,i)=>$(i).attr("data-uid")).get();socket.emit("posts.saveEditors",{pid:E,uids:g},function(r){if(r)return v.error(r);d()})}function d(){o&&(o.remove(),o=null)}return x}.apply(y,m),h!==void 0&&(D.exports=h)},34405:(D,y,s)=>{var m,h;m=[s(49897),s(29930),s(36e3),s(9787),s(35786)],h=function(A,v,{Textcomplete:x},{TextareaEditor:o},{ContenteditableEditor:p}){const d={},E={delay:200,appendTo:null};d.init=r=>{const i={...E,...r},{input:a,onSelect:t}=i;app.loadJQueryUI(function(){a.autocomplete({...i,open:function(){$(this).autocomplete("widget").css("z-index",100005)},select:function(e,n){g(a,t,e,n)}})})},d.user=function(r,i,a){typeof i=="function"&&(a=i,i={}),i=i||{},d.init({input:r,onSelect:a,source:(t,e)=>{i.query=t.term,A.get("/api/users",i,function(n,c){if(n)return v.error(n);if(c&&c.users){const l=c.users.map(function(u){const f=$("<div></div>").html(u.username).text();return u&&{label:f,value:f,user:{uid:u.uid,name:u.username,slug:u.userslug,username:u.username,userslug:u.userslug,displayname:u.displayname,picture:u.picture,banned:u.banned,"icon:text":u["icon:text"],"icon:bgColor":u["icon:bgColor"]}}});e(l)}$(".ui-autocomplete a").attr("data-ajaxify","false")})}})},d.group=function(r,i){d.init({input:r,onSelect:i,source:(a,t)=>{socket.emit("groups.search",{query:a.term},function(e,n){if(e)return v.error(e);if(n&&n.length){const c=n.map(function(l){return l&&{label:l.name,value:l.name,group:l}});t(c)}$(".ui-autocomplete a").attr("data-ajaxify","false")})}})},d.tag=function(r,i){d.init({input:r,onSelect:i,delay:100,source:(a,t)=>{socket.emit("topics.autocompleteTags",{query:a.term,cid:ajaxify.data.cid||0},function(e,n){if(e)return v.error(e);n&&t(n),$(".ui-autocomplete a").attr("data-ajaxify","false")})}})};function g(r,i,a,t){i=i||function(){};const e=jQuery.Event("keypress");e.which=13,e.keyCode=13,setTimeout(function(){r.trigger(e)},100),i(a,t)}return d.setup=function({element:r,strategies:i,options:a}){const t=r.get(0);if(t){var e;if(t.nodeName==="TEXTAREA"||t.nodeName==="INPUT"?e=new o(t):t.nodeName==="DIV"&&t.getAttribute("contenteditable")==="true"&&(e=new p(t)),!e)throw new Error("unknown target element type");t.setAttribute("dir",document.querySelector("html").getAttribute("data-dir"));var n=new x(e,i,{dropdown:a});return n.on("rendered",function(){n.dropdown.items.length&&n.dropdown.items[0].activate()}),n}},d}.apply(y,m),h!==void 0&&(D.exports=h)},49897:(D,y,s)=>{s.r(y),s.d(y,{del:()=>a,get:()=>d,head:()=>E,patch:()=>r,post:()=>g,put:()=>i});var m=s(91749),h=s.n(m),A=s(33530),v=s.n(A);const x=config.relative_path+"/api/v3";async function o(t,e){if(t.url=t.url.startsWith("/api")?config.relative_path+t.url:x+t.url,typeof e=="function"){p(t).then(n=>e(null,n),n=>e(n));return}try{return await p(t)}catch(n){if(n.message==="A valid login session was not found. Please log in and try again."){const{url:c}=await(0,m.fire)("filter:admin.reauth",{url:"login"});return(0,A.confirm)("[[error:api.reauth-required]]",l=>{l&&ajaxify.go(c)})}throw n}}async function p(t){const{url:e}=t;delete t.url,t.data&&!(t.data instanceof FormData)&&(t.data=JSON.stringify(t.data||{}),t.headers["content-type"]="application/json; charset=utf-8"),{options:t}=await(0,m.fire)("filter:api.options",{options:t}),t.data&&(t.body=t.data,delete t.data);const n=await fetch(e,t),{headers:c}=n;if(c.get("x-redirect"))return p({url:c.get("x-redirect"),...t});const l=c.get("content-type"),u=l&&l.startsWith("application/json");let f;if(t.method!=="HEAD"&&(u?f=await n.json():f=await n.text()),!n.ok)throw f?new Error(u?f.status.message:f):new Error(n.statusText);return u&&f&&f.hasOwnProperty("status")&&f.hasOwnProperty("response")?f.response:f}function d(t,e,n){return o({url:t+(e&&Object.keys(e).length?"?"+$.param(e):"")},n)}function E(t,e,n){return o({url:t+(e&&Object.keys(e).length?"?"+$.param(e):""),method:"HEAD"},n)}function g(t,e,n){return o({url:t,method:"POST",data:e,headers:{"x-csrf-token":config.csrf_token}},n)}function r(t,e,n){return o({url:t,method:"PATCH",data:e,headers:{"x-csrf-token":config.csrf_token}},n)}function i(t,e,n){return o({url:t,method:"PUT",data:e,headers:{"x-csrf-token":config.csrf_token}},n)}function a(t,e,n){return o({url:t,method:"DELETE",data:e,headers:{"x-csrf-token":config.csrf_token}},n)}}}]);
